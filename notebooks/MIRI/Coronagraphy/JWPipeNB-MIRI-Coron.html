

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>MIRI Conagraphy Pipeline Notebook &#8212; JWST Pipeline Notebooks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/main.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/MIRI/Coronagraphy/JWPipeNB-MIRI-Coron';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="MIRI Imaging Pipeline Notebook" href="../Imaging/JWPipeNB-MIRI-imaging.html" />
    <link rel="prev" title="JWST Pipeline Notebooks" href="../../../README.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../README.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/stsci_logo2.png" class="logo__image only-light" alt="JWST Pipeline Notebooks - Home"/>
    <script>document.write(`<img src="../../../_static/stsci_logo2.png" class="logo__image only-dark" alt="JWST Pipeline Notebooks - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../README.html">
                    JWST Pipeline Notebooks
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">MIRI</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">MIRI Coronagraphy Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Imaging/JWPipeNB-MIRI-imaging.html">MIRI Imaging Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Imaging-TSO/JWPipeNB-MIRI-imaging-TSO.html">MIRI Imaging TSO Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../LRS-slit/JWPipeNB-MIRI-LRS-slit.html">MIRI LRS Slit Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../LRS-slitless-TSO/JWPipeNB-MIRI-LRS-slitless-TSO.html">MIRI LRS Slitless TSO Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MRS/JWPipeNB-MIRI-MRS.html">MIRI MRS Notebook</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NIRCAM</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../NIRCAM/Coronagraphy/JWPipeNB-nircam-coronagraphy.html">NIRCam Coronagraphy Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRCAM/Imaging/JWPipeNB-nircam-imaging.html">NIRCam Imaging Notebook</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NIRISS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/AMI/JWPipeNB-niriss-ami.html">NIRISS AMI Pipeline Notebook</a></li>









<li class="toctree-l1"><a class="reference internal" href="../../NIRISS/Imaging/JWPipeNB-niriss-imaging.html">NIRISS Imaging Pipeline Notebook</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NIRSpec</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../NIRSPEC/BOTS/JWPipeNB-NIRSpec-BOTS.html">NIRSpec BOTS Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSPEC/FSlit/JWPipeNB-NIRSpec-FS.html">NIRSpec Fixed Slit Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSPEC/IFU/JWPipeNB-NIRSpec-IFU.html">NIRSpec IFU Notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NIRSPEC/MOS/JWPipeNB-NIRSpec-MOS.html">NIRSpec MOS Notebook</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/spacetelescope/jwst-pipeline-notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/spacetelescope/jwst-pipeline-notebooks/issues/new?title=Issue%20on%20page%20%2Fnotebooks/MIRI/Coronagraphy/JWPipeNB-MIRI-Coron.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/notebooks/MIRI/Coronagraphy/JWPipeNB-MIRI-Coron.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>MIRI Conagraphy Pipeline Notebook</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration">1.-Configuration</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-crds-context-and-server">Set CRDS context and server</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#package-imports">2.-Package Imports</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-convenience-functions">Define convenience functions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#demo-mode-setup-ignore-if-not-using-demo-data">3.-Demo Mode Setup (ignore if not using demo data)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#directory-setup">4.-Directory Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#detector1-pipeline">5.-Detector1 Pipeline</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calibrating-science-files">Calibrating Science Files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calibrating-psf-reference-target-files">Calibrating PSF Reference Target Files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calibrating-background-files">Calibrating Background Files</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#image2-pipeline">6.-Image2 Pipeline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coron3-pipeline">7.-Coron3 Pipeline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examine-the-output">8.-Examine the output</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overlay-sky-coordinates">Overlay sky coordinates</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <a class="reference internal image-reference" href="https://github.com/spacetelescope/jwst-pipeline-notebooks/raw/main/_static/stsci_header.png"><img alt="stsci_logo" src="https://github.com/spacetelescope/jwst-pipeline-notebooks/raw/main/_static/stsci_header.png" style="width: 900px;" /></a>
<p><a id="title_ID"></a></p>
<section id="miri-conagraphy-pipeline-notebook">
<h1>MIRI Conagraphy Pipeline Notebook<a class="headerlink" href="#miri-conagraphy-pipeline-notebook" title="Permalink to this heading">#</a></h1>
<p><strong>Authors</strong>: B. Nickson; MIRI branch<br>
<strong>Last Updated</strong>: July 16, 2025<br>
<strong>Pipeline Version</strong>: 1.19.1 (Build 12.0)</p>
<p><strong>Purpose</strong>: <br>
This notebook provides a framework for processing generic Mid-Infrared Instrument (MIRI) Coronagraphic data through all three James Webb Space Telescope (JWST) pipeline stages. Data is assumed to be located in separate observation folders according to the paths set up below. Editing cells other than those in the <span class="xref myst">Configuration</span> should not be necessary unless the standard pipeline processing options are modified.</p>
<p><strong>Data</strong>: <br>
This example is set up to use F1550C coronagraphic observations of the super-Jupiter exoplanet HIP 65426 b, obtained by <a class="reference external" href="https://www.stsci.edu/jwst/science-execution/program-information">Program ID</a> 1386 (PI: S. Hinkley). It incorporates observations of the exoplanet host star HIP 65426 at two separate roll angles (1 exposure each); a PSF reference observation of the nearby star HIP 65219, taken with a 9-pt small grid dither pattern (9 exposures total); a background observation associated with the target star, taken with a 2-pt dither (two exposures); and a background observation associated with the PSF reference target, taken with a 2-pt dither (two exposures).</p>
<p>The relevant observation numbers are:</p>
<ul class="simple">
<li><p>Science observations: 8, 9<br></p></li>
<li><p>Science backgrounds: 30<br></p></li>
<li><p>Reference observations: 7<br></p></li>
<li><p>Reference backgrounds: 31<br></p></li>
</ul>
<p>Example input data to use will be downloaded automatically unless disabled (i.e., to use local files instead).</p>
<p><strong><span class="xref myst">JWST pipeline version and CRDS context</span></strong>:<br>
This notebook was written for the above-specified pipeline version and associated build context for this version of the JWST Calibration Pipeline. Information about this and other contexts can be found in the JWST Calibration Reference Data System (CRDS <a class="reference external" href="https://jwst-crds.stsci.edu/">server</a>). If you use different pipeline versions, please refer to the table <a class="reference external" href="https://jwst-crds.stsci.edu/display_build_contexts/">here</a> to determine what context to use. To learn more about the differences for the pipeline, read the relevant <a class="reference external" href="https://jwst-docs.stsci.edu/jwst-science-calibration-pipeline/jwst-operations-pipeline-build-information#references">documentation</a>.<br></p>
<p>Please note that pipeline software development is a continuous process, so results in some cases may be slightly different if a subsequent version is used. <strong>For optimal results, users are strongly encouraged to reprocess their data using the most recent pipeline version and <a class="reference external" href="https://jwst-crds.stsci.edu/display_build_contexts/">associated CRDS context</a>, taking advantage of bug fixes and algorithm improvements.</strong>
Any <a class="reference external" href="https://jwst-docs.stsci.edu/known-issues-with-jwst-data/nirspec-known-issues/nirspec-mos-known-issues#NIRSpecFSKnownIssues-Resamplingof2-Dspectra&amp;gsc.tab=0:~:text=MOS%20Known%20Issues-,NIRSpec%20MOS%20Known%20Issues,-Known%20issues%20specific">known issues</a> for this build are noted in the notebook.</p>
<p><strong>Updates</strong>:<br>
This notebook is regularly updated as improvements are made to the pipeline. Find the most up to date version of this notebook at:
<a class="github reference external" href="https://github.com/spacetelescope/jwst-pipeline-notebooks/">spacetelescope/jwst-pipeline-notebooks</a></p>
<p><strong>Recent Changes</strong>:<br>
Jan 28, 2025: Migrate from the <code class="docutils literal notranslate"><span class="pre">Coronagraphy_ExambleNB</span></code> notebook, update to Build 11.2 (jwst 1.17.1).<br>
May 5, 2025: Updated to jwst 1.18.0 (no significant changes)<br>
July 16, 2025: Updated to jwst 1.19.1 (no significant changes)</p>
<hr style="border:1px solid gray"> </hr><section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><span class="xref myst">Configuration</span></p></li>
<li><p><span class="xref myst">Package Imports</span></p></li>
<li><p><span class="xref myst">Demo Mode Setup</span></p></li>
<li><p><span class="xref myst">Directory Setup</span></p></li>
<li><p><span class="xref myst">Detector1 Pipeline</span></p></li>
<li><p><span class="xref myst">Image2 Pipeline</span></p></li>
<li><p><span class="xref myst">Coron3 Pipeline</span></p></li>
<li><p><span class="xref myst">Plot the spectra</span></p></li>
</ol>
<hr style="border:1px solid gray"> </hr></section>
<section id="configuration">
<h2>1.-Configuration<a class="headerlink" href="#configuration" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<p>Set basic parameters to use with this notebook. These will affect what data is used, where data is located (if already in disk), and pipeline modules run on this data. The list of parameters are as follows:</p>
<ul class="simple">
<li><p>demo_mode</p></li>
<li><p>directories with data</p></li>
<li><p>mask</p></li>
<li><p>filter</p></li>
<li><p>pipeline modules</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Basic import necessary for configuration</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-warning">
Note that <code>demo_mode</code> must be set appropriately below.
</div>
<p>Set <code>demo_mode = True</code> to run in demonstration mode. In this mode, this
notebook will download example data from the
Barbara A. Mikulski Archive for Space Telescopes <a class="reference external" href="https://archive.stsci.edu/">(MAST)</a> and process it through the pipeline.
This will all happen in a local directory unless modified
in <span class="xref myst">Section 3</span> below.</p>
<p>Set <code>demo_mode = False</code> if you want to process your own data that has already
been downloaded and provide the location of the data.<br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set parameters for demo_mode, mask, filter, data mode directories, and </span>
<span class="c1"># processing steps.</span>

<span class="c1"># -------------------------------Demo Mode---------------------------------</span>
<span class="n">demo_mode</span> <span class="o">=</span> <span class="kc">True</span>

<span class="k">if</span> <span class="n">demo_mode</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Running in demonstration mode using online example data!&#39;</span><span class="p">)</span>

<span class="c1"># -------------------------Data Mode Directories---------------------------</span>
<span class="c1"># If demo_mode = False, look for user data in these paths</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">demo_mode</span><span class="p">:</span>
    <span class="c1"># Set directory paths for processing specific data; these will need</span>
    <span class="c1"># to be changed to your local directory setup (below are given as</span>
    <span class="c1"># examples)</span>
    <span class="n">basedir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">),</span> <span class="s1">&#39;FlightData1386/&#39;</span><span class="p">)</span>

    <span class="c1"># Point to where science observation data are</span>
    <span class="c1"># Assumes uncalibrated data in sci_r1_dir/uncal/ and sci_r2_dir/uncal/, </span>
    <span class="c1"># and results in stage1, stage2, stage3 directories</span>
    <span class="n">sci_r1_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">basedir</span><span class="p">,</span> <span class="s1">&#39;sci_r1/&#39;</span><span class="p">)</span>
    <span class="n">sci_r2_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">basedir</span><span class="p">,</span> <span class="s1">&#39;sci_r2/&#39;</span><span class="p">)</span>

    <span class="c1"># Point to where reference target observation data are</span>
    <span class="c1"># Assumes uncalibrated data in ref_dir/uncal/ and results in stage1,</span>
    <span class="c1"># stage2, stage3 directories</span>
    <span class="n">ref_targ_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">basedir</span><span class="p">,</span> <span class="s1">&#39;ref_targ/&#39;</span><span class="p">)</span>

    <span class="c1"># Point to where background observation data are</span>
    <span class="c1"># Assumes uncalibrated data in sci_bg_dir/uncal/ and ref_targ_bg_dir/uncal/,</span>
    <span class="c1"># and results in stage1, stage2 directories</span>
    <span class="n">bg_sci_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">basedir</span><span class="p">,</span> <span class="s1">&#39;bg_sci/&#39;</span><span class="p">)</span>
    <span class="n">bg_ref_targ_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">basedir</span><span class="p">,</span> <span class="s1">&#39;bg_ref_targ/&#39;</span><span class="p">)</span>

<span class="c1"># --------------------------Set Processing Steps--------------------------</span>
<span class="c1"># Whether or not to process only data from a given coronagraphic mask/</span>
<span class="c1"># filter (useful if overriding reference files) </span>
<span class="c1"># Note that BOTH parameters must be set in order to work</span>
<span class="n">use_mask</span> <span class="o">=</span> <span class="s1">&#39;4QPM_1550&#39;</span>  <span class="c1"># &#39;4QPM_1065&#39;, &#39;4QPM_1140&#39;, &#39;4QPM_1550&#39;, or &#39;LYOT_2300&#39;</span>
<span class="n">use_filter</span> <span class="o">=</span> <span class="s1">&#39;F1550C&#39;</span>  <span class="c1"># &#39;F1065C&#39;, &#39;F1140C&#39;, &#39;F1550C&#39;, or &#39;F2300C&#39;</span>

<span class="c1"># Individual pipeline stages can be turned on/off here. Note that a later</span>
<span class="c1"># stage won&#39;t be able to run unless data products have already been</span>
<span class="c1"># produced from the prior stage.</span>

<span class="c1"># Science processing</span>
<span class="n">dodet1</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># calwebb_detector1</span>
<span class="n">doimage2</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># calwebb_image2</span>
<span class="n">docoron3</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># calwebb_coron3</span>

<span class="c1"># Background processing</span>
<span class="n">dodet1bg</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># calwebb_detector1</span>
<span class="n">doimage2bg</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># calwebb_image2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running in demonstration mode using online example data!
</pre></div>
</div>
</div>
</div>
<section id="set-crds-context-and-server">
<h3>Set CRDS context and server<a class="headerlink" href="#set-crds-context-and-server" title="Permalink to this heading">#</a></h3>
<p>Before importing <code>CRDS</code> and <code>JWST</code> modules, we need to configure our environment. This includes defining a CRDS cache directory in which to keep the reference files that will be used by the calibration pipeline.</p>
<p>If the root directory for the local CRDS cache directory has not been set already, it will be set to create one in the home directory.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ------------------------Set CRDS context and paths----------------------</span>
<span class="c1"># Each version of the calibration pipeline is associated with a specific CRDS</span>
<span class="c1"># context file. The pipeline will select the appropriate context file behind</span>
<span class="c1"># the scenes while running. However, if you wish to override the default context</span>
<span class="c1"># file and run the pipeline with a different context, you can set that using</span>
<span class="c1"># the CRDS_CONTEXT environment variable. Here we show how this is done,</span>
<span class="c1"># although we leave the line commented out in order to use the default context.</span>
<span class="c1"># If you wish to specify a different context, uncomment the line below.</span>
<span class="c1">#%env CRDS_CONTEXT jwst_1322.pmap</span>

<span class="c1"># Check whether the local CRDS cache directory has been set.</span>
<span class="c1"># If not, set it to the user home directory</span>
<span class="k">if</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;CRDS_PATH&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_PATH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">),</span> <span class="s1">&#39;crds&#39;</span><span class="p">)</span>

<span class="c1"># Check whether the CRDS server URL has been set.  If not, set it.</span>
<span class="k">if</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;CRDS_SERVER_URL&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_SERVER_URL&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;https://jwst-crds.stsci.edu&#39;</span>

<span class="c1"># Echo CRDS path in use</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CRDS local filepath:&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_PATH&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CRDS file server:&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_SERVER_URL&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS local filepath: /home/runner/crds
CRDS file server: https://jwst-crds.stsci.edu
</pre></div>
</div>
</div>
</div>
<hr style="border:1px solid gray"> </hr></section>
</section>
<section id="package-imports">
<h2>2.-Package Imports<a class="headerlink" href="#package-imports" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use the entire available screen width for this notebook</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;&lt;style&gt;.container { width:95% !important; }&lt;/style&gt;&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>.container { width:95% !important; }</style></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Basic system utilities for interacting with files</span>
<span class="c1"># ----------------------General Imports------------------------------------</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">glob</span>
<span class="c1">#import copy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>

<span class="c1"># Numpy for doing calculations</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># -----------------------Astropy Imports-----------------------------------</span>
<span class="c1"># Astropy utilities for opening FITS and ASCII files, and downloading demo files</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">fits</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.wcs</span><span class="w"> </span><span class="kn">import</span> <span class="n">WCS</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.coordinates</span><span class="w"> </span><span class="kn">import</span> <span class="n">SkyCoord</span>

<span class="c1">#from astropy import time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astroquery.mast</span><span class="w"> </span><span class="kn">import</span> <span class="n">Observations</span>

<span class="c1"># -----------------------Plotting Imports----------------------------------</span>
<span class="c1"># Matplotlib for making plots</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># --------------JWST Calibration Pipeline Imports---------------------------</span>
<span class="c1"># Import the base JWST and calibration reference files packages</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jwst</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">crds</span>

<span class="c1"># JWST pipelines (each encompassing many steps)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jwst.pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">Detector1Pipeline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jwst.pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image2Pipeline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jwst.pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">Coron3Pipeline</span>

<span class="c1"># JWST pipeline utilities</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jwst</span><span class="w"> </span><span class="kn">import</span> <span class="n">datamodels</span>  <span class="c1"># JWST datamodels</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jwst.associations</span><span class="w"> </span><span class="kn">import</span> <span class="n">asn_from_list</span> <span class="k">as</span> <span class="n">afl</span>  <span class="c1"># Tools for creating association files</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jwst.associations.lib.rules_level2_base</span><span class="w"> </span><span class="kn">import</span> <span class="n">DMSLevel2bBase</span>  <span class="c1"># Definition of a Lvl2 association file</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jwst.associations.lib.rules_level3_base</span><span class="w"> </span><span class="kn">import</span> <span class="n">DMS_Level3_Base</span>  <span class="c1"># Definition of a Lvl3 association file</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">jwst.stpipe</span><span class="w"> </span><span class="kn">import</span> <span class="n">Step</span>  <span class="c1"># Import the wrapper class for pipeline steps</span>

<span class="c1"># Echo pipeline version and CRDS context in use</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;JWST Calibration Pipeline Version = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">jwst</span><span class="o">.</span><span class="n">__version__</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Using CRDS Context = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">crds</span><span class="o">.</span><span class="n">get_context_name</span><span class="p">(</span><span class="s1">&#39;jwst&#39;</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>JWST Calibration Pipeline Version = 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CRDS - INFO -  Calibration SW Found: jwst 1.19.1 (/usr/share/miniconda/lib/python3.13/site-packages/jwst-1.19.1.dist-info)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using CRDS Context = jwst_1413.pmap
</pre></div>
</div>
</div>
</div>
<section id="define-convenience-functions">
<h3>Define convenience functions<a class="headerlink" href="#define-convenience-functions" title="Permalink to this heading">#</a></h3>
<p>Define a convenience function to select only files of a given coronagraph mask/filter from an input set</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a convenience function to select only files of a given coronagraph mask/filter from an input set</span>
<span class="k">def</span><span class="w"> </span><span class="nf">select_mask_filter_files</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">use_mask</span><span class="p">,</span> <span class="n">use_filter</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Filter FITS files based on mask and filter criteria from their headers.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    files : array-like</span>
<span class="sd">        List of FITS file paths to process</span>
<span class="sd">    use_mask : str</span>
<span class="sd">        Mask value to match in FITS header &#39;CORONMSK&#39; key</span>
<span class="sd">    use_filter : str</span>
<span class="sd">        Filter value to match in FITS header &#39;FILTER&#39; key</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    numpy.ndarray</span>
<span class="sd">        Filtered array of file paths matching the criteria</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Make paths absolute paths</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)):</span>
        <span class="n">files</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">files</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="c1"># Convert files to numpy array if it isn&#39;t already</span>
    <span class="n">files</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>

    <span class="c1"># If either mask or filter is empty, return all files</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">use_mask</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">use_filter</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">files</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Initialize boolean array for keeping track of matches</span>
        <span class="n">keep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>

        <span class="c1"># Process each file</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">files</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">as</span> <span class="n">hdu</span><span class="p">:</span>
                    <span class="n">hdu</span><span class="o">.</span><span class="n">verify</span><span class="p">()</span>
                    <span class="n">hdr</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span>

                    <span class="c1"># Check if requred header keywords exist</span>
                    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;CORONMSK&#39;</span> <span class="ow">in</span> <span class="n">hdr</span> <span class="ow">and</span> <span class="s1">&#39;FILTER&#39;</span> <span class="ow">in</span> <span class="n">hdr</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;CORONMSK&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">use_mask</span> <span class="ow">and</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;FILTER&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">use_filter</span><span class="p">:</span>
                            <span class="n">keep</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                            <span class="n">files</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">files</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; Warning: could not process file </span><span class="si">{</span><span class="n">files</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Return filtered files</span>
        <span class="n">indx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">keep</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">files</span><span class="p">[</span><span class="n">indx</span><span class="p">]</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error processing files: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">files</span>  <span class="c1"># Return original array in case of failure</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Start a timer to keep track of runtime</span>
<span class="n">time0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<hr style="border:1px solid gray"> </hr></section>
</section>
<section id="demo-mode-setup-ignore-if-not-using-demo-data">
<h2>3.-Demo Mode Setup (ignore if not using demo data)<a class="headerlink" href="#demo-mode-setup-ignore-if-not-using-demo-data" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<p>If running in demonstration mode, set up the program information to
retrieve the uncalibrated data automatically from MAST using
<a class="reference external" href="https://astroquery.readthedocs.io/en/latest/mast/mast.html">astroquery</a>.
MAST allows for flexibility of searching by the proposal ID and the
observation ID instead of just filenames.<br></p>
<p>For illustrative purposes, we focus on data taken through the MIRI
<a class="reference external" href="https://jwst-docs.stsci.edu/jwst-mid-infrared-instrument/miri-observing-modes/miri-coronagraphic-imaging#MIRICoronagraphicImaging-CoronFiltersCoronagraphfilters">F1550C filter</a>
and start with uncalibrated raw data products (<code class="docutils literal notranslate"><span class="pre">uncal.fits</span></code>). The files use the following naming schema:
<code class="docutils literal notranslate"><span class="pre">jw01386&lt;obs&gt;001_04101_0000&lt;dith&gt;_mirimage_uncal.fits</span></code>, where <em>obs</em> refers to the observation number and <em>dith</em> refers to the
dither step number.</p>
<p>More information about the JWST file naming conventions can be found at:
https://jwst-pipeline.readthedocs.io/en/latest/jwst/data_products/file_naming.html</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up the program information and paths for demo program</span>
<span class="k">if</span> <span class="n">demo_mode</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Running in demonstration mode and will download example data from MAST!&#39;</span><span class="p">)</span>
    <span class="n">program</span> <span class="o">=</span> <span class="s2">&quot;01386&quot;</span>
    <span class="n">sci_r1_observtn</span> <span class="o">=</span> <span class="s2">&quot;008&quot;</span>  
    <span class="n">sci_r2_observtn</span> <span class="o">=</span> <span class="s2">&quot;009&quot;</span>  
    <span class="n">ref_targ_observtn</span> <span class="o">=</span> <span class="s2">&quot;007&quot;</span>      
    <span class="n">bg_sci_observtn</span> <span class="o">=</span> <span class="s2">&quot;030&quot;</span>  
    <span class="n">bg_ref_targ_observtn</span> <span class="o">=</span> <span class="s2">&quot;031&quot;</span>

    <span class="c1"># ----------Define the base and observation directories----------</span>
    <span class="n">basedir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;miri_coro_demo_data&#39;</span><span class="p">)</span>
    <span class="n">download_dir</span> <span class="o">=</span> <span class="n">basedir</span>
    <span class="n">sci_r1_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">basedir</span><span class="p">,</span> <span class="s1">&#39;Obs&#39;</span> <span class="o">+</span> <span class="n">sci_r1_observtn</span><span class="p">)</span>
    <span class="n">sci_r2_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">basedir</span><span class="p">,</span> <span class="s1">&#39;Obs&#39;</span> <span class="o">+</span> <span class="n">sci_r2_observtn</span><span class="p">)</span>
    <span class="n">ref_targ_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">basedir</span><span class="p">,</span> <span class="s1">&#39;Obs&#39;</span> <span class="o">+</span> <span class="n">ref_targ_observtn</span><span class="p">)</span>
    <span class="n">bg_sci_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">basedir</span><span class="p">,</span> <span class="s1">&#39;Obs&#39;</span> <span class="o">+</span> <span class="n">bg_sci_observtn</span><span class="p">)</span>
    <span class="n">bg_ref_targ_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">basedir</span><span class="p">,</span> <span class="s1">&#39;Obs&#39;</span> <span class="o">+</span> <span class="n">bg_ref_targ_observtn</span><span class="p">)</span>

    <span class="n">uncal_sci_r1_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sci_r1_dir</span><span class="p">,</span> <span class="s1">&#39;uncal&#39;</span><span class="p">)</span>
    <span class="n">uncal_sci_r2_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sci_r2_dir</span><span class="p">,</span> <span class="s1">&#39;uncal&#39;</span><span class="p">)</span>
    <span class="n">uncal_ref_targ_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ref_targ_dir</span><span class="p">,</span> <span class="s1">&#39;uncal&#39;</span><span class="p">)</span>
    <span class="n">uncal_bg_sci_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bg_sci_dir</span><span class="p">,</span> <span class="s1">&#39;uncal&#39;</span><span class="p">)</span>
    <span class="n">uncal_bg_ref_targ_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bg_ref_targ_dir</span><span class="p">,</span> <span class="s1">&#39;uncal&#39;</span><span class="p">)</span>
    
    <span class="c1"># Ensure filepaths for input data exist</span>
    <span class="n">input_dirs</span> <span class="o">=</span> <span class="p">[</span><span class="n">uncal_sci_r1_dir</span><span class="p">,</span> <span class="n">uncal_sci_r2_dir</span><span class="p">,</span> <span class="n">uncal_ref_targ_dir</span><span class="p">,</span> <span class="n">uncal_bg_sci_dir</span><span class="p">,</span> <span class="n">uncal_bg_ref_targ_dir</span><span class="p">]</span>

    <span class="k">for</span> <span class="nb">dir</span> <span class="ow">in</span> <span class="n">input_dirs</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="nb">dir</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="nb">dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running in demonstration mode and will download example data from MAST!
</pre></div>
</div>
</div>
</div>
<p>Identify list of uncalibrated files associated with visits.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Obtain a list of observation IDs for the specified demo program</span>
<span class="k">if</span> <span class="n">demo_mode</span><span class="p">:</span>
    <span class="n">obs_id_table</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">instrument_name</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;MIRI/CORON&quot;</span><span class="p">],</span>
                                               <span class="n">provenance_name</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;CALJWST&quot;</span><span class="p">],</span>
                                               <span class="n">proposal_id</span><span class="o">=</span><span class="p">[</span><span class="n">program</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Turn the list of visits into a list of uncalibrated data files</span>
<span class="k">if</span> <span class="n">demo_mode</span><span class="p">:</span>
    <span class="c1"># Define types of files to select</span>
    <span class="n">file_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;uncal&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;product_type&#39;</span><span class="p">:</span> <span class="s1">&#39;SCIENCE&#39;</span><span class="p">,</span> <span class="s1">&#39;productSubGroupDescription&#39;</span><span class="p">:</span> <span class="s1">&#39;UNCAL&#39;</span><span class="p">,</span> <span class="s1">&#39;calib_level&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]}}</span>

    <span class="c1"># Loop over visits identifying uncalibrated files that are associated with them</span>
    <span class="n">files_to_download</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">exposure</span> <span class="ow">in</span> <span class="p">(</span><span class="n">obs_id_table</span><span class="p">):</span>
        <span class="n">products</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">exposure</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">filetype</span><span class="p">,</span> <span class="n">query_dict</span> <span class="ow">in</span> <span class="n">file_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">filtered_products</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">filter_products</span><span class="p">(</span><span class="n">products</span><span class="p">,</span> <span class="n">productType</span><span class="o">=</span><span class="n">query_dict</span><span class="p">[</span><span class="s1">&#39;product_type&#39;</span><span class="p">],</span>
                                                             <span class="n">productSubGroupDescription</span><span class="o">=</span><span class="n">query_dict</span><span class="p">[</span><span class="s1">&#39;productSubGroupDescription&#39;</span><span class="p">],</span>
                                                             <span class="n">calib_level</span><span class="o">=</span><span class="n">query_dict</span><span class="p">[</span><span class="s1">&#39;calib_level&#39;</span><span class="p">])</span>
            <span class="n">files_to_download</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">filtered_products</span><span class="p">[</span><span class="s1">&#39;dataURI&#39;</span><span class="p">])</span>

    <span class="c1"># Cull to a unique list of files for each observation type </span>
    <span class="c1"># Science roll 1 </span>
    <span class="n">sci_r1_files_to_download</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">sci_r1_files_to_download</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">files_to_download</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">program</span> <span class="o">+</span> <span class="n">sci_r1_observtn</span><span class="p">)</span> <span class="ow">in</span> <span class="n">i</span><span class="p">])</span>

    <span class="c1"># Science roll 2 </span>
    <span class="n">sci_r2_files_to_download</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">sci_r2_files_to_download</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">files_to_download</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">program</span> <span class="o">+</span> <span class="n">sci_r2_observtn</span><span class="p">)</span> <span class="ow">in</span> <span class="n">i</span><span class="p">])</span>

    <span class="c1"># PSF Reference taraget data</span>
    <span class="n">ref_targ_files_to_download</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">ref_targ_files_to_download</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">files_to_download</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">program</span> <span class="o">+</span> <span class="n">ref_targ_observtn</span><span class="p">)</span> <span class="ow">in</span> <span class="n">i</span><span class="p">])</span>

    <span class="c1"># Background files (science assoc.)</span>
    <span class="n">bg_sci_files_to_download</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">bg_sci_files_to_download</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">files_to_download</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">program</span> <span class="o">+</span> <span class="n">bg_sci_observtn</span><span class="p">)</span> <span class="ow">in</span> <span class="n">i</span><span class="p">])</span>

    <span class="c1"># Background files (reference target assoc.)</span>
    <span class="n">bg_ref_targ_files_to_download</span> <span class="o">=</span> <span class="p">[]</span>  
    <span class="n">bg_ref_targ_files_to_download</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">files_to_download</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">program</span> <span class="o">+</span> <span class="n">bg_ref_targ_observtn</span><span class="p">)</span> <span class="ow">in</span> <span class="n">i</span><span class="p">])</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Science files selected for downloading: &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sci_r1_files_to_download</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">sci_r1_files_to_download</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PSF Reference target files selected for downloading: &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ref_targ_files_to_download</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Background selected for downloading: &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">bg_sci_files_to_download</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">bg_ref_targ_files_to_download</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Science files selected for downloading:  6
PSF Reference target files selected for downloading:  11
Background selected for downloading:  4
</pre></div>
</div>
</div>
</div>
<p>For the demo example, there should be 6 Science files, 11 PSF Reference files and 4 Background files selected for downloading.</p>
<p>Download all the uncal files and place them into the appropriate directories.</p>
<div class="alert alert-block alert-warning">
Warning: If this notebook is halted during this step the downloaded file may be incomplete, and cause crashes later on!
</div><div class="cell tag_scroll-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">demo_mode</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">sci_r1_files_to_download</span><span class="p">:</span>
        <span class="n">sci_r1_manifest</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">download_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">local_path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">uncal_sci_r1_dir</span><span class="p">,</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">sci_r2_files_to_download</span><span class="p">:</span>
        <span class="n">sci_r2_manifest</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">download_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">local_path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">uncal_sci_r2_dir</span><span class="p">,</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">ref_targ_files_to_download</span><span class="p">:</span>
        <span class="n">ref_targ_manifest</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">download_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">local_path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">uncal_ref_targ_dir</span><span class="p">,</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">bg_sci_files_to_download</span><span class="p">:</span>
        <span class="n">bg_manifest</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">download_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">local_path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">uncal_bg_sci_dir</span><span class="p">,</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">bg_ref_targ_files_to_download</span><span class="p">:</span>
        <span class="n">bg_ref_targ_manifest</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">download_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">local_path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">uncal_bg_ref_targ_dir</span><span class="p">,</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01386008001_02101_00001_mirimage_uncal.fits to ./miri_coro_demo_data/Obs008/uncal/jw01386008001_02101_00001_mirimage_uncal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01386008001_02101_00002_mirimage_uncal.fits to ./miri_coro_demo_data/Obs008/uncal/jw01386008001_02101_00002_mirimage_uncal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01386008001_04101_00001_mirimage_uncal.fits to ./miri_coro_demo_data/Obs008/uncal/jw01386008001_04101_00001_mirimage_uncal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01386009001_02101_00001_mirimage_uncal.fits to ./miri_coro_demo_data/Obs009/uncal/jw01386009001_02101_00001_mirimage_uncal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01386009001_02101_00002_mirimage_uncal.fits to ./miri_coro_demo_data/Obs009/uncal/jw01386009001_02101_00002_mirimage_uncal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01386009001_04101_00001_mirimage_uncal.fits to ./miri_coro_demo_data/Obs009/uncal/jw01386009001_04101_00001_mirimage_uncal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01386007001_02101_00001_mirimage_uncal.fits to ./miri_coro_demo_data/Obs007/uncal/jw01386007001_02101_00001_mirimage_uncal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01386007001_02101_00002_mirimage_uncal.fits to ./miri_coro_demo_data/Obs007/uncal/jw01386007001_02101_00002_mirimage_uncal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01386007001_04101_00001_mirimage_uncal.fits to ./miri_coro_demo_data/Obs007/uncal/jw01386007001_04101_00001_mirimage_uncal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01386007001_04101_00002_mirimage_uncal.fits to ./miri_coro_demo_data/Obs007/uncal/jw01386007001_04101_00002_mirimage_uncal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01386007001_04101_00003_mirimage_uncal.fits to ./miri_coro_demo_data/Obs007/uncal/jw01386007001_04101_00003_mirimage_uncal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01386007001_04101_00004_mirimage_uncal.fits to ./miri_coro_demo_data/Obs007/uncal/jw01386007001_04101_00004_mirimage_uncal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01386007001_04101_00005_mirimage_uncal.fits to ./miri_coro_demo_data/Obs007/uncal/jw01386007001_04101_00005_mirimage_uncal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01386007001_04101_00006_mirimage_uncal.fits to ./miri_coro_demo_data/Obs007/uncal/jw01386007001_04101_00006_mirimage_uncal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01386007001_04101_00007_mirimage_uncal.fits to ./miri_coro_demo_data/Obs007/uncal/jw01386007001_04101_00007_mirimage_uncal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01386007001_04101_00008_mirimage_uncal.fits to ./miri_coro_demo_data/Obs007/uncal/jw01386007001_04101_00008_mirimage_uncal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01386007001_04101_00009_mirimage_uncal.fits to ./miri_coro_demo_data/Obs007/uncal/jw01386007001_04101_00009_mirimage_uncal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01386030001_02101_00001_mirimage_uncal.fits to ./miri_coro_demo_data/Obs030/uncal/jw01386030001_02101_00001_mirimage_uncal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01386030001_03101_00001_mirimage_uncal.fits to ./miri_coro_demo_data/Obs030/uncal/jw01386030001_03101_00001_mirimage_uncal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01386031001_02101_00001_mirimage_uncal.fits to ./miri_coro_demo_data/Obs031/uncal/jw01386031001_02101_00001_mirimage_uncal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:JWST/product/jw01386031001_03101_00001_mirimage_uncal.fits to ./miri_coro_demo_data/Obs031/uncal/jw01386031001_03101_00001_mirimage_uncal.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
</div>
</div>
<hr style="border:1px solid gray"> </hr></section>
<section id="directory-setup">
<h2>4.-Directory Setup<a class="headerlink" href="#directory-setup" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<p>Set up detailed paths to input/output stages here. We will set up individual <code class="docutils literal notranslate"><span class="pre">stage1/</span></code> and <code class="docutils literal notranslate"><span class="pre">stage2/</span></code> sub directories for each observation, but a single <code class="docutils literal notranslate"><span class="pre">stage3/</span></code> directory for the combined <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/stable/jwst/pipeline/calwebb_coron3.html">calwebb_coron3 output products</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define output subdirectories to keep science data products organized</span>
<span class="c1"># Sci Roll 1</span>
<span class="n">uncal_sci_r1_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sci_r1_dir</span><span class="p">,</span> <span class="s1">&#39;uncal&#39;</span><span class="p">)</span> <span class="c1"># uncal inputs go here</span>
<span class="n">det1_sci_r1_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sci_r1_dir</span><span class="p">,</span> <span class="s1">&#39;stage1&#39;</span><span class="p">)</span>  <span class="c1"># calwebb_detector1 pipeline outputs will go here</span>
<span class="n">image2_sci_r1_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sci_r1_dir</span><span class="p">,</span> <span class="s1">&#39;stage2&#39;</span><span class="p">)</span>  <span class="c1"># calwebb_image2 pipeline outputs will go here</span>

<span class="c1"># Sci Roll 2</span>
<span class="n">uncal_sci_r2_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sci_r2_dir</span><span class="p">,</span> <span class="s1">&#39;uncal&#39;</span><span class="p">)</span> <span class="c1"># uncal inputs go here</span>
<span class="n">det1_sci_r2_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sci_r2_dir</span><span class="p">,</span> <span class="s1">&#39;stage1&#39;</span><span class="p">)</span>  <span class="c1"># calwebb_detector1 pipeline outputs will go here</span>
<span class="n">image2_sci_r2_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sci_r2_dir</span><span class="p">,</span> <span class="s1">&#39;stage2&#39;</span><span class="p">)</span>  <span class="c1"># calwebb_image2 pipeline outputs will go here</span>

<span class="c1"># Define output subdirectories to keep PSF reference target data products organized</span>
<span class="n">uncal_ref_targ_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ref_targ_dir</span><span class="p">,</span> <span class="s1">&#39;uncal&#39;</span><span class="p">)</span> <span class="c1"># uncal inputs go here</span>
<span class="n">det1_ref_targ_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ref_targ_dir</span><span class="p">,</span> <span class="s1">&#39;stage1&#39;</span><span class="p">)</span>  <span class="c1"># calwebb_detector1 pipeline outputs will go here</span>
<span class="n">image2_ref_targ_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ref_targ_dir</span><span class="p">,</span> <span class="s1">&#39;stage2&#39;</span><span class="p">)</span>  <span class="c1"># calwebb_image2 pipeline outputs will go here</span>

<span class="c1"># Define output subdirectories to keep background data products organized</span>
<span class="c1"># Sci Bkg</span>
<span class="n">uncal_bg_sci_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bg_sci_dir</span><span class="p">,</span> <span class="s1">&#39;uncal&#39;</span><span class="p">)</span> <span class="c1"># uncal inputs go here</span>
<span class="n">det1_bg_sci_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bg_sci_dir</span><span class="p">,</span> <span class="s1">&#39;stage1&#39;</span><span class="p">)</span>  <span class="c1"># calwebb_detector1 pipeline outputs will go here</span>
<span class="n">image2_bg_sci_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bg_sci_dir</span><span class="p">,</span> <span class="s1">&#39;stage2&#39;</span><span class="p">)</span>  <span class="c1"># calwebb_image2 pipeline outputs will go here</span>

<span class="c1"># Ref target Bkg</span>
<span class="n">uncal_bg_ref_targ_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bg_ref_targ_dir</span><span class="p">,</span> <span class="s1">&#39;uncal&#39;</span><span class="p">)</span> <span class="c1"># uncal inputs go here</span>
<span class="n">det1_bg_ref_targ_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bg_ref_targ_dir</span><span class="p">,</span> <span class="s1">&#39;stage1&#39;</span><span class="p">)</span>  <span class="c1"># calwebb_detector1 pipeline outputs will go here</span>
<span class="n">image2_bg_ref_targ_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bg_ref_targ_dir</span><span class="p">,</span> <span class="s1">&#39;stage2&#39;</span><span class="p">)</span>  <span class="c1"># calwebb_image2 pipeline outputs will go here</span>

<span class="n">coron3_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">basedir</span><span class="p">,</span> <span class="s1">&#39;stage3&#39;</span><span class="p">)</span>

<span class="c1"># We need to check that the desired output directories exist, and if not create them</span>
<span class="n">det1_dirs</span> <span class="o">=</span> <span class="p">[</span><span class="n">det1_sci_r1_dir</span><span class="p">,</span> <span class="n">det1_sci_r2_dir</span><span class="p">,</span> <span class="n">det1_ref_targ_dir</span><span class="p">,</span> <span class="n">det1_bg_sci_dir</span><span class="p">,</span> <span class="n">det1_bg_ref_targ_dir</span><span class="p">]</span>
<span class="n">image2_dirs</span> <span class="o">=</span> <span class="p">[</span><span class="n">image2_sci_r1_dir</span><span class="p">,</span> <span class="n">image2_sci_r2_dir</span><span class="p">,</span> <span class="n">image2_ref_targ_dir</span><span class="p">,</span> <span class="n">image2_bg_sci_dir</span><span class="p">,</span> <span class="n">image2_bg_ref_targ_dir</span><span class="p">]</span>

<span class="k">for</span> <span class="nb">dir</span> <span class="ow">in</span> <span class="n">det1_dirs</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="nb">dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="nb">dir</span><span class="p">)</span>
<span class="k">for</span> <span class="nb">dir</span> <span class="ow">in</span> <span class="n">image2_dirs</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="nb">dir</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="nb">dir</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">coron3_dir</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">coron3_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print out the time benchmark</span>
<span class="n">time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Runtime so far: </span><span class="si">{</span><span class="n">time1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">time0</span><span class="si">:</span><span class="s2">0.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Runtime so far: 321.5905 seconds
</pre></div>
</div>
</div>
</div>
<hr style="border:1px solid gray"> </hr></section>
<section id="detector1-pipeline">
<h2>5.-Detector1 Pipeline<a class="headerlink" href="#detector1-pipeline" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<p>In this section, we process our uncalibrated data through the calwebb_detector1 pipeline to create Stage 1 data products. For coronagraphic exposures, these data products include a <code class="docutils literal notranslate"><span class="pre">*_rate.fits</span></code> file (a 2D countrate product, based on averaging over all integrations in the exposure), but specifically also a <code class="docutils literal notranslate"><span class="pre">*_rateints.fits</span></code> file, a 3D countrate product, that contains the individual results of each integration, wherein 2D countrate images for each integration are stacked along the 3rd axis of the data cubes (ncols x nrows x nints). These data products have units of DN/s.</p>
<p>See https://jwst-docs.stsci.edu/jwst-science-calibration-pipeline/stages-of-jwst-data-processing/calwebb_detector1</p>
<p>By default, all steps in the calwebb_detector1 are run for MIRI except: the <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/stable/jwst/ipc/index.html#ipc-step">ipc</a> and <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/stable/jwst/charge_migration/index.html#charge-migration-step">charge_migration</a> steps. There are also several steps performed for MIRI data that are not performed for other instruments. These include: <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/emicorr/index.html#emicorr-step">emicorr</a>, <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/firstframe/index.html#firstframe-step">firstframe</a>, <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/lastframe/index.html#lastframe-step">lastframe</a>, <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/reset/index.html#reset-step">reset</a> and <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/rscd/index.html#rscd-step">rscd</a>.</p>
<div class="alert alert-block alert-warning">
To override certain steps and reference files, use the examples provided below.<br>
E.g., turn on detection of cosmic ray showers.
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up a dictionary to define how the Detector1 pipeline should be configured</span>

<span class="c1"># Boilerplate dictionary setup</span>
<span class="n">det1dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;group_scale&#39;</span><span class="p">],</span> <span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;dq_init&#39;</span><span class="p">],</span> <span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;emicorr&#39;</span><span class="p">],</span> <span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;saturation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{},</span> <span class="p">{},</span> <span class="p">{}</span>
<span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;firstframe&#39;</span><span class="p">],</span> <span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;lastframe&#39;</span><span class="p">],</span> <span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;reset&#39;</span><span class="p">],</span> <span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;linearity&#39;</span><span class="p">],</span> <span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;rscd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{},</span> <span class="p">{},</span> <span class="p">{},</span> <span class="p">{}</span>
<span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;dark_current&#39;</span><span class="p">],</span> <span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;refpix&#39;</span><span class="p">],</span> <span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;jump&#39;</span><span class="p">],</span> <span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;ramp_fit&#39;</span><span class="p">],</span> <span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;gain_scale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{},</span> <span class="p">{},</span> <span class="p">{},</span> <span class="p">{}</span>
<span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;clean_flicker_noise&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># Overrides for whether or not certain steps should be skipped (example)</span>
<span class="c1"># skipping refpix step</span>
<span class="c1">#det1dict[&#39;refpix&#39;][&#39;skip&#39;] = True</span>

<span class="c1"># Overrides for various reference files</span>
<span class="c1"># Files should be in the base local directory or provide full path</span>
<span class="c1">#det1dict[&#39;dq_init&#39;][&#39;override_mask&#39;] = &#39;myfile.fits&#39; # Bad pixel mask</span>
<span class="c1">#det1dict[&#39;saturation&#39;][&#39;override_saturation&#39;] = &#39;myfile.fits&#39;  # Saturation</span>
<span class="c1">#det1dict[&#39;reset&#39;][&#39;override_reset&#39;] = &#39;myfile.fits&#39;  # Reset</span>
<span class="c1">#det1dict[&#39;linearity&#39;][&#39;override_linearity&#39;] = &#39;myfile.fits&#39;  # Linearity</span>
<span class="c1">#det1dict[&#39;rscd&#39;][&#39;override_rscd&#39;] = &#39;myfile.fits&#39;  # RSCD</span>
<span class="c1">#det1dict[&#39;dark_current&#39;][&#39;override_dark&#39;] = &#39;myfile.fits&#39;  # Dark current subtraction</span>
<span class="c1">#det1dict[&#39;jump&#39;][&#39;override_gain&#39;] = &#39;myfile.fits&#39;  # Gain used by jump step</span>
<span class="c1">#det1dict[&#39;ramp_fit&#39;][&#39;override_gain&#39;] = &#39;myfile.fits&#39;  # Gain used by ramp fitting step</span>
<span class="c1">#det1dict[&#39;jump&#39;][&#39;override_readnoise&#39;] = &#39;myfile.fits&#39;  # Read noise used by jump step</span>
<span class="c1">#det1dict[&#39;ramp_fit&#39;][&#39;override_readnoise&#39;] = &#39;myfile.fits&#39;  # Read noise used by ramp fitting step</span>

<span class="c1"># Turn on multi-core processing (off by default).  Choose what fraction of cores to use (quarter, half, or all)</span>
<span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;jump&#39;</span><span class="p">][</span><span class="s1">&#39;maximum_cores&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;half&#39;</span> 

<span class="c1"># Save the frame-averaged dark data created during the dark current subtraction step</span>
<span class="c1">#det1dict[&#39;dark_current&#39;][&#39;dark_output&#39;] = &#39;dark.fits&#39;  # Frame-averaged dark </span>

<span class="c1"># Turn on detection of cosmic ray showers (off by default)</span>
<span class="c1">#det1dict[&#39;jump&#39;][&#39;find_showers&#39;] = True</span>
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-warning">
Below an example of how to insert custom pipeline steps using the
pre-hook/post-hook framework.
<p>For more information see <a class="reference external" href="https://jwst-docs.stsci.edu/jwst-science-calibration-pipeline/tips-and-tricks-for-working-with-the-jwst-pipeline">Tips and Trick for working with the JWST Pipeline</a>
</div></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a new step called XplyStep that multiplies everything by 1.0</span>
<span class="c1"># I.e., it does nothing, but could be changed to do something more interesting.</span>
<span class="k">class</span><span class="w"> </span><span class="nc">XplyStep</span><span class="p">(</span><span class="n">Step</span><span class="p">):</span>
    <span class="n">spec</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">    &#39;&#39;&#39;</span>
    <span class="n">class_alias</span> <span class="o">=</span> <span class="s1">&#39;xply&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">datamodels</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">sci</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">data</span>
        <span class="n">sci</span> <span class="o">=</span> <span class="n">sci</span> <span class="o">*</span> <span class="mf">1.0</span>
        <span class="n">result</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">sci</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Multiplied everything by one in custom step!&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>


<span class="c1"># And here we&#39;ll insert it into our pipeline dictionary to be run at the end right after the gain_scale step</span>
<span class="n">det1dict</span><span class="p">[</span><span class="s1">&#39;gain_scale&#39;</span><span class="p">][</span><span class="s1">&#39;post_hooks&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">XplyStep</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<section id="calibrating-science-files">
<h3>Calibrating Science Files<a class="headerlink" href="#calibrating-science-files" title="Permalink to this heading">#</a></h3>
<p>Look for input science files and run calwebb_detector1 pipeline using the call method. For the demo example there should be 2 input science files, one for the observation at roll 1 (Obs 8) and one for the observation at roll 2 (Obs 9).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uncal_sci_r1_dir</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;./miri_coro_demo_data/Obs008/uncal&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Look for input files of the form *uncal.fits from the science observation</span>
<span class="n">sstring1</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">uncal_sci_r1_dir</span><span class="p">,</span> <span class="s1">&#39;jw*mirimage*uncal.fits&#39;</span><span class="p">)</span>
<span class="n">sstring2</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">uncal_sci_r2_dir</span><span class="p">,</span> <span class="s1">&#39;jw*mirimage*uncal.fits&#39;</span><span class="p">)</span>

<span class="n">uncal_sci_r1_files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">sstring1</span><span class="p">))</span>
<span class="n">uncal_sci_r2_files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">sstring2</span><span class="p">))</span>

<span class="c1"># Check that these are the correct mask/filter to use</span>
<span class="n">uncal_sci_r1_files</span> <span class="o">=</span> <span class="n">select_mask_filter_files</span><span class="p">(</span><span class="n">uncal_sci_r1_files</span><span class="p">,</span> <span class="n">use_mask</span><span class="p">,</span> <span class="n">use_filter</span><span class="p">)</span>
<span class="n">uncal_sci_r2_files</span> <span class="o">=</span> <span class="n">select_mask_filter_files</span><span class="p">(</span><span class="n">uncal_sci_r2_files</span><span class="p">,</span> <span class="n">use_mask</span><span class="p">,</span> <span class="n">use_filter</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Found &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">uncal_sci_r1_files</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">uncal_sci_r2_files</span><span class="p">)))</span> <span class="o">+</span> <span class="s1">&#39; science input files&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found 2 science input files
</pre></div>
</div>
</div>
</div>
<div class="cell tag_scroll-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run the pipeline on these input files by a simple loop over files using</span>
<span class="c1"># our custom parameter dictionary</span>
<span class="k">if</span> <span class="n">dodet1</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">uncal_sci_r1_files</span><span class="p">:</span>
        <span class="n">Detector1Pipeline</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">det1dict</span><span class="p">,</span> <span class="n">save_results</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="n">det1_sci_r1_dir</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">uncal_sci_r2_files</span><span class="p">:</span>
        <span class="n">Detector1Pipeline</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">det1dict</span><span class="p">,</span> <span class="n">save_results</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="n">det1_sci_r2_dir</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Skipping Detector1 processing for SCI data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:04,966 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_system_datalvl_0002.rmap      694 bytes  (1 / 206 files) (0 / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:05,223 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_system_calver_0054.rmap    5.5 K bytes  (2 / 206 files) (694 / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:05,415 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_system_0053.imap        385 bytes  (3 / 206 files) (6.2 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:05,594 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_wavelengthrange_0024.rmap    1.4 K bytes  (4 / 206 files) (6.6 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:05,842 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_wavecorr_0005.rmap      884 bytes  (5 / 206 files) (8.0 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:06,019 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_superbias_0081.rmap   36.1 K bytes  (6 / 206 files) (8.8 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:06,291 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_sirskernel_0002.rmap      704 bytes  (7 / 206 files) (44.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:06,463 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_sflat_0027.rmap   20.6 K bytes  (8 / 206 files) (45.6 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:06,688 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_saturation_0018.rmap    2.0 K bytes  (9 / 206 files) (66.2 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:06,863 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_refpix_0015.rmap    1.6 K bytes  (10 / 206 files) (68.2 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:07,038 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_readnoise_0025.rmap    2.6 K bytes  (11 / 206 files) (69.8 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:07,247 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_pictureframe_0001.rmap      675 bytes  (12 / 206 files) (72.4 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:07,422 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_photom_0013.rmap      958 bytes  (13 / 206 files) (73.1 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:07,606 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_pathloss_0008.rmap    1.2 K bytes  (14 / 206 files) (74.0 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:07,789 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_pars-whitelightstep_0001.rmap      777 bytes  (15 / 206 files) (75.2 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:07,962 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_pars-spec2pipeline_0013.rmap    2.1 K bytes  (16 / 206 files) (76.0 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:08,136 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_pars-resamplespecstep_0002.rmap      709 bytes  (17 / 206 files) (78.1 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:08,309 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_pars-refpixstep_0002.rmap      831 bytes  (18 / 206 files) (78.8 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:08,482 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_pars-outlierdetectionstep_0005.rmap    1.1 K bytes  (19 / 206 files) (79.6 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:08,654 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_pars-jumpstep_0005.rmap      810 bytes  (20 / 206 files) (80.8 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:08,830 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_pars-image2pipeline_0008.rmap    1.0 K bytes  (21 / 206 files) (81.6 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:09,008 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_pars-detector1pipeline_0003.rmap    1.1 K bytes  (22 / 206 files) (82.6 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:09,178 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_pars-darkpipeline_0003.rmap      872 bytes  (23 / 206 files) (83.7 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:09,356 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_pars-darkcurrentstep_0003.rmap    1.8 K bytes  (24 / 206 files) (84.5 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:09,538 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_ote_0030.rmap    1.3 K bytes  (25 / 206 files) (86.3 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:09,715 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_msaoper_0016.rmap    1.5 K bytes  (26 / 206 files) (87.6 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:09,889 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_msa_0027.rmap    1.3 K bytes  (27 / 206 files) (89.1 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:10,079 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_mask_0043.rmap    3.5 K bytes  (28 / 206 files) (90.4 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:10,258 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_linearity_0017.rmap    1.6 K bytes  (29 / 206 files) (93.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:10,431 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_ipc_0006.rmap      876 bytes  (30 / 206 files) (95.5 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:10,613 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_ifuslicer_0017.rmap    1.5 K bytes  (31 / 206 files) (96.4 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:10,787 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_ifupost_0019.rmap    1.5 K bytes  (32 / 206 files) (97.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:10,969 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_ifufore_0017.rmap    1.5 K bytes  (33 / 206 files) (99.4 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:11,141 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_gain_0023.rmap    1.8 K bytes  (34 / 206 files) (100.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:11,310 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_fpa_0028.rmap    1.3 K bytes  (35 / 206 files) (102.7 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:11,478 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_fore_0026.rmap    5.0 K bytes  (36 / 206 files) (103.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:11,655 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_flat_0015.rmap    3.8 K bytes  (37 / 206 files) (108.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:11,832 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_fflat_0027.rmap    7.2 K bytes  (38 / 206 files) (112.7 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:12,004 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_extract1d_0018.rmap    2.3 K bytes  (39 / 206 files) (119.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:12,176 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_disperser_0028.rmap    5.7 K bytes  (40 / 206 files) (122.2 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:12,350 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_dflat_0007.rmap    1.1 K bytes  (41 / 206 files) (127.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:12,530 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_dark_0076.rmap   34.3 K bytes  (42 / 206 files) (129.0 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:12,754 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_cubepar_0015.rmap      966 bytes  (43 / 206 files) (163.4 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:12,929 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_collimator_0026.rmap    1.3 K bytes  (44 / 206 files) (164.3 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:13,103 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_camera_0026.rmap    1.3 K bytes  (45 / 206 files) (165.7 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:13,277 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_barshadow_0007.rmap    1.8 K bytes  (46 / 206 files) (166.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:13,455 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_area_0018.rmap    6.3 K bytes  (47 / 206 files) (168.7 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:13,629 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_apcorr_0009.rmap    5.6 K bytes  (48 / 206 files) (175.0 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:13,808 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nirspec_0406.imap     5.8 K bytes  (49 / 206 files) (180.6 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:13,987 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_wfssbkg_0011.rmap    3.1 K bytes  (50 / 206 files) (186.4 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:14,160 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_wavelengthrange_0008.rmap      897 bytes  (51 / 206 files) (189.5 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:14,332 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_trappars_0004.rmap      753 bytes  (52 / 206 files) (190.4 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:14,509 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_trapdensity_0005.rmap      705 bytes  (53 / 206 files) (191.2 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:14,686 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_throughput_0005.rmap    1.3 K bytes  (54 / 206 files) (191.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:14,853 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_superbias_0031.rmap    7.7 K bytes  (55 / 206 files) (193.1 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:15,027 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_specwcs_0015.rmap    3.1 K bytes  (56 / 206 files) (200.8 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:15,199 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_specprofile_0008.rmap    2.4 K bytes  (57 / 206 files) (203.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:15,375 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_speckernel_0006.rmap    1.0 K bytes  (58 / 206 files) (206.3 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:15,548 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_sirskernel_0002.rmap      700 bytes  (59 / 206 files) (207.4 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:15,721 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_saturation_0015.rmap      829 bytes  (60 / 206 files) (208.1 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:15,897 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_readnoise_0011.rmap      987 bytes  (61 / 206 files) (208.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:16,069 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_photom_0036.rmap    1.3 K bytes  (62 / 206 files) (209.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:16,243 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_persat_0007.rmap      674 bytes  (63 / 206 files) (211.1 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:16,415 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_pathloss_0003.rmap      758 bytes  (64 / 206 files) (211.8 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:16,590 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_pastasoss_0004.rmap      818 bytes  (65 / 206 files) (212.6 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:16,851 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_pars-undersamplecorrectionstep_0001.rmap      904 bytes  (66 / 206 files) (213.4 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:17,023 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_pars-tweakregstep_0012.rmap    3.1 K bytes  (67 / 206 files) (214.3 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:17,195 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_pars-spec2pipeline_0009.rmap    1.2 K bytes  (68 / 206 files) (217.4 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:17,360 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_pars-sourcecatalogstep_0002.rmap    2.3 K bytes  (69 / 206 files) (218.6 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:17,533 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_pars-resamplestep_0002.rmap      687 bytes  (70 / 206 files) (221.0 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:17,707 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_pars-outlierdetectionstep_0004.rmap    2.7 K bytes  (71 / 206 files) (221.6 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:17,885 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_pars-jumpstep_0007.rmap    6.4 K bytes  (72 / 206 files) (224.3 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:18,065 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_pars-image2pipeline_0005.rmap    1.0 K bytes  (73 / 206 files) (230.7 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:18,242 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_pars-detector1pipeline_0002.rmap    1.0 K bytes  (74 / 206 files) (231.7 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:18,418 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_pars-darkpipeline_0002.rmap      868 bytes  (75 / 206 files) (232.7 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:18,591 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_pars-darkcurrentstep_0001.rmap      591 bytes  (76 / 206 files) (233.6 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:18,777 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_pars-chargemigrationstep_0005.rmap    5.7 K bytes  (77 / 206 files) (234.2 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:18,950 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_nrm_0005.rmap      663 bytes  (78 / 206 files) (239.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:19,129 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_mask_0023.rmap    1.4 K bytes  (79 / 206 files) (240.5 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:19,306 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_linearity_0022.rmap      961 bytes  (80 / 206 files) (241.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:19,478 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_ipc_0007.rmap      651 bytes  (81 / 206 files) (242.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:19,657 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_gain_0011.rmap      797 bytes  (82 / 206 files) (243.5 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:19,828 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_flat_0023.rmap    5.9 K bytes  (83 / 206 files) (244.3 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:20,008 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_filteroffset_0010.rmap      853 bytes  (84 / 206 files) (250.2 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:20,181 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_extract1d_0007.rmap      905 bytes  (85 / 206 files) (251.1 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:20,356 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_drizpars_0004.rmap      519 bytes  (86 / 206 files) (252.0 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:20,520 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_distortion_0025.rmap    3.4 K bytes  (87 / 206 files) (252.5 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:20,692 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_dark_0035.rmap    7.8 K bytes  (88 / 206 files) (255.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:20,865 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_bkg_0005.rmap    3.1 K bytes  (89 / 206 files) (263.7 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:21,042 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_area_0014.rmap    2.7 K bytes  (90 / 206 files) (266.8 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:21,215 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_apcorr_0010.rmap    4.3 K bytes  (91 / 206 files) (269.5 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:21,387 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_abvegaoffset_0004.rmap    1.4 K bytes  (92 / 206 files) (273.8 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:21,553 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_niriss_0283.imap      5.8 K bytes  (93 / 206 files) (275.1 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:21,726 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_wfssbkg_0004.rmap    7.2 K bytes  (94 / 206 files) (280.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:21,899 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_wavelengthrange_0011.rmap      996 bytes  (95 / 206 files) (288.1 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:22,075 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_tsophot_0003.rmap      896 bytes  (96 / 206 files) (289.1 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:22,248 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_trappars_0003.rmap    1.6 K bytes  (97 / 206 files) (290.0 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:22,422 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_trapdensity_0003.rmap    1.6 K bytes  (98 / 206 files) (291.6 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:22,605 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_superbias_0020.rmap   19.6 K bytes  (99 / 206 files) (293.2 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:22,829 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_specwcs_0024.rmap    8.0 K bytes  (100 / 206 files) (312.8 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:23,010 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_sirskernel_0003.rmap      671 bytes  (101 / 206 files) (320.8 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:23,182 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_saturation_0011.rmap    2.8 K bytes  (102 / 206 files) (321.5 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:23,355 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_readnoise_0027.rmap   26.6 K bytes  (103 / 206 files) (324.3 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:23,572 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_psfmask_0008.rmap   28.4 K bytes  (104 / 206 files) (350.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:23,795 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_photom_0028.rmap    3.4 K bytes  (105 / 206 files) (379.2 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:23,994 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_persat_0005.rmap    1.6 K bytes  (106 / 206 files) (382.6 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:24,165 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_pars-whitelightstep_0004.rmap    2.0 K bytes  (107 / 206 files) (384.2 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:24,331 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_pars-tweakregstep_0003.rmap    4.5 K bytes  (108 / 206 files) (386.2 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:24,507 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_pars-spec2pipeline_0009.rmap      984 bytes  (109 / 206 files) (390.6 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:24,679 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_pars-sourcecatalogstep_0002.rmap    4.6 K bytes  (110 / 206 files) (391.6 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:24,852 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_pars-resamplestep_0002.rmap      687 bytes  (111 / 206 files) (396.3 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:25,023 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_pars-outlierdetectionstep_0003.rmap      940 bytes  (112 / 206 files) (397.0 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:25,299 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_pars-jumpstep_0005.rmap      806 bytes  (113 / 206 files) (397.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:25,473 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_pars-image2pipeline_0004.rmap    1.1 K bytes  (114 / 206 files) (398.7 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:25,649 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_pars-detector1pipeline_0006.rmap    1.7 K bytes  (115 / 206 files) (399.8 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:25,821 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_pars-darkpipeline_0002.rmap      868 bytes  (116 / 206 files) (401.6 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:25,994 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_pars-darkcurrentstep_0001.rmap      618 bytes  (117 / 206 files) (402.4 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:26,176 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_mask_0012.rmap    4.1 K bytes  (118 / 206 files) (403.1 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:26,353 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_linearity_0011.rmap    2.4 K bytes  (119 / 206 files) (407.2 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:26,519 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_ipc_0003.rmap    2.0 K bytes  (120 / 206 files) (409.6 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:26,693 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_gain_0016.rmap    2.1 K bytes  (121 / 206 files) (411.6 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:26,868 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_flat_0028.rmap   51.7 K bytes  (122 / 206 files) (413.7 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:27,145 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_filteroffset_0004.rmap    1.4 K bytes  (123 / 206 files) (465.4 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:27,311 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_extract1d_0005.rmap    1.2 K bytes  (124 / 206 files) (466.8 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:27,484 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_drizpars_0001.rmap      519 bytes  (125 / 206 files) (468.0 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:27,652 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_distortion_0033.rmap   53.4 K bytes  (126 / 206 files) (468.5 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:27,923 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_dark_0049.rmap   29.6 K bytes  (127 / 206 files) (521.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:28,152 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_bkg_0002.rmap    7.0 K bytes  (128 / 206 files) (551.5 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:28,325 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_area_0012.rmap   33.5 K bytes  (129 / 206 files) (558.4 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:28,559 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_apcorr_0008.rmap    4.3 K bytes  (130 / 206 files) (591.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:28,731 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_abvegaoffset_0003.rmap    1.3 K bytes  (131 / 206 files) (596.2 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:28,903 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_nircam_0326.imap      5.6 K bytes  (132 / 206 files) (597.5 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:29,077 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_wavelengthrange_0027.rmap      929 bytes  (133 / 206 files) (603.1 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:29,255 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_tsophot_0004.rmap      882 bytes  (134 / 206 files) (604.1 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:29,426 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_straymask_0009.rmap      987 bytes  (135 / 206 files) (604.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:29,598 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_specwcs_0044.rmap    5.9 K bytes  (136 / 206 files) (605.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:29,771 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_saturation_0015.rmap    1.2 K bytes  (137 / 206 files) (611.8 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:29,955 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_rscd_0008.rmap    1.0 K bytes  (138 / 206 files) (613.0 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:30,137 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_resol_0006.rmap      790 bytes  (139 / 206 files) (614.0 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:30,311 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_reset_0026.rmap    3.9 K bytes  (140 / 206 files) (614.8 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:30,482 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_regions_0035.rmap    4.4 K bytes  (141 / 206 files) (618.7 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:30,655 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_readnoise_0023.rmap    1.6 K bytes  (142 / 206 files) (623.0 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:30,826 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_psfmask_0009.rmap    2.1 K bytes  (143 / 206 files) (624.7 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:30,998 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_psf_0007.rmap    2.5 K bytes  (144 / 206 files) (626.8 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:31,171 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_photom_0057.rmap    3.7 K bytes  (145 / 206 files) (629.3 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:31,350 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_pathloss_0005.rmap      866 bytes  (146 / 206 files) (633.0 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:31,532 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_pars-whitelightstep_0003.rmap      912 bytes  (147 / 206 files) (633.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:31,705 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_pars-tweakregstep_0003.rmap    1.8 K bytes  (148 / 206 files) (634.8 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:31,884 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_pars-spec3pipeline_0010.rmap      886 bytes  (149 / 206 files) (636.7 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:32,055 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_pars-spec2pipeline_0013.rmap    1.4 K bytes  (150 / 206 files) (637.5 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:32,229 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_pars-sourcecatalogstep_0003.rmap    1.9 K bytes  (151 / 206 files) (639.0 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:32,405 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_pars-resamplestep_0002.rmap      677 bytes  (152 / 206 files) (640.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:32,578 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_pars-resamplespecstep_0002.rmap      706 bytes  (153 / 206 files) (641.5 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:32,753 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_pars-outlierdetectionstep_0020.rmap    3.4 K bytes  (154 / 206 files) (642.2 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:32,929 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_pars-jumpstep_0011.rmap    1.6 K bytes  (155 / 206 files) (645.6 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:33,102 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_pars-image2pipeline_0010.rmap    1.1 K bytes  (156 / 206 files) (647.2 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:33,276 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_pars-extract1dstep_0003.rmap      807 bytes  (157 / 206 files) (648.3 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:33,447 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_pars-emicorrstep_0003.rmap      796 bytes  (158 / 206 files) (649.1 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:33,611 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_pars-detector1pipeline_0010.rmap    1.6 K bytes  (159 / 206 files) (649.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:33,777 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_pars-darkpipeline_0002.rmap      860 bytes  (160 / 206 files) (651.5 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:33,951 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_pars-darkcurrentstep_0002.rmap      683 bytes  (161 / 206 files) (652.3 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:34,127 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_mrsxartcorr_0002.rmap    2.2 K bytes  (162 / 206 files) (653.0 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:34,308 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_mrsptcorr_0005.rmap    2.0 K bytes  (163 / 206 files) (655.2 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:34,474 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_mask_0028.rmap    4.6 K bytes  (164 / 206 files) (657.1 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:34,650 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_linearity_0018.rmap    2.8 K bytes  (165 / 206 files) (661.8 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:34,828 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_ipc_0008.rmap      700 bytes  (166 / 206 files) (664.6 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:35,002 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_gain_0013.rmap    3.9 K bytes  (167 / 206 files) (665.3 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:35,169 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_fringefreq_0003.rmap    1.4 K bytes  (168 / 206 files) (669.2 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:35,344 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_fringe_0019.rmap    3.9 K bytes  (169 / 206 files) (670.7 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:35,514 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_flat_0067.rmap   15.7 K bytes  (170 / 206 files) (674.6 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:35,740 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_filteroffset_0026.rmap    2.1 K bytes  (171 / 206 files) (690.2 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:35,914 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_extract1d_0020.rmap    1.4 K bytes  (172 / 206 files) (692.3 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:36,084 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_emicorr_0004.rmap      663 bytes  (173 / 206 files) (693.7 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:36,255 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_drizpars_0002.rmap      511 bytes  (174 / 206 files) (694.4 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:36,428 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_distortion_0041.rmap    4.8 K bytes  (175 / 206 files) (694.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:36,601 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_dark_0037.rmap    4.4 K bytes  (176 / 206 files) (699.6 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:36,776 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_cubepar_0017.rmap      800 bytes  (177 / 206 files) (704.0 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:36,952 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_area_0015.rmap      866 bytes  (178 / 206 files) (704.8 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:37,129 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_apcorr_0020.rmap    5.0 K bytes  (179 / 206 files) (705.7 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:37,302 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_abvegaoffset_0003.rmap    1.3 K bytes  (180 / 206 files) (710.6 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:37,468 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_miri_0449.imap        5.8 K bytes  (181 / 206 files) (711.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:37,640 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_fgs_trappars_0004.rmap      903 bytes  (182 / 206 files) (717.7 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:37,816 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_fgs_trapdensity_0006.rmap      930 bytes  (183 / 206 files) (718.6 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:37,990 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_fgs_superbias_0017.rmap    3.8 K bytes  (184 / 206 files) (719.6 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:38,164 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_fgs_saturation_0009.rmap      779 bytes  (185 / 206 files) (723.4 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:38,336 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_fgs_readnoise_0014.rmap    1.3 K bytes  (186 / 206 files) (724.1 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:38,511 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_fgs_photom_0014.rmap    1.1 K bytes  (187 / 206 files) (725.4 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:38,685 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_fgs_persat_0006.rmap      884 bytes  (188 / 206 files) (726.5 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:38,857 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_fgs_pars-tweakregstep_0002.rmap      850 bytes  (189 / 206 files) (727.4 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:39,032 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_fgs_pars-sourcecatalogstep_0001.rmap      636 bytes  (190 / 206 files) (728.2 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:39,205 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_fgs_pars-outlierdetectionstep_0001.rmap      654 bytes  (191 / 206 files) (728.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:39,379 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_fgs_pars-image2pipeline_0005.rmap      974 bytes  (192 / 206 files) (729.5 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:39,549 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_fgs_pars-detector1pipeline_0002.rmap    1.0 K bytes  (193 / 206 files) (730.5 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:39,723 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_fgs_pars-darkpipeline_0002.rmap      856 bytes  (194 / 206 files) (731.5 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:39,896 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_fgs_mask_0023.rmap    1.1 K bytes  (195 / 206 files) (732.4 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:40,068 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_fgs_linearity_0015.rmap      925 bytes  (196 / 206 files) (733.5 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:40,245 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_fgs_ipc_0003.rmap       614 bytes  (197 / 206 files) (734.4 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:40,527 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_fgs_gain_0010.rmap      890 bytes  (198 / 206 files) (735.0 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:40,700 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_fgs_flat_0009.rmap    1.1 K bytes  (199 / 206 files) (735.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:40,872 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_fgs_distortion_0011.rmap    1.2 K bytes  (200 / 206 files) (737.0 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:41,044 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_fgs_dark_0017.rmap    4.3 K bytes  (201 / 206 files) (738.2 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:41,219 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_fgs_area_0010.rmap    1.2 K bytes  (202 / 206 files) (742.5 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:41,385 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_fgs_apcorr_0004.rmap    4.0 K bytes  (203 / 206 files) (743.7 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:41,551 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_fgs_abvegaoffset_0002.rmap    1.3 K bytes  (204 / 206 files) (747.7 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:41,728 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_fgs_0123.imap         5.1 K bytes  (205 / 206 files) (748.9 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:41,904 - CRDS - INFO -  Fetching  /home/runner/crds/mappings/jwst/jwst_1413.pmap               580 bytes  (206 / 206 files) (754.0 K / 754.6 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:42,600 - CRDS - INFO -  Fetching  /home/runner/crds/references/jwst/miri/jwst_miri_pars-emicorrstep_0003.asdf    1.0 K bytes  (1 / 1 files) (0 / 1.0 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:42,784 - stpipe - INFO - PARS-EMICORRSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-emicorrstep_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:42,801 - CRDS - INFO -  Fetching  /home/runner/crds/references/jwst/miri/jwst_miri_pars-darkcurrentstep_0001.asdf      936 bytes  (1 / 1 files) (0 / 936 bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:42,979 - stpipe - INFO - PARS-DARKCURRENTSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-darkcurrentstep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:42,989 - CRDS - INFO -  Fetching  /home/runner/crds/references/jwst/miri/jwst_miri_pars-jumpstep_0004.asdf    1.9 K bytes  (1 / 1 files) (0 / 1.9 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:43,169 - stpipe - INFO - PARS-JUMPSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-jumpstep_0004.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:43,181 - CRDS - INFO -  Fetching  /home/runner/crds/references/jwst/miri/jwst_miri_pars-detector1pipeline_0008.asdf    1.7 K bytes  (1 / 1 files) (0 / 1.7 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:43,358 - stpipe - INFO - PARS-DETECTOR1PIPELINE parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-detector1pipeline_0008.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:43,374 - stpipe.Detector1Pipeline - INFO - Detector1Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:43,375 - stpipe.Detector1Pipeline.group_scale - INFO - GroupScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:43,375 - stpipe.Detector1Pipeline.dq_init - INFO - DQInitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:43,376 - stpipe.Detector1Pipeline.emicorr - INFO - EmiCorrStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:43,377 - stpipe.Detector1Pipeline.saturation - INFO - SaturationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:43,378 - stpipe.Detector1Pipeline.ipc - INFO - IPCStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:43,379 - stpipe.Detector1Pipeline.superbias - INFO - SuperBiasStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:43,380 - stpipe.Detector1Pipeline.refpix - INFO - RefPixStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:43,381 - stpipe.Detector1Pipeline.rscd - INFO - RscdStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:43,382 - stpipe.Detector1Pipeline.firstframe - INFO - FirstFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:43,382 - stpipe.Detector1Pipeline.lastframe - INFO - LastFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:43,383 - stpipe.Detector1Pipeline.linearity - INFO - LinearityStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:43,384 - stpipe.Detector1Pipeline.dark_current - INFO - DarkCurrentStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:43,385 - stpipe.Detector1Pipeline.reset - INFO - ResetStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:43,386 - stpipe.Detector1Pipeline.persistence - INFO - PersistenceStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:43,386 - stpipe.Detector1Pipeline.charge_migration - INFO - ChargeMigrationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:43,388 - stpipe.Detector1Pipeline.jump - INFO - JumpStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:43,389 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - CleanFlickerNoiseStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:43,390 - stpipe.Detector1Pipeline.ramp_fit - INFO - RampFitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:43,391 - stpipe.Detector1Pipeline.gain_scale - INFO - GainScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:43,394 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - XplyStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:43,516 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline running with args (np.str_(&#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs008/uncal/jw01386008001_04101_00001_mirimage_uncal.fits&#39;),).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:43,536 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./miri_coro_demo_data/Obs008/stage1
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_calibrated_ramp: False
  steps:
    group_scale:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dq_init:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    emicorr:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: joint
      nints_to_phase: None
      nbins: None
      scale_reference: True
      onthefly_corr_freq: None
      use_n_cycles: 3
      fit_ints_separately: False
      user_supplied_reffile: None
      save_intermediate_results: False
    saturation:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      n_pix_grow_sat: 1
      use_readpatt: True
    ipc:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    superbias:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    refpix:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      odd_even_columns: True
      use_side_ref_pixels: True
      side_smoothing_length: 11
      side_gain: 1.0
      odd_even_rows: True
      ovr_corr_mitigation_ftr: 3.0
      preserve_irs2_refpix: False
      irs2_mean_subtraction: False
      refpix_algorithm: median
      sigreject: 4.0
      gaussmooth: 1.0
      halfwidth: 30
    rscd:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    firstframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bright_use_group1: False
    lastframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    linearity:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dark_current:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      dark_output: None
      average_dark_current: 1.0
    reset:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    persistence:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      input_trapsfilled: &#39;&#39;
      flag_pers_cutoff: 40.0
      save_persistence: False
      save_trapsfilled: True
      modify_input: False
    charge_migration:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      signal_threshold: 25000.0
    jump:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      rejection_threshold: 4.0
      three_group_rejection_threshold: 6.0
      four_group_rejection_threshold: 5.0
      maximum_cores: half
      flag_4_neighbors: True
      max_jump_to_flag_neighbors: 1000
      min_jump_to_flag_neighbors: 30
      after_jump_flag_dn1: 500
      after_jump_flag_time1: 15
      after_jump_flag_dn2: 1000
      after_jump_flag_time2: 3000
      expand_large_events: False
      min_sat_area: 1
      min_jump_area: 0
      expand_factor: 0
      use_ellipses: False
      sat_required_snowball: False
      min_sat_radius_extend: 0.0
      sat_expand: 0
      edge_size: 0
      mask_snowball_core_next_int: True
      snowball_time_masked_next_int: 4000
      find_showers: False
      max_shower_amplitude: 4.0
      extend_snr_threshold: 3.0
      extend_min_area: 50
      extend_inner_radius: 1
      extend_outer_radius: 2.6
      extend_ellipse_expand_ratio: 1.1
      time_masked_after_shower: 30
      min_diffs_single_pass: 10
      max_extended_radius: 200
      minimum_groups: 3
      minimum_sigclip_groups: 100
      only_use_ints: True
    clean_flicker_noise:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      fit_method: median
      fit_by_channel: False
      background_method: median
      background_box_size: None
      mask_science_regions: False
      apply_flat_field: False
      n_sigma: 2.0
      fit_histogram: False
      single_mask: True
      user_mask: None
      save_mask: False
      save_background: False
      save_noise: False
    ramp_fit:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: OLS_C
      int_name: &#39;&#39;
      save_opt: False
      opt_name: &#39;&#39;
      suppress_one_group: True
      firstgroup: None
      lastgroup: None
      maximum_cores: &#39;1&#39;
    gain_scale:
      pre_hooks: []
      post_hooks:
      - !!python/name:__main__.XplyStep &#39;&#39;
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:43,556 - stpipe.Detector1Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01386008001_04101_00001_mirimage_uncal.fits&#39; reftypes = [&#39;dark&#39;, &#39;emicorr&#39;, &#39;gain&#39;, &#39;linearity&#39;, &#39;mask&#39;, &#39;persat&#39;, &#39;readnoise&#39;, &#39;reset&#39;, &#39;rscd&#39;, &#39;saturation&#39;, &#39;superbias&#39;, &#39;trapdensity&#39;, &#39;trappars&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:42:43,559 - CRDS - INFO -  Fetching  /home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits  774.9 M bytes  (1 / 9 files) (0 / 845.8 M bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:01,425 - CRDS - INFO -  Fetching  /home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf   17.1 K bytes  (2 / 9 files) (774.9 M / 845.8 M bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:01,639 - CRDS - INFO -  Fetching  /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits   12.7 M bytes  (3 / 9 files) (775.0 M / 845.8 M bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:02,475 - CRDS - INFO -  Fetching  /home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits   25.4 M bytes  (4 / 9 files) (787.7 M / 845.8 M bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:04,166 - CRDS - INFO -  Fetching  /home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits    4.3 M bytes  (5 / 9 files) (813.0 M / 845.8 M bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:04,772 - CRDS - INFO -  Fetching  /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits    4.2 M bytes  (6 / 9 files) (817.3 M / 845.8 M bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:05,423 - CRDS - INFO -  Fetching  /home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits   15.8 M bytes  (7 / 9 files) (821.5 M / 845.8 M bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:06,629 - CRDS - INFO -  Fetching  /home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits   37.4 K bytes  (8 / 9 files) (837.3 M / 845.8 M bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:06,866 - CRDS - INFO -  Fetching  /home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits    8.5 M bytes  (9 / 9 files) (837.3 M / 845.8 M bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:07,640 - stpipe.Detector1Pipeline - INFO - Prefetch for DARK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:07,641 - stpipe.Detector1Pipeline - INFO - Prefetch for EMICORR reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:07,641 - stpipe.Detector1Pipeline - INFO - Prefetch for GAIN reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:07,642 - stpipe.Detector1Pipeline - INFO - Prefetch for LINEARITY reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:07,642 - stpipe.Detector1Pipeline - INFO - Prefetch for MASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:07,643 - stpipe.Detector1Pipeline - INFO - Prefetch for PERSAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:07,643 - stpipe.Detector1Pipeline - INFO - Prefetch for READNOISE reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:07,643 - stpipe.Detector1Pipeline - INFO - Prefetch for RESET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:07,644 - stpipe.Detector1Pipeline - INFO - Prefetch for RSCD reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:07,644 - stpipe.Detector1Pipeline - INFO - Prefetch for SATURATION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:07,645 - stpipe.Detector1Pipeline - INFO - Prefetch for SUPERBIAS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:07,645 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPDENSITY reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:07,645 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPPARS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:07,646 - jwst.pipeline.calwebb_detector1 - INFO - Starting calwebb_detector1 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:10,080 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale running with args (&lt;RampModel(60, 250, 224, 288) from jw01386008001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:10,087 - stpipe.Detector1Pipeline.group_scale - INFO - NFRAMES and FRMDIVSR are equal; correction not needed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:10,088 - stpipe.Detector1Pipeline.group_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:10,089 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:10,221 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init running with args (&lt;RampModel(60, 250, 224, 288) from jw01386008001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:10,232 - stpipe.Detector1Pipeline.dq_init - INFO - Using MASK reference file /home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:10,993 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:11,005 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:11,008 - jwst.dq_init.dq_initialization - INFO - Extracting mask subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:12,965 - CRDS - INFO -  Calibration SW Found: jwst 1.19.1 (/usr/share/miniconda/lib/python3.13/site-packages/jwst-1.19.1.dist-info)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:14,447 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:14,590 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr running with args (&lt;RampModel(60, 250, 224, 288) from jw01386008001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:15,328 - stpipe.Detector1Pipeline.emicorr - INFO - Using CRDS reference file: /home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:15,346 - jwst.emicorr.emicorr - INFO - Using reference file to get subarray case.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:15,346 - jwst.emicorr.emicorr - INFO - With configuration: Subarray=MASK1550, Read_pattern=FASTR1, Detector=MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:15,347 - jwst.emicorr.emicorr - INFO - Will correct data for the following 2 frequencies: 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:15,347 - jwst.emicorr.emicorr - INFO -    [&#39;Hz390&#39;, &#39;Hz10&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:43:15,347 - jwst.emicorr.emicorr - INFO - Running EMI fit with algorithm = &#39;joint&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:28,290 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:28,452 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation running with args (&lt;RampModel(60, 250, 224, 288) from jw01386008001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:28,466 - stpipe.Detector1Pipeline.saturation - INFO - Using SATURATION reference file /home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:28,466 - stpipe.Detector1Pipeline.saturation - INFO - Using SUPERBIAS reference file N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:28,489 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:28,498 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:29,251 - jwst.saturation.saturation - INFO - Extracting reference file subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:29,258 - jwst.saturation.saturation - INFO - Using read_pattern with nframes 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:36,419 - stcal.saturation.saturation - INFO - Detected 672 saturated pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:36,626 - stcal.saturation.saturation - INFO - Detected 5 A/D floor pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:36,630 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:36,776 - stpipe.Detector1Pipeline.ipc - INFO - Step ipc running with args (&lt;RampModel(60, 250, 224, 288) from jw01386008001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:36,777 - stpipe.Detector1Pipeline.ipc - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:36,895 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe running with args (&lt;RampModel(60, 250, 224, 288) from jw01386008001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:37,645 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:37,789 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe running with args (&lt;RampModel(60, 250, 224, 288) from jw01386008001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:38,542 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:38,687 - stpipe.Detector1Pipeline.reset - INFO - Step reset running with args (&lt;RampModel(60, 250, 224, 288) from jw01386008001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:38,705 - stpipe.Detector1Pipeline.reset - INFO - Using RESET reference file /home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:38,726 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:38,729 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:39,549 - stpipe.Detector1Pipeline.reset - INFO - Step reset done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:39,694 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity running with args (&lt;RampModel(60, 250, 224, 288) from jw01386008001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:39,706 - stpipe.Detector1Pipeline.linearity - INFO - Using Linearity reference file /home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:39,732 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:39,741 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:46,084 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:46,234 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd running with args (&lt;RampModel(60, 250, 224, 288) from jw01386008001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:46,246 - stpipe.Detector1Pipeline.rscd - INFO - Using RSCD reference file /home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:47,028 - jwst.rscd.rscd_sub - INFO - Number of groups to skip for integrations 2 and higher: 4
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:47,033 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:47,182 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current running with args (&lt;RampModel(60, 250, 224, 288) from jw01386008001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:47,194 - stpipe.Detector1Pipeline.dark_current - INFO - Using DARK reference file /home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:48,072 - stdatamodels.dynamicdq - WARNING - Keyword UNDERSAMP does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:48,075 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:48,077 - stpipe.Detector1Pipeline.dark_current - INFO - Using Poisson noise from average dark current 1.0 e-/sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:48,077 - stcal.dark_current.dark_sub - INFO - Science data nints=60, ngroups=250, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:48,078 - stcal.dark_current.dark_sub - INFO - Dark data nints=3, ngroups=500, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:49,787 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:49,940 - stpipe.Detector1Pipeline.refpix - INFO - Step refpix running with args (&lt;RampModel(60, 250, 224, 288) from jw01386008001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:49,941 - stpipe.Detector1Pipeline.refpix - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:50,060 - stpipe.Detector1Pipeline.charge_migration - INFO - Step charge_migration running with args (&lt;RampModel(60, 250, 224, 288) from jw01386008001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:50,061 - stpipe.Detector1Pipeline.charge_migration - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:50,183 - stpipe.Detector1Pipeline.jump - INFO - Step jump running with args (&lt;RampModel(60, 250, 224, 288) from jw01386008001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:50,190 - stpipe.Detector1Pipeline.jump - INFO - CR rejection threshold = 4 sigma
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:50,190 - stpipe.Detector1Pipeline.jump - INFO - Maximum cores to use = half
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:50,941 - stpipe.Detector1Pipeline.jump - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:50,944 - stpipe.Detector1Pipeline.jump - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:50,970 - stpipe.Detector1Pipeline.jump - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:50,976 - stpipe.Detector1Pipeline.jump - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:52,144 - stcal.jump.jump - INFO - Executing two-point difference method
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:44:52,145 - stcal.jump.jump - INFO - Creating 4 processes for jump detection 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:45:21,240 - stcal.jump.jump - INFO - Total elapsed time = 29.0953 sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:45:22,281 - stpipe.Detector1Pipeline.jump - INFO - The execution time in seconds: 32.091021
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:45:22,284 - stpipe.Detector1Pipeline.jump - INFO - Step jump done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:45:22,435 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step clean_flicker_noise running with args (&lt;RampModel(60, 250, 224, 288) from jw01386008001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:45:22,436 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:45:22,560 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit running with args (&lt;RampModel(60, 250, 224, 288) from jw01386008001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:45:23,326 - jwst.ramp_fitting.ramp_fit_step - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:45:23,327 - jwst.ramp_fitting.ramp_fit_step - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:45:23,352 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:45:23,357 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:45:23,362 - jwst.ramp_fitting.ramp_fit_step - INFO - Using algorithm = OLS_C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:45:23,362 - jwst.ramp_fitting.ramp_fit_step - INFO - Using weighting = optimal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:45:25,817 - stcal.ramp_fitting.ols_fit - INFO - Number of multiprocessing slices: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:45:25,833 - stcal.ramp_fitting.ols_fit - INFO - Number of leading groups that are flagged as DO_NOT_USE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:45:25,834 - stcal.ramp_fitting.ols_fit - INFO - MIRI dataset has all pixels in the final group flagged as DO_NOT_USE.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:09,132 - stcal.ramp_fitting.ols_fit - INFO - Ramp Fitting C Time: 103.29736638069153
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:09,201 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:09,354 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;ImageModel(224, 288) from jw01386008001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:09,382 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:09,383 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:09,516 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;ImageModel(224, 288) from jw01386008001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:09,530 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:09,531 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:09,533 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:09,662 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;CubeModel(60, 224, 288) from jw01386008001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:09,683 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:09,684 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:09,818 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;CubeModel(60, 224, 288) from jw01386008001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:09,848 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:09,850 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:09,851 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:09,965 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs008/stage1/jw01386008001_04101_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:09,966 - jwst.pipeline.calwebb_detector1 - INFO - ... ending calwebb_detector1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:09,966 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,019 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs008/stage1/jw01386008001_04101_00001_mirimage_rate.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,020 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,020 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,044 - stpipe - INFO - PARS-EMICORRSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-emicorrstep_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,058 - stpipe - INFO - PARS-DARKCURRENTSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-darkcurrentstep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,068 - stpipe - INFO - PARS-JUMPSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-jumpstep_0004.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,079 - stpipe - INFO - PARS-DETECTOR1PIPELINE parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-detector1pipeline_0008.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,095 - stpipe.Detector1Pipeline - INFO - Detector1Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,095 - stpipe.Detector1Pipeline.group_scale - INFO - GroupScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,096 - stpipe.Detector1Pipeline.dq_init - INFO - DQInitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,097 - stpipe.Detector1Pipeline.emicorr - INFO - EmiCorrStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,098 - stpipe.Detector1Pipeline.saturation - INFO - SaturationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,098 - stpipe.Detector1Pipeline.ipc - INFO - IPCStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,099 - stpipe.Detector1Pipeline.superbias - INFO - SuperBiasStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,100 - stpipe.Detector1Pipeline.refpix - INFO - RefPixStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,101 - stpipe.Detector1Pipeline.rscd - INFO - RscdStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,101 - stpipe.Detector1Pipeline.firstframe - INFO - FirstFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,102 - stpipe.Detector1Pipeline.lastframe - INFO - LastFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,103 - stpipe.Detector1Pipeline.linearity - INFO - LinearityStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,103 - stpipe.Detector1Pipeline.dark_current - INFO - DarkCurrentStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,104 - stpipe.Detector1Pipeline.reset - INFO - ResetStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,105 - stpipe.Detector1Pipeline.persistence - INFO - PersistenceStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,106 - stpipe.Detector1Pipeline.charge_migration - INFO - ChargeMigrationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,107 - stpipe.Detector1Pipeline.jump - INFO - JumpStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,108 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - CleanFlickerNoiseStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,109 - stpipe.Detector1Pipeline.ramp_fit - INFO - RampFitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,110 - stpipe.Detector1Pipeline.gain_scale - INFO - GainScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,111 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - XplyStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,246 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline running with args (np.str_(&#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs009/uncal/jw01386009001_04101_00001_mirimage_uncal.fits&#39;),).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,267 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./miri_coro_demo_data/Obs009/stage1
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_calibrated_ramp: False
  steps:
    group_scale:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dq_init:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    emicorr:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: joint
      nints_to_phase: None
      nbins: None
      scale_reference: True
      onthefly_corr_freq: None
      use_n_cycles: 3
      fit_ints_separately: False
      user_supplied_reffile: None
      save_intermediate_results: False
    saturation:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      n_pix_grow_sat: 1
      use_readpatt: True
    ipc:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    superbias:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    refpix:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      odd_even_columns: True
      use_side_ref_pixels: True
      side_smoothing_length: 11
      side_gain: 1.0
      odd_even_rows: True
      ovr_corr_mitigation_ftr: 3.0
      preserve_irs2_refpix: False
      irs2_mean_subtraction: False
      refpix_algorithm: median
      sigreject: 4.0
      gaussmooth: 1.0
      halfwidth: 30
    rscd:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    firstframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bright_use_group1: False
    lastframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    linearity:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dark_current:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      dark_output: None
      average_dark_current: 1.0
    reset:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    persistence:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      input_trapsfilled: &#39;&#39;
      flag_pers_cutoff: 40.0
      save_persistence: False
      save_trapsfilled: True
      modify_input: False
    charge_migration:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      signal_threshold: 25000.0
    jump:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      rejection_threshold: 4.0
      three_group_rejection_threshold: 6.0
      four_group_rejection_threshold: 5.0
      maximum_cores: half
      flag_4_neighbors: True
      max_jump_to_flag_neighbors: 1000
      min_jump_to_flag_neighbors: 30
      after_jump_flag_dn1: 500
      after_jump_flag_time1: 15
      after_jump_flag_dn2: 1000
      after_jump_flag_time2: 3000
      expand_large_events: False
      min_sat_area: 1
      min_jump_area: 0
      expand_factor: 0
      use_ellipses: False
      sat_required_snowball: False
      min_sat_radius_extend: 0.0
      sat_expand: 0
      edge_size: 0
      mask_snowball_core_next_int: True
      snowball_time_masked_next_int: 4000
      find_showers: False
      max_shower_amplitude: 4.0
      extend_snr_threshold: 3.0
      extend_min_area: 50
      extend_inner_radius: 1
      extend_outer_radius: 2.6
      extend_ellipse_expand_ratio: 1.1
      time_masked_after_shower: 30
      min_diffs_single_pass: 10
      max_extended_radius: 200
      minimum_groups: 3
      minimum_sigclip_groups: 100
      only_use_ints: True
    clean_flicker_noise:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      fit_method: median
      fit_by_channel: False
      background_method: median
      background_box_size: None
      mask_science_regions: False
      apply_flat_field: False
      n_sigma: 2.0
      fit_histogram: False
      single_mask: True
      user_mask: None
      save_mask: False
      save_background: False
      save_noise: False
    ramp_fit:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: OLS_C
      int_name: &#39;&#39;
      save_opt: False
      opt_name: &#39;&#39;
      suppress_one_group: True
      firstgroup: None
      lastgroup: None
      maximum_cores: &#39;1&#39;
    gain_scale:
      pre_hooks: []
      post_hooks:
      - !!python/name:__main__.XplyStep &#39;&#39;
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,287 - stpipe.Detector1Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01386009001_04101_00001_mirimage_uncal.fits&#39; reftypes = [&#39;dark&#39;, &#39;emicorr&#39;, &#39;gain&#39;, &#39;linearity&#39;, &#39;mask&#39;, &#39;persat&#39;, &#39;readnoise&#39;, &#39;reset&#39;, &#39;rscd&#39;, &#39;saturation&#39;, &#39;superbias&#39;, &#39;trapdensity&#39;, &#39;trappars&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,290 - stpipe.Detector1Pipeline - INFO - Prefetch for DARK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,290 - stpipe.Detector1Pipeline - INFO - Prefetch for EMICORR reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,290 - stpipe.Detector1Pipeline - INFO - Prefetch for GAIN reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,291 - stpipe.Detector1Pipeline - INFO - Prefetch for LINEARITY reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,291 - stpipe.Detector1Pipeline - INFO - Prefetch for MASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,291 - stpipe.Detector1Pipeline - INFO - Prefetch for PERSAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,292 - stpipe.Detector1Pipeline - INFO - Prefetch for READNOISE reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,292 - stpipe.Detector1Pipeline - INFO - Prefetch for RESET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,293 - stpipe.Detector1Pipeline - INFO - Prefetch for RSCD reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,293 - stpipe.Detector1Pipeline - INFO - Prefetch for SATURATION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,293 - stpipe.Detector1Pipeline - INFO - Prefetch for SUPERBIAS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,294 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPDENSITY reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,294 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPPARS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:10,294 - jwst.pipeline.calwebb_detector1 - INFO - Starting calwebb_detector1 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:14,622 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale running with args (&lt;RampModel(60, 250, 224, 288) from jw01386009001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:14,629 - stpipe.Detector1Pipeline.group_scale - INFO - NFRAMES and FRMDIVSR are equal; correction not needed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:14,630 - stpipe.Detector1Pipeline.group_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:14,631 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:14,774 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init running with args (&lt;RampModel(60, 250, 224, 288) from jw01386009001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:14,783 - stpipe.Detector1Pipeline.dq_init - INFO - Using MASK reference file /home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:15,561 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:15,572 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:15,576 - jwst.dq_init.dq_initialization - INFO - Extracting mask subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:16,395 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:16,552 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr running with args (&lt;RampModel(60, 250, 224, 288) from jw01386009001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:17,317 - stpipe.Detector1Pipeline.emicorr - INFO - Using CRDS reference file: /home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:17,335 - jwst.emicorr.emicorr - INFO - Using reference file to get subarray case.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:17,335 - jwst.emicorr.emicorr - INFO - With configuration: Subarray=MASK1550, Read_pattern=FASTR1, Detector=MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:17,336 - jwst.emicorr.emicorr - INFO - Will correct data for the following 2 frequencies: 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:17,336 - jwst.emicorr.emicorr - INFO -    [&#39;Hz390&#39;, &#39;Hz10&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:47:17,337 - jwst.emicorr.emicorr - INFO - Running EMI fit with algorithm = &#39;joint&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:30,062 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:30,224 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation running with args (&lt;RampModel(60, 250, 224, 288) from jw01386009001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:30,234 - stpipe.Detector1Pipeline.saturation - INFO - Using SATURATION reference file /home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:30,234 - stpipe.Detector1Pipeline.saturation - INFO - Using SUPERBIAS reference file N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:30,255 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:30,264 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:31,024 - jwst.saturation.saturation - INFO - Extracting reference file subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:31,031 - jwst.saturation.saturation - INFO - Using read_pattern with nframes 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:38,381 - stcal.saturation.saturation - INFO - Detected 672 saturated pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:38,595 - stcal.saturation.saturation - INFO - Detected 7 A/D floor pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:38,599 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:38,754 - stpipe.Detector1Pipeline.ipc - INFO - Step ipc running with args (&lt;RampModel(60, 250, 224, 288) from jw01386009001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:38,755 - stpipe.Detector1Pipeline.ipc - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:38,887 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe running with args (&lt;RampModel(60, 250, 224, 288) from jw01386009001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:39,653 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:39,812 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe running with args (&lt;RampModel(60, 250, 224, 288) from jw01386009001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:40,578 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:40,735 - stpipe.Detector1Pipeline.reset - INFO - Step reset running with args (&lt;RampModel(60, 250, 224, 288) from jw01386009001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:40,744 - stpipe.Detector1Pipeline.reset - INFO - Using RESET reference file /home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:40,763 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:40,766 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:41,600 - stpipe.Detector1Pipeline.reset - INFO - Step reset done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:41,758 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity running with args (&lt;RampModel(60, 250, 224, 288) from jw01386009001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:41,767 - stpipe.Detector1Pipeline.linearity - INFO - Using Linearity reference file /home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:41,790 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:41,799 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:48,152 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:48,310 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd running with args (&lt;RampModel(60, 250, 224, 288) from jw01386009001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:48,319 - stpipe.Detector1Pipeline.rscd - INFO - Using RSCD reference file /home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:49,104 - jwst.rscd.rscd_sub - INFO - Number of groups to skip for integrations 2 and higher: 4
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:49,109 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:49,265 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current running with args (&lt;RampModel(60, 250, 224, 288) from jw01386009001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:49,274 - stpipe.Detector1Pipeline.dark_current - INFO - Using DARK reference file /home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:50,161 - stdatamodels.dynamicdq - WARNING - Keyword UNDERSAMP does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:50,165 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:50,166 - stpipe.Detector1Pipeline.dark_current - INFO - Using Poisson noise from average dark current 1.0 e-/sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:50,166 - stcal.dark_current.dark_sub - INFO - Science data nints=60, ngroups=250, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:50,167 - stcal.dark_current.dark_sub - INFO - Dark data nints=3, ngroups=500, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:51,733 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:51,898 - stpipe.Detector1Pipeline.refpix - INFO - Step refpix running with args (&lt;RampModel(60, 250, 224, 288) from jw01386009001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:51,898 - stpipe.Detector1Pipeline.refpix - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:52,034 - stpipe.Detector1Pipeline.charge_migration - INFO - Step charge_migration running with args (&lt;RampModel(60, 250, 224, 288) from jw01386009001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:52,034 - stpipe.Detector1Pipeline.charge_migration - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:52,169 - stpipe.Detector1Pipeline.jump - INFO - Step jump running with args (&lt;RampModel(60, 250, 224, 288) from jw01386009001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:52,177 - stpipe.Detector1Pipeline.jump - INFO - CR rejection threshold = 4 sigma
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:52,177 - stpipe.Detector1Pipeline.jump - INFO - Maximum cores to use = half
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:52,935 - stpipe.Detector1Pipeline.jump - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:52,938 - stpipe.Detector1Pipeline.jump - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:52,962 - stpipe.Detector1Pipeline.jump - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:52,967 - stpipe.Detector1Pipeline.jump - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:54,146 - stcal.jump.jump - INFO - Executing two-point difference method
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:48:54,147 - stcal.jump.jump - INFO - Creating 4 processes for jump detection 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:49:22,657 - stcal.jump.jump - INFO - Total elapsed time = 28.5102 sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:49:23,700 - stpipe.Detector1Pipeline.jump - INFO - The execution time in seconds: 31.522977
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:49:23,703 - stpipe.Detector1Pipeline.jump - INFO - Step jump done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:49:23,856 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step clean_flicker_noise running with args (&lt;RampModel(60, 250, 224, 288) from jw01386009001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:49:23,857 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:49:23,984 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit running with args (&lt;RampModel(60, 250, 224, 288) from jw01386009001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:49:24,742 - jwst.ramp_fitting.ramp_fit_step - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:49:24,743 - jwst.ramp_fitting.ramp_fit_step - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:49:24,768 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:49:24,773 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:49:24,778 - jwst.ramp_fitting.ramp_fit_step - INFO - Using algorithm = OLS_C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:49:24,778 - jwst.ramp_fitting.ramp_fit_step - INFO - Using weighting = optimal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:49:27,250 - stcal.ramp_fitting.ols_fit - INFO - Number of multiprocessing slices: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:49:27,265 - stcal.ramp_fitting.ols_fit - INFO - Number of leading groups that are flagged as DO_NOT_USE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:49:27,266 - stcal.ramp_fitting.ols_fit - INFO - MIRI dataset has all pixels in the final group flagged as DO_NOT_USE.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:09,739 - stcal.ramp_fitting.ols_fit - INFO - Ramp Fitting C Time: 102.4720344543457
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:09,801 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:09,953 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;ImageModel(224, 288) from jw01386009001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:09,974 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:09,975 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,108 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;ImageModel(224, 288) from jw01386009001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,122 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,123 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,125 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,258 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;CubeModel(60, 224, 288) from jw01386009001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,279 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,279 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,410 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;CubeModel(60, 224, 288) from jw01386009001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,441 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,442 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,444 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,555 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs009/stage1/jw01386009001_04101_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,556 - jwst.pipeline.calwebb_detector1 - INFO - ... ending calwebb_detector1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,557 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,607 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs009/stage1/jw01386009001_04101_00001_mirimage_rate.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,607 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,608 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
</div>
</div>
</section>
<section id="calibrating-psf-reference-target-files">
<h3>Calibrating PSF Reference Target Files<a class="headerlink" href="#calibrating-psf-reference-target-files" title="Permalink to this heading">#</a></h3>
<p>Look for input PSF Reference Target files. For the demo example there should be 9 files in total, one for each exposure of the PSF reference target taken in the 9-point dither pattern.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now let&#39;s look for input files of the form *uncal.fits from the background</span>
<span class="c1"># observations</span>
<span class="n">sstring</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">uncal_ref_targ_dir</span><span class="p">,</span> <span class="s1">&#39;jw*mirimage*uncal.fits&#39;</span><span class="p">)</span>
<span class="n">uncal_ref_targ_files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">sstring</span><span class="p">))</span>

<span class="c1"># Check that these are the band/channel to use</span>
<span class="n">uncal_ref_targ_files</span> <span class="o">=</span> <span class="n">select_mask_filter_files</span><span class="p">(</span><span class="n">uncal_ref_targ_files</span><span class="p">,</span> <span class="n">use_mask</span><span class="p">,</span> <span class="n">use_filter</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Found &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">uncal_ref_targ_files</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; PSF reference input files&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found 9 PSF reference input files
</pre></div>
</div>
</div>
</div>
<p>Runs calwebb_detector1 module on the reference target files using the same custom parameter dictionary.</p>
<div class="cell tag_scroll-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run the pipeline on these input files by a simple loop over files using</span>
<span class="c1"># our custom parameter dictionary</span>
<span class="k">if</span> <span class="n">dodet1</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">uncal_ref_targ_files</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="n">Detector1Pipeline</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">det1dict</span><span class="p">,</span> <span class="n">save_results</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="n">det1_ref_targ_dir</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Skipping Detector1 processing for PSF reference data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,732 - stpipe - INFO - PARS-EMICORRSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-emicorrstep_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,747 - stpipe - INFO - PARS-DARKCURRENTSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-darkcurrentstep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,756 - stpipe - INFO - PARS-JUMPSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-jumpstep_0004.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,768 - stpipe - INFO - PARS-DETECTOR1PIPELINE parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-detector1pipeline_0008.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,783 - stpipe.Detector1Pipeline - INFO - Detector1Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,784 - stpipe.Detector1Pipeline.group_scale - INFO - GroupScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,785 - stpipe.Detector1Pipeline.dq_init - INFO - DQInitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,786 - stpipe.Detector1Pipeline.emicorr - INFO - EmiCorrStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,787 - stpipe.Detector1Pipeline.saturation - INFO - SaturationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,787 - stpipe.Detector1Pipeline.ipc - INFO - IPCStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,788 - stpipe.Detector1Pipeline.superbias - INFO - SuperBiasStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,789 - stpipe.Detector1Pipeline.refpix - INFO - RefPixStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,790 - stpipe.Detector1Pipeline.rscd - INFO - RscdStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,790 - stpipe.Detector1Pipeline.firstframe - INFO - FirstFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,791 - stpipe.Detector1Pipeline.lastframe - INFO - LastFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,792 - stpipe.Detector1Pipeline.linearity - INFO - LinearityStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,792 - stpipe.Detector1Pipeline.dark_current - INFO - DarkCurrentStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,793 - stpipe.Detector1Pipeline.reset - INFO - ResetStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,794 - stpipe.Detector1Pipeline.persistence - INFO - PersistenceStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,795 - stpipe.Detector1Pipeline.charge_migration - INFO - ChargeMigrationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,796 - stpipe.Detector1Pipeline.jump - INFO - JumpStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,797 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - CleanFlickerNoiseStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,798 - stpipe.Detector1Pipeline.ramp_fit - INFO - RampFitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,799 - stpipe.Detector1Pipeline.gain_scale - INFO - GainScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,800 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - XplyStep instance created.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/uncal/jw01386007001_04101_00001_mirimage_uncal.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,943 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline running with args (np.str_(&#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/uncal/jw01386007001_04101_00001_mirimage_uncal.fits&#39;),).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,964 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./miri_coro_demo_data/Obs007/stage1
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_calibrated_ramp: False
  steps:
    group_scale:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dq_init:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    emicorr:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: joint
      nints_to_phase: None
      nbins: None
      scale_reference: True
      onthefly_corr_freq: None
      use_n_cycles: 3
      fit_ints_separately: False
      user_supplied_reffile: None
      save_intermediate_results: False
    saturation:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      n_pix_grow_sat: 1
      use_readpatt: True
    ipc:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    superbias:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    refpix:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      odd_even_columns: True
      use_side_ref_pixels: True
      side_smoothing_length: 11
      side_gain: 1.0
      odd_even_rows: True
      ovr_corr_mitigation_ftr: 3.0
      preserve_irs2_refpix: False
      irs2_mean_subtraction: False
      refpix_algorithm: median
      sigreject: 4.0
      gaussmooth: 1.0
      halfwidth: 30
    rscd:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    firstframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bright_use_group1: False
    lastframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    linearity:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dark_current:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      dark_output: None
      average_dark_current: 1.0
    reset:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    persistence:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      input_trapsfilled: &#39;&#39;
      flag_pers_cutoff: 40.0
      save_persistence: False
      save_trapsfilled: True
      modify_input: False
    charge_migration:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      signal_threshold: 25000.0
    jump:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      rejection_threshold: 4.0
      three_group_rejection_threshold: 6.0
      four_group_rejection_threshold: 5.0
      maximum_cores: half
      flag_4_neighbors: True
      max_jump_to_flag_neighbors: 1000
      min_jump_to_flag_neighbors: 30
      after_jump_flag_dn1: 500
      after_jump_flag_time1: 15
      after_jump_flag_dn2: 1000
      after_jump_flag_time2: 3000
      expand_large_events: False
      min_sat_area: 1
      min_jump_area: 0
      expand_factor: 0
      use_ellipses: False
      sat_required_snowball: False
      min_sat_radius_extend: 0.0
      sat_expand: 0
      edge_size: 0
      mask_snowball_core_next_int: True
      snowball_time_masked_next_int: 4000
      find_showers: False
      max_shower_amplitude: 4.0
      extend_snr_threshold: 3.0
      extend_min_area: 50
      extend_inner_radius: 1
      extend_outer_radius: 2.6
      extend_ellipse_expand_ratio: 1.1
      time_masked_after_shower: 30
      min_diffs_single_pass: 10
      max_extended_radius: 200
      minimum_groups: 3
      minimum_sigclip_groups: 100
      only_use_ints: True
    clean_flicker_noise:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      fit_method: median
      fit_by_channel: False
      background_method: median
      background_box_size: None
      mask_science_regions: False
      apply_flat_field: False
      n_sigma: 2.0
      fit_histogram: False
      single_mask: True
      user_mask: None
      save_mask: False
      save_background: False
      save_noise: False
    ramp_fit:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: OLS_C
      int_name: &#39;&#39;
      save_opt: False
      opt_name: &#39;&#39;
      suppress_one_group: True
      firstgroup: None
      lastgroup: None
      maximum_cores: &#39;1&#39;
    gain_scale:
      pre_hooks: []
      post_hooks:
      - !!python/name:__main__.XplyStep &#39;&#39;
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,984 - stpipe.Detector1Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01386007001_04101_00001_mirimage_uncal.fits&#39; reftypes = [&#39;dark&#39;, &#39;emicorr&#39;, &#39;gain&#39;, &#39;linearity&#39;, &#39;mask&#39;, &#39;persat&#39;, &#39;readnoise&#39;, &#39;reset&#39;, &#39;rscd&#39;, &#39;saturation&#39;, &#39;superbias&#39;, &#39;trapdensity&#39;, &#39;trappars&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,987 - stpipe.Detector1Pipeline - INFO - Prefetch for DARK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,987 - stpipe.Detector1Pipeline - INFO - Prefetch for EMICORR reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,988 - stpipe.Detector1Pipeline - INFO - Prefetch for GAIN reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,988 - stpipe.Detector1Pipeline - INFO - Prefetch for LINEARITY reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,988 - stpipe.Detector1Pipeline - INFO - Prefetch for MASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,989 - stpipe.Detector1Pipeline - INFO - Prefetch for PERSAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,989 - stpipe.Detector1Pipeline - INFO - Prefetch for READNOISE reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,990 - stpipe.Detector1Pipeline - INFO - Prefetch for RESET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,990 - stpipe.Detector1Pipeline - INFO - Prefetch for RSCD reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,991 - stpipe.Detector1Pipeline - INFO - Prefetch for SATURATION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,991 - stpipe.Detector1Pipeline - INFO - Prefetch for SUPERBIAS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,991 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPDENSITY reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,992 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPPARS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:10,992 - jwst.pipeline.calwebb_detector1 - INFO - Starting calwebb_detector1 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:11,581 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:11,588 - stpipe.Detector1Pipeline.group_scale - INFO - NFRAMES and FRMDIVSR are equal; correction not needed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:11,589 - stpipe.Detector1Pipeline.group_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:11,590 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:11,725 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:11,734 - stpipe.Detector1Pipeline.dq_init - INFO - Using MASK reference file /home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:11,862 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:11,873 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:11,877 - jwst.dq_init.dq_initialization - INFO - Extracting mask subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:11,989 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:12,126 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:12,237 - stpipe.Detector1Pipeline.emicorr - INFO - Using CRDS reference file: /home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:12,254 - jwst.emicorr.emicorr - INFO - Using reference file to get subarray case.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:12,255 - jwst.emicorr.emicorr - INFO - With configuration: Subarray=MASK1550, Read_pattern=FASTR1, Detector=MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:12,255 - jwst.emicorr.emicorr - INFO - Will correct data for the following 2 frequencies: 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:12,256 - jwst.emicorr.emicorr - INFO -    [&#39;Hz390&#39;, &#39;Hz10&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:12,256 - jwst.emicorr.emicorr - INFO - Running EMI fit with algorithm = &#39;joint&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:24,495 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:24,636 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:24,646 - stpipe.Detector1Pipeline.saturation - INFO - Using SATURATION reference file /home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:24,647 - stpipe.Detector1Pipeline.saturation - INFO - Using SUPERBIAS reference file N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:24,668 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:24,677 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:24,785 - jwst.saturation.saturation - INFO - Extracting reference file subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:24,792 - jwst.saturation.saturation - INFO - Using read_pattern with nframes 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:25,729 - stcal.saturation.saturation - INFO - Detected 672 saturated pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:25,757 - stcal.saturation.saturation - INFO - Detected 3 A/D floor pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:25,760 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:25,896 - stpipe.Detector1Pipeline.ipc - INFO - Step ipc running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:25,897 - stpipe.Detector1Pipeline.ipc - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:26,025 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:26,137 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:26,275 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:26,387 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:26,522 - stpipe.Detector1Pipeline.reset - INFO - Step reset running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:26,531 - stpipe.Detector1Pipeline.reset - INFO - Using RESET reference file /home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:26,551 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:26,553 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:26,684 - stpipe.Detector1Pipeline.reset - INFO - Step reset done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:26,823 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:26,833 - stpipe.Detector1Pipeline.linearity - INFO - Using Linearity reference file /home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:26,858 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:26,867 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:27,696 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:27,839 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:27,848 - stpipe.Detector1Pipeline.rscd - INFO - Using RSCD reference file /home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:28,025 - jwst.rscd.rscd_sub - INFO - Number of groups to skip for integrations 2 and higher: 4
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:28,031 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:28,180 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:28,190 - stpipe.Detector1Pipeline.dark_current - INFO - Using DARK reference file /home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:28,444 - stdatamodels.dynamicdq - WARNING - Keyword UNDERSAMP does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:28,448 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:28,449 - stpipe.Detector1Pipeline.dark_current - INFO - Using Poisson noise from average dark current 1.0 e-/sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:28,450 - stcal.dark_current.dark_sub - INFO - Science data nints=19, ngroups=100, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:28,450 - stcal.dark_current.dark_sub - INFO - Dark data nints=3, ngroups=500, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:28,725 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:28,872 - stpipe.Detector1Pipeline.refpix - INFO - Step refpix running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:28,873 - stpipe.Detector1Pipeline.refpix - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:29,006 - stpipe.Detector1Pipeline.charge_migration - INFO - Step charge_migration running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:29,006 - stpipe.Detector1Pipeline.charge_migration - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:29,140 - stpipe.Detector1Pipeline.jump - INFO - Step jump running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:29,147 - stpipe.Detector1Pipeline.jump - INFO - CR rejection threshold = 4 sigma
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:29,148 - stpipe.Detector1Pipeline.jump - INFO - Maximum cores to use = half
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:29,255 - stpipe.Detector1Pipeline.jump - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:29,257 - stpipe.Detector1Pipeline.jump - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:29,282 - stpipe.Detector1Pipeline.jump - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:29,287 - stpipe.Detector1Pipeline.jump - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:29,443 - stcal.jump.jump - INFO - Executing two-point difference method
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:29,444 - stcal.jump.jump - INFO - Creating 4 processes for jump detection 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:33,815 - stcal.jump.jump - INFO - Total elapsed time = 4.37114 sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:33,950 - stpipe.Detector1Pipeline.jump - INFO - The execution time in seconds: 4.802131
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:33,954 - stpipe.Detector1Pipeline.jump - INFO - Step jump done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:34,094 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step clean_flicker_noise running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:34,094 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:34,228 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:34,345 - jwst.ramp_fitting.ramp_fit_step - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:34,346 - jwst.ramp_fitting.ramp_fit_step - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:34,370 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:34,376 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:34,381 - jwst.ramp_fitting.ramp_fit_step - INFO - Using algorithm = OLS_C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:34,382 - jwst.ramp_fitting.ramp_fit_step - INFO - Using weighting = optimal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:34,697 - stcal.ramp_fitting.ols_fit - INFO - Number of multiprocessing slices: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:34,702 - stcal.ramp_fitting.ols_fit - INFO - Number of leading groups that are flagged as DO_NOT_USE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:34,703 - stcal.ramp_fitting.ols_fit - INFO - MIRI dataset has all pixels in the final group flagged as DO_NOT_USE.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:45,222 - stcal.ramp_fitting.ols_fit - INFO - Ramp Fitting C Time: 10.517799854278564
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:45,264 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:45,407 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;ImageModel(224, 288) from jw01386007001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:45,428 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:45,429 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:45,565 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;ImageModel(224, 288) from jw01386007001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:45,579 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:45,581 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:45,582 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:45,713 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:45,735 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:45,736 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:45,870 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:45,891 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:45,892 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:45,894 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:45,962 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:45,962 - jwst.pipeline.calwebb_detector1 - INFO - ... ending calwebb_detector1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:45,963 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,014 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00001_mirimage_rate.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,015 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,015 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,037 - stpipe - INFO - PARS-EMICORRSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-emicorrstep_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,052 - stpipe - INFO - PARS-DARKCURRENTSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-darkcurrentstep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,062 - stpipe - INFO - PARS-JUMPSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-jumpstep_0004.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,073 - stpipe - INFO - PARS-DETECTOR1PIPELINE parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-detector1pipeline_0008.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,089 - stpipe.Detector1Pipeline - INFO - Detector1Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,090 - stpipe.Detector1Pipeline.group_scale - INFO - GroupScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,090 - stpipe.Detector1Pipeline.dq_init - INFO - DQInitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,091 - stpipe.Detector1Pipeline.emicorr - INFO - EmiCorrStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,092 - stpipe.Detector1Pipeline.saturation - INFO - SaturationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,093 - stpipe.Detector1Pipeline.ipc - INFO - IPCStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,093 - stpipe.Detector1Pipeline.superbias - INFO - SuperBiasStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,094 - stpipe.Detector1Pipeline.refpix - INFO - RefPixStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,095 - stpipe.Detector1Pipeline.rscd - INFO - RscdStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,096 - stpipe.Detector1Pipeline.firstframe - INFO - FirstFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,097 - stpipe.Detector1Pipeline.lastframe - INFO - LastFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,097 - stpipe.Detector1Pipeline.linearity - INFO - LinearityStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,098 - stpipe.Detector1Pipeline.dark_current - INFO - DarkCurrentStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,099 - stpipe.Detector1Pipeline.reset - INFO - ResetStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,100 - stpipe.Detector1Pipeline.persistence - INFO - PersistenceStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,101 - stpipe.Detector1Pipeline.charge_migration - INFO - ChargeMigrationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,102 - stpipe.Detector1Pipeline.jump - INFO - JumpStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,103 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - CleanFlickerNoiseStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,104 - stpipe.Detector1Pipeline.ramp_fit - INFO - RampFitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,105 - stpipe.Detector1Pipeline.gain_scale - INFO - GainScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,105 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - XplyStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,244 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline running with args (np.str_(&#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/uncal/jw01386007001_04101_00002_mirimage_uncal.fits&#39;),).
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/uncal/jw01386007001_04101_00002_mirimage_uncal.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,265 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./miri_coro_demo_data/Obs007/stage1
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_calibrated_ramp: False
  steps:
    group_scale:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dq_init:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    emicorr:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: joint
      nints_to_phase: None
      nbins: None
      scale_reference: True
      onthefly_corr_freq: None
      use_n_cycles: 3
      fit_ints_separately: False
      user_supplied_reffile: None
      save_intermediate_results: False
    saturation:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      n_pix_grow_sat: 1
      use_readpatt: True
    ipc:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    superbias:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    refpix:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      odd_even_columns: True
      use_side_ref_pixels: True
      side_smoothing_length: 11
      side_gain: 1.0
      odd_even_rows: True
      ovr_corr_mitigation_ftr: 3.0
      preserve_irs2_refpix: False
      irs2_mean_subtraction: False
      refpix_algorithm: median
      sigreject: 4.0
      gaussmooth: 1.0
      halfwidth: 30
    rscd:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    firstframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bright_use_group1: False
    lastframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    linearity:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dark_current:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      dark_output: None
      average_dark_current: 1.0
    reset:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    persistence:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      input_trapsfilled: &#39;&#39;
      flag_pers_cutoff: 40.0
      save_persistence: False
      save_trapsfilled: True
      modify_input: False
    charge_migration:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      signal_threshold: 25000.0
    jump:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      rejection_threshold: 4.0
      three_group_rejection_threshold: 6.0
      four_group_rejection_threshold: 5.0
      maximum_cores: half
      flag_4_neighbors: True
      max_jump_to_flag_neighbors: 1000
      min_jump_to_flag_neighbors: 30
      after_jump_flag_dn1: 500
      after_jump_flag_time1: 15
      after_jump_flag_dn2: 1000
      after_jump_flag_time2: 3000
      expand_large_events: False
      min_sat_area: 1
      min_jump_area: 0
      expand_factor: 0
      use_ellipses: False
      sat_required_snowball: False
      min_sat_radius_extend: 0.0
      sat_expand: 0
      edge_size: 0
      mask_snowball_core_next_int: True
      snowball_time_masked_next_int: 4000
      find_showers: False
      max_shower_amplitude: 4.0
      extend_snr_threshold: 3.0
      extend_min_area: 50
      extend_inner_radius: 1
      extend_outer_radius: 2.6
      extend_ellipse_expand_ratio: 1.1
      time_masked_after_shower: 30
      min_diffs_single_pass: 10
      max_extended_radius: 200
      minimum_groups: 3
      minimum_sigclip_groups: 100
      only_use_ints: True
    clean_flicker_noise:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      fit_method: median
      fit_by_channel: False
      background_method: median
      background_box_size: None
      mask_science_regions: False
      apply_flat_field: False
      n_sigma: 2.0
      fit_histogram: False
      single_mask: True
      user_mask: None
      save_mask: False
      save_background: False
      save_noise: False
    ramp_fit:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: OLS_C
      int_name: &#39;&#39;
      save_opt: False
      opt_name: &#39;&#39;
      suppress_one_group: True
      firstgroup: None
      lastgroup: None
      maximum_cores: &#39;1&#39;
    gain_scale:
      pre_hooks: []
      post_hooks:
      - !!python/name:__main__.XplyStep &#39;&#39;
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,285 - stpipe.Detector1Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01386007001_04101_00002_mirimage_uncal.fits&#39; reftypes = [&#39;dark&#39;, &#39;emicorr&#39;, &#39;gain&#39;, &#39;linearity&#39;, &#39;mask&#39;, &#39;persat&#39;, &#39;readnoise&#39;, &#39;reset&#39;, &#39;rscd&#39;, &#39;saturation&#39;, &#39;superbias&#39;, &#39;trapdensity&#39;, &#39;trappars&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,288 - stpipe.Detector1Pipeline - INFO - Prefetch for DARK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,289 - stpipe.Detector1Pipeline - INFO - Prefetch for EMICORR reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,289 - stpipe.Detector1Pipeline - INFO - Prefetch for GAIN reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,289 - stpipe.Detector1Pipeline - INFO - Prefetch for LINEARITY reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,290 - stpipe.Detector1Pipeline - INFO - Prefetch for MASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,290 - stpipe.Detector1Pipeline - INFO - Prefetch for PERSAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,290 - stpipe.Detector1Pipeline - INFO - Prefetch for READNOISE reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,291 - stpipe.Detector1Pipeline - INFO - Prefetch for RESET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,291 - stpipe.Detector1Pipeline - INFO - Prefetch for RSCD reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,291 - stpipe.Detector1Pipeline - INFO - Prefetch for SATURATION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,292 - stpipe.Detector1Pipeline - INFO - Prefetch for SUPERBIAS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,292 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPDENSITY reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,292 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPPARS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,293 - jwst.pipeline.calwebb_detector1 - INFO - Starting calwebb_detector1 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,871 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,879 - stpipe.Detector1Pipeline.group_scale - INFO - NFRAMES and FRMDIVSR are equal; correction not needed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,879 - stpipe.Detector1Pipeline.group_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:46,881 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:47,021 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:47,030 - stpipe.Detector1Pipeline.dq_init - INFO - Using MASK reference file /home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:47,158 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:47,169 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:47,173 - jwst.dq_init.dq_initialization - INFO - Extracting mask subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:47,286 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:47,429 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:47,542 - stpipe.Detector1Pipeline.emicorr - INFO - Using CRDS reference file: /home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:47,559 - jwst.emicorr.emicorr - INFO - Using reference file to get subarray case.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:47,560 - jwst.emicorr.emicorr - INFO - With configuration: Subarray=MASK1550, Read_pattern=FASTR1, Detector=MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:47,560 - jwst.emicorr.emicorr - INFO - Will correct data for the following 2 frequencies: 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:47,561 - jwst.emicorr.emicorr - INFO -    [&#39;Hz390&#39;, &#39;Hz10&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:47,561 - jwst.emicorr.emicorr - INFO - Running EMI fit with algorithm = &#39;joint&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:59,798 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:59,940 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:59,950 - stpipe.Detector1Pipeline.saturation - INFO - Using SATURATION reference file /home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:59,951 - stpipe.Detector1Pipeline.saturation - INFO - Using SUPERBIAS reference file N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:59,972 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:51:59,980 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:00,089 - jwst.saturation.saturation - INFO - Extracting reference file subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:00,095 - jwst.saturation.saturation - INFO - Using read_pattern with nframes 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:01,021 - stcal.saturation.saturation - INFO - Detected 663 saturated pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:01,049 - stcal.saturation.saturation - INFO - Detected 0 A/D floor pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:01,053 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:01,198 - stpipe.Detector1Pipeline.ipc - INFO - Step ipc running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:01,198 - stpipe.Detector1Pipeline.ipc - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:01,333 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:01,446 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:01,588 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:01,701 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:01,843 - stpipe.Detector1Pipeline.reset - INFO - Step reset running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:01,852 - stpipe.Detector1Pipeline.reset - INFO - Using RESET reference file /home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:01,871 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:01,874 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:02,008 - stpipe.Detector1Pipeline.reset - INFO - Step reset done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:02,161 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:02,169 - stpipe.Detector1Pipeline.linearity - INFO - Using Linearity reference file /home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:02,192 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:02,201 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:03,038 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:03,184 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:03,193 - stpipe.Detector1Pipeline.rscd - INFO - Using RSCD reference file /home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:03,328 - jwst.rscd.rscd_sub - INFO - Number of groups to skip for integrations 2 and higher: 4
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:03,331 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:03,477 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:03,486 - stpipe.Detector1Pipeline.dark_current - INFO - Using DARK reference file /home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:03,727 - stdatamodels.dynamicdq - WARNING - Keyword UNDERSAMP does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:03,730 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:03,731 - stpipe.Detector1Pipeline.dark_current - INFO - Using Poisson noise from average dark current 1.0 e-/sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:03,732 - stcal.dark_current.dark_sub - INFO - Science data nints=19, ngroups=100, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:03,732 - stcal.dark_current.dark_sub - INFO - Dark data nints=3, ngroups=500, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:04,005 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:04,152 - stpipe.Detector1Pipeline.refpix - INFO - Step refpix running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:04,152 - stpipe.Detector1Pipeline.refpix - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:04,286 - stpipe.Detector1Pipeline.charge_migration - INFO - Step charge_migration running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:04,287 - stpipe.Detector1Pipeline.charge_migration - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:04,421 - stpipe.Detector1Pipeline.jump - INFO - Step jump running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:04,428 - stpipe.Detector1Pipeline.jump - INFO - CR rejection threshold = 4 sigma
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:04,429 - stpipe.Detector1Pipeline.jump - INFO - Maximum cores to use = half
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:04,535 - stpipe.Detector1Pipeline.jump - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:04,538 - stpipe.Detector1Pipeline.jump - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:04,563 - stpipe.Detector1Pipeline.jump - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:04,568 - stpipe.Detector1Pipeline.jump - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:04,723 - stcal.jump.jump - INFO - Executing two-point difference method
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:04,724 - stcal.jump.jump - INFO - Creating 4 processes for jump detection 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:09,083 - stcal.jump.jump - INFO - Total elapsed time = 4.35888 sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:09,218 - stpipe.Detector1Pipeline.jump - INFO - The execution time in seconds: 4.789350
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:09,221 - stpipe.Detector1Pipeline.jump - INFO - Step jump done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:09,364 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step clean_flicker_noise running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:09,365 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:09,498 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:09,614 - jwst.ramp_fitting.ramp_fit_step - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:09,614 - jwst.ramp_fitting.ramp_fit_step - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:09,640 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:09,645 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:09,650 - jwst.ramp_fitting.ramp_fit_step - INFO - Using algorithm = OLS_C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:09,651 - jwst.ramp_fitting.ramp_fit_step - INFO - Using weighting = optimal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:09,960 - stcal.ramp_fitting.ols_fit - INFO - Number of multiprocessing slices: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:09,966 - stcal.ramp_fitting.ols_fit - INFO - Number of leading groups that are flagged as DO_NOT_USE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:09,967 - stcal.ramp_fitting.ols_fit - INFO - MIRI dataset has all pixels in the final group flagged as DO_NOT_USE.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:20,530 - stcal.ramp_fitting.ols_fit - INFO - Ramp Fitting C Time: 10.5622079372406
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:20,572 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:20,707 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;ImageModel(224, 288) from jw01386007001_04101_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:20,729 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:20,729 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:20,866 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;ImageModel(224, 288) from jw01386007001_04101_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:20,881 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:20,882 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:20,884 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,019 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,040 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,041 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,180 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00002_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,199 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,200 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,202 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,269 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00002_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,269 - jwst.pipeline.calwebb_detector1 - INFO - ... ending calwebb_detector1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,270 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,321 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00002_mirimage_rate.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,321 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,322 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,343 - stpipe - INFO - PARS-EMICORRSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-emicorrstep_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,358 - stpipe - INFO - PARS-DARKCURRENTSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-darkcurrentstep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,368 - stpipe - INFO - PARS-JUMPSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-jumpstep_0004.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,379 - stpipe - INFO - PARS-DETECTOR1PIPELINE parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-detector1pipeline_0008.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,394 - stpipe.Detector1Pipeline - INFO - Detector1Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,395 - stpipe.Detector1Pipeline.group_scale - INFO - GroupScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,395 - stpipe.Detector1Pipeline.dq_init - INFO - DQInitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,396 - stpipe.Detector1Pipeline.emicorr - INFO - EmiCorrStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,397 - stpipe.Detector1Pipeline.saturation - INFO - SaturationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,398 - stpipe.Detector1Pipeline.ipc - INFO - IPCStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,398 - stpipe.Detector1Pipeline.superbias - INFO - SuperBiasStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,399 - stpipe.Detector1Pipeline.refpix - INFO - RefPixStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,400 - stpipe.Detector1Pipeline.rscd - INFO - RscdStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,401 - stpipe.Detector1Pipeline.firstframe - INFO - FirstFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,401 - stpipe.Detector1Pipeline.lastframe - INFO - LastFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,402 - stpipe.Detector1Pipeline.linearity - INFO - LinearityStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,403 - stpipe.Detector1Pipeline.dark_current - INFO - DarkCurrentStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,404 - stpipe.Detector1Pipeline.reset - INFO - ResetStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,405 - stpipe.Detector1Pipeline.persistence - INFO - PersistenceStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,405 - stpipe.Detector1Pipeline.charge_migration - INFO - ChargeMigrationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,407 - stpipe.Detector1Pipeline.jump - INFO - JumpStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,408 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - CleanFlickerNoiseStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,409 - stpipe.Detector1Pipeline.ramp_fit - INFO - RampFitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,409 - stpipe.Detector1Pipeline.gain_scale - INFO - GainScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,410 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - XplyStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,548 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline running with args (np.str_(&#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/uncal/jw01386007001_04101_00003_mirimage_uncal.fits&#39;),).
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/uncal/jw01386007001_04101_00003_mirimage_uncal.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,568 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./miri_coro_demo_data/Obs007/stage1
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_calibrated_ramp: False
  steps:
    group_scale:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dq_init:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    emicorr:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: joint
      nints_to_phase: None
      nbins: None
      scale_reference: True
      onthefly_corr_freq: None
      use_n_cycles: 3
      fit_ints_separately: False
      user_supplied_reffile: None
      save_intermediate_results: False
    saturation:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      n_pix_grow_sat: 1
      use_readpatt: True
    ipc:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    superbias:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    refpix:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      odd_even_columns: True
      use_side_ref_pixels: True
      side_smoothing_length: 11
      side_gain: 1.0
      odd_even_rows: True
      ovr_corr_mitigation_ftr: 3.0
      preserve_irs2_refpix: False
      irs2_mean_subtraction: False
      refpix_algorithm: median
      sigreject: 4.0
      gaussmooth: 1.0
      halfwidth: 30
    rscd:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    firstframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bright_use_group1: False
    lastframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    linearity:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dark_current:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      dark_output: None
      average_dark_current: 1.0
    reset:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    persistence:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      input_trapsfilled: &#39;&#39;
      flag_pers_cutoff: 40.0
      save_persistence: False
      save_trapsfilled: True
      modify_input: False
    charge_migration:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      signal_threshold: 25000.0
    jump:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      rejection_threshold: 4.0
      three_group_rejection_threshold: 6.0
      four_group_rejection_threshold: 5.0
      maximum_cores: half
      flag_4_neighbors: True
      max_jump_to_flag_neighbors: 1000
      min_jump_to_flag_neighbors: 30
      after_jump_flag_dn1: 500
      after_jump_flag_time1: 15
      after_jump_flag_dn2: 1000
      after_jump_flag_time2: 3000
      expand_large_events: False
      min_sat_area: 1
      min_jump_area: 0
      expand_factor: 0
      use_ellipses: False
      sat_required_snowball: False
      min_sat_radius_extend: 0.0
      sat_expand: 0
      edge_size: 0
      mask_snowball_core_next_int: True
      snowball_time_masked_next_int: 4000
      find_showers: False
      max_shower_amplitude: 4.0
      extend_snr_threshold: 3.0
      extend_min_area: 50
      extend_inner_radius: 1
      extend_outer_radius: 2.6
      extend_ellipse_expand_ratio: 1.1
      time_masked_after_shower: 30
      min_diffs_single_pass: 10
      max_extended_radius: 200
      minimum_groups: 3
      minimum_sigclip_groups: 100
      only_use_ints: True
    clean_flicker_noise:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      fit_method: median
      fit_by_channel: False
      background_method: median
      background_box_size: None
      mask_science_regions: False
      apply_flat_field: False
      n_sigma: 2.0
      fit_histogram: False
      single_mask: True
      user_mask: None
      save_mask: False
      save_background: False
      save_noise: False
    ramp_fit:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: OLS_C
      int_name: &#39;&#39;
      save_opt: False
      opt_name: &#39;&#39;
      suppress_one_group: True
      firstgroup: None
      lastgroup: None
      maximum_cores: &#39;1&#39;
    gain_scale:
      pre_hooks: []
      post_hooks:
      - !!python/name:__main__.XplyStep &#39;&#39;
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,590 - stpipe.Detector1Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01386007001_04101_00003_mirimage_uncal.fits&#39; reftypes = [&#39;dark&#39;, &#39;emicorr&#39;, &#39;gain&#39;, &#39;linearity&#39;, &#39;mask&#39;, &#39;persat&#39;, &#39;readnoise&#39;, &#39;reset&#39;, &#39;rscd&#39;, &#39;saturation&#39;, &#39;superbias&#39;, &#39;trapdensity&#39;, &#39;trappars&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,592 - stpipe.Detector1Pipeline - INFO - Prefetch for DARK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,593 - stpipe.Detector1Pipeline - INFO - Prefetch for EMICORR reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,594 - stpipe.Detector1Pipeline - INFO - Prefetch for GAIN reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,594 - stpipe.Detector1Pipeline - INFO - Prefetch for LINEARITY reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,595 - stpipe.Detector1Pipeline - INFO - Prefetch for MASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,595 - stpipe.Detector1Pipeline - INFO - Prefetch for PERSAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,596 - stpipe.Detector1Pipeline - INFO - Prefetch for READNOISE reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,596 - stpipe.Detector1Pipeline - INFO - Prefetch for RESET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,597 - stpipe.Detector1Pipeline - INFO - Prefetch for RSCD reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,597 - stpipe.Detector1Pipeline - INFO - Prefetch for SATURATION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,598 - stpipe.Detector1Pipeline - INFO - Prefetch for SUPERBIAS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,598 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPDENSITY reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,599 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPPARS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:21,599 - jwst.pipeline.calwebb_detector1 - INFO - Starting calwebb_detector1 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:22,190 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:22,198 - stpipe.Detector1Pipeline.group_scale - INFO - NFRAMES and FRMDIVSR are equal; correction not needed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:22,198 - stpipe.Detector1Pipeline.group_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:22,200 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:22,338 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:22,347 - stpipe.Detector1Pipeline.dq_init - INFO - Using MASK reference file /home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:22,473 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:22,484 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:22,488 - jwst.dq_init.dq_initialization - INFO - Extracting mask subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:22,601 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:22,742 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:22,855 - stpipe.Detector1Pipeline.emicorr - INFO - Using CRDS reference file: /home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:22,875 - jwst.emicorr.emicorr - INFO - Using reference file to get subarray case.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:22,876 - jwst.emicorr.emicorr - INFO - With configuration: Subarray=MASK1550, Read_pattern=FASTR1, Detector=MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:22,876 - jwst.emicorr.emicorr - INFO - Will correct data for the following 2 frequencies: 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:22,876 - jwst.emicorr.emicorr - INFO -    [&#39;Hz390&#39;, &#39;Hz10&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:22,877 - jwst.emicorr.emicorr - INFO - Running EMI fit with algorithm = &#39;joint&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:35,076 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:35,222 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:35,232 - stpipe.Detector1Pipeline.saturation - INFO - Using SATURATION reference file /home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:35,233 - stpipe.Detector1Pipeline.saturation - INFO - Using SUPERBIAS reference file N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:35,254 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:35,262 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:35,369 - jwst.saturation.saturation - INFO - Extracting reference file subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:35,376 - jwst.saturation.saturation - INFO - Using read_pattern with nframes 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:36,320 - stcal.saturation.saturation - INFO - Detected 660 saturated pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:36,348 - stcal.saturation.saturation - INFO - Detected 0 A/D floor pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:36,352 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:36,493 - stpipe.Detector1Pipeline.ipc - INFO - Step ipc running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:36,494 - stpipe.Detector1Pipeline.ipc - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:36,631 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:36,744 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:36,884 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:36,997 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:37,139 - stpipe.Detector1Pipeline.reset - INFO - Step reset running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:37,148 - stpipe.Detector1Pipeline.reset - INFO - Using RESET reference file /home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:37,168 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:37,170 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:37,304 - stpipe.Detector1Pipeline.reset - INFO - Step reset done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:37,444 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:37,453 - stpipe.Detector1Pipeline.linearity - INFO - Using Linearity reference file /home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:37,476 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:37,485 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:38,322 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:38,463 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:38,472 - stpipe.Detector1Pipeline.rscd - INFO - Using RSCD reference file /home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:38,607 - jwst.rscd.rscd_sub - INFO - Number of groups to skip for integrations 2 and higher: 4
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:38,611 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:38,753 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:38,762 - stpipe.Detector1Pipeline.dark_current - INFO - Using DARK reference file /home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:38,999 - stdatamodels.dynamicdq - WARNING - Keyword UNDERSAMP does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:39,003 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:39,004 - stpipe.Detector1Pipeline.dark_current - INFO - Using Poisson noise from average dark current 1.0 e-/sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:39,005 - stcal.dark_current.dark_sub - INFO - Science data nints=19, ngroups=100, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:39,005 - stcal.dark_current.dark_sub - INFO - Dark data nints=3, ngroups=500, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:39,282 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:39,437 - stpipe.Detector1Pipeline.refpix - INFO - Step refpix running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:39,438 - stpipe.Detector1Pipeline.refpix - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:39,579 - stpipe.Detector1Pipeline.charge_migration - INFO - Step charge_migration running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:39,580 - stpipe.Detector1Pipeline.charge_migration - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:39,716 - stpipe.Detector1Pipeline.jump - INFO - Step jump running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:39,723 - stpipe.Detector1Pipeline.jump - INFO - CR rejection threshold = 4 sigma
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:39,724 - stpipe.Detector1Pipeline.jump - INFO - Maximum cores to use = half
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:39,830 - stpipe.Detector1Pipeline.jump - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:39,832 - stpipe.Detector1Pipeline.jump - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:39,857 - stpipe.Detector1Pipeline.jump - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:39,862 - stpipe.Detector1Pipeline.jump - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:40,019 - stcal.jump.jump - INFO - Executing two-point difference method
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:40,020 - stcal.jump.jump - INFO - Creating 4 processes for jump detection 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:44,348 - stcal.jump.jump - INFO - Total elapsed time = 4.32856 sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:44,484 - stpipe.Detector1Pipeline.jump - INFO - The execution time in seconds: 4.760466
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:44,487 - stpipe.Detector1Pipeline.jump - INFO - Step jump done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:44,631 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step clean_flicker_noise running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:44,632 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:44,768 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:44,884 - jwst.ramp_fitting.ramp_fit_step - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:44,885 - jwst.ramp_fitting.ramp_fit_step - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:44,910 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:44,915 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:44,920 - jwst.ramp_fitting.ramp_fit_step - INFO - Using algorithm = OLS_C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:44,921 - jwst.ramp_fitting.ramp_fit_step - INFO - Using weighting = optimal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:45,233 - stcal.ramp_fitting.ols_fit - INFO - Number of multiprocessing slices: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:45,239 - stcal.ramp_fitting.ols_fit - INFO - Number of leading groups that are flagged as DO_NOT_USE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:45,240 - stcal.ramp_fitting.ols_fit - INFO - MIRI dataset has all pixels in the final group flagged as DO_NOT_USE.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:55,778 - stcal.ramp_fitting.ols_fit - INFO - Ramp Fitting C Time: 10.537917613983154
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:55,821 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:55,963 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;ImageModel(224, 288) from jw01386007001_04101_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:55,984 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:55,985 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,121 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;ImageModel(224, 288) from jw01386007001_04101_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,136 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,137 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,139 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,277 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,299 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,300 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,435 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00003_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,455 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,456 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,458 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,527 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00003_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,528 - jwst.pipeline.calwebb_detector1 - INFO - ... ending calwebb_detector1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,528 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,579 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00003_mirimage_rate.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,580 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,580 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,602 - stpipe - INFO - PARS-EMICORRSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-emicorrstep_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,617 - stpipe - INFO - PARS-DARKCURRENTSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-darkcurrentstep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,627 - stpipe - INFO - PARS-JUMPSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-jumpstep_0004.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,638 - stpipe - INFO - PARS-DETECTOR1PIPELINE parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-detector1pipeline_0008.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,653 - stpipe.Detector1Pipeline - INFO - Detector1Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,654 - stpipe.Detector1Pipeline.group_scale - INFO - GroupScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,655 - stpipe.Detector1Pipeline.dq_init - INFO - DQInitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,656 - stpipe.Detector1Pipeline.emicorr - INFO - EmiCorrStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,657 - stpipe.Detector1Pipeline.saturation - INFO - SaturationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,658 - stpipe.Detector1Pipeline.ipc - INFO - IPCStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,659 - stpipe.Detector1Pipeline.superbias - INFO - SuperBiasStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,660 - stpipe.Detector1Pipeline.refpix - INFO - RefPixStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,661 - stpipe.Detector1Pipeline.rscd - INFO - RscdStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,662 - stpipe.Detector1Pipeline.firstframe - INFO - FirstFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,663 - stpipe.Detector1Pipeline.lastframe - INFO - LastFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,664 - stpipe.Detector1Pipeline.linearity - INFO - LinearityStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,665 - stpipe.Detector1Pipeline.dark_current - INFO - DarkCurrentStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,666 - stpipe.Detector1Pipeline.reset - INFO - ResetStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,667 - stpipe.Detector1Pipeline.persistence - INFO - PersistenceStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,668 - stpipe.Detector1Pipeline.charge_migration - INFO - ChargeMigrationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,670 - stpipe.Detector1Pipeline.jump - INFO - JumpStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,671 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - CleanFlickerNoiseStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,672 - stpipe.Detector1Pipeline.ramp_fit - INFO - RampFitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,673 - stpipe.Detector1Pipeline.gain_scale - INFO - GainScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,674 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - XplyStep instance created.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/uncal/jw01386007001_04101_00004_mirimage_uncal.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,811 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline running with args (np.str_(&#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/uncal/jw01386007001_04101_00004_mirimage_uncal.fits&#39;),).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,831 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./miri_coro_demo_data/Obs007/stage1
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_calibrated_ramp: False
  steps:
    group_scale:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dq_init:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    emicorr:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: joint
      nints_to_phase: None
      nbins: None
      scale_reference: True
      onthefly_corr_freq: None
      use_n_cycles: 3
      fit_ints_separately: False
      user_supplied_reffile: None
      save_intermediate_results: False
    saturation:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      n_pix_grow_sat: 1
      use_readpatt: True
    ipc:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    superbias:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    refpix:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      odd_even_columns: True
      use_side_ref_pixels: True
      side_smoothing_length: 11
      side_gain: 1.0
      odd_even_rows: True
      ovr_corr_mitigation_ftr: 3.0
      preserve_irs2_refpix: False
      irs2_mean_subtraction: False
      refpix_algorithm: median
      sigreject: 4.0
      gaussmooth: 1.0
      halfwidth: 30
    rscd:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    firstframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bright_use_group1: False
    lastframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    linearity:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dark_current:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      dark_output: None
      average_dark_current: 1.0
    reset:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    persistence:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      input_trapsfilled: &#39;&#39;
      flag_pers_cutoff: 40.0
      save_persistence: False
      save_trapsfilled: True
      modify_input: False
    charge_migration:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      signal_threshold: 25000.0
    jump:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      rejection_threshold: 4.0
      three_group_rejection_threshold: 6.0
      four_group_rejection_threshold: 5.0
      maximum_cores: half
      flag_4_neighbors: True
      max_jump_to_flag_neighbors: 1000
      min_jump_to_flag_neighbors: 30
      after_jump_flag_dn1: 500
      after_jump_flag_time1: 15
      after_jump_flag_dn2: 1000
      after_jump_flag_time2: 3000
      expand_large_events: False
      min_sat_area: 1
      min_jump_area: 0
      expand_factor: 0
      use_ellipses: False
      sat_required_snowball: False
      min_sat_radius_extend: 0.0
      sat_expand: 0
      edge_size: 0
      mask_snowball_core_next_int: True
      snowball_time_masked_next_int: 4000
      find_showers: False
      max_shower_amplitude: 4.0
      extend_snr_threshold: 3.0
      extend_min_area: 50
      extend_inner_radius: 1
      extend_outer_radius: 2.6
      extend_ellipse_expand_ratio: 1.1
      time_masked_after_shower: 30
      min_diffs_single_pass: 10
      max_extended_radius: 200
      minimum_groups: 3
      minimum_sigclip_groups: 100
      only_use_ints: True
    clean_flicker_noise:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      fit_method: median
      fit_by_channel: False
      background_method: median
      background_box_size: None
      mask_science_regions: False
      apply_flat_field: False
      n_sigma: 2.0
      fit_histogram: False
      single_mask: True
      user_mask: None
      save_mask: False
      save_background: False
      save_noise: False
    ramp_fit:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: OLS_C
      int_name: &#39;&#39;
      save_opt: False
      opt_name: &#39;&#39;
      suppress_one_group: True
      firstgroup: None
      lastgroup: None
      maximum_cores: &#39;1&#39;
    gain_scale:
      pre_hooks: []
      post_hooks:
      - !!python/name:__main__.XplyStep &#39;&#39;
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,851 - stpipe.Detector1Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01386007001_04101_00004_mirimage_uncal.fits&#39; reftypes = [&#39;dark&#39;, &#39;emicorr&#39;, &#39;gain&#39;, &#39;linearity&#39;, &#39;mask&#39;, &#39;persat&#39;, &#39;readnoise&#39;, &#39;reset&#39;, &#39;rscd&#39;, &#39;saturation&#39;, &#39;superbias&#39;, &#39;trapdensity&#39;, &#39;trappars&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,854 - stpipe.Detector1Pipeline - INFO - Prefetch for DARK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,855 - stpipe.Detector1Pipeline - INFO - Prefetch for EMICORR reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,855 - stpipe.Detector1Pipeline - INFO - Prefetch for GAIN reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,856 - stpipe.Detector1Pipeline - INFO - Prefetch for LINEARITY reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,856 - stpipe.Detector1Pipeline - INFO - Prefetch for MASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,857 - stpipe.Detector1Pipeline - INFO - Prefetch for PERSAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,857 - stpipe.Detector1Pipeline - INFO - Prefetch for READNOISE reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,858 - stpipe.Detector1Pipeline - INFO - Prefetch for RESET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,858 - stpipe.Detector1Pipeline - INFO - Prefetch for RSCD reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,859 - stpipe.Detector1Pipeline - INFO - Prefetch for SATURATION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,859 - stpipe.Detector1Pipeline - INFO - Prefetch for SUPERBIAS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,860 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPDENSITY reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,860 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPPARS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:56,861 - jwst.pipeline.calwebb_detector1 - INFO - Starting calwebb_detector1 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:57,493 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:57,500 - stpipe.Detector1Pipeline.group_scale - INFO - NFRAMES and FRMDIVSR are equal; correction not needed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:57,501 - stpipe.Detector1Pipeline.group_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:57,502 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:57,641 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:57,650 - stpipe.Detector1Pipeline.dq_init - INFO - Using MASK reference file /home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:57,778 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:57,789 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:57,792 - jwst.dq_init.dq_initialization - INFO - Extracting mask subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:57,905 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:58,056 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:58,169 - stpipe.Detector1Pipeline.emicorr - INFO - Using CRDS reference file: /home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:58,185 - jwst.emicorr.emicorr - INFO - Using reference file to get subarray case.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:58,186 - jwst.emicorr.emicorr - INFO - With configuration: Subarray=MASK1550, Read_pattern=FASTR1, Detector=MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:58,186 - jwst.emicorr.emicorr - INFO - Will correct data for the following 2 frequencies: 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:58,187 - jwst.emicorr.emicorr - INFO -    [&#39;Hz390&#39;, &#39;Hz10&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:52:58,187 - jwst.emicorr.emicorr - INFO - Running EMI fit with algorithm = &#39;joint&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:10,374 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:10,518 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:10,529 - stpipe.Detector1Pipeline.saturation - INFO - Using SATURATION reference file /home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:10,529 - stpipe.Detector1Pipeline.saturation - INFO - Using SUPERBIAS reference file N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:10,550 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:10,559 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:10,666 - jwst.saturation.saturation - INFO - Extracting reference file subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:10,673 - jwst.saturation.saturation - INFO - Using read_pattern with nframes 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:11,607 - stcal.saturation.saturation - INFO - Detected 660 saturated pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:11,634 - stcal.saturation.saturation - INFO - Detected 0 A/D floor pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:11,638 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:11,781 - stpipe.Detector1Pipeline.ipc - INFO - Step ipc running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:11,782 - stpipe.Detector1Pipeline.ipc - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:11,920 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:12,034 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:12,177 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:12,289 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:12,432 - stpipe.Detector1Pipeline.reset - INFO - Step reset running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:12,442 - stpipe.Detector1Pipeline.reset - INFO - Using RESET reference file /home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:12,461 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:12,464 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:12,597 - stpipe.Detector1Pipeline.reset - INFO - Step reset done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:12,741 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:12,750 - stpipe.Detector1Pipeline.linearity - INFO - Using Linearity reference file /home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:12,773 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:12,783 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:13,613 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:13,771 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:13,780 - stpipe.Detector1Pipeline.rscd - INFO - Using RSCD reference file /home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:13,915 - jwst.rscd.rscd_sub - INFO - Number of groups to skip for integrations 2 and higher: 4
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:13,919 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:14,060 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:14,069 - stpipe.Detector1Pipeline.dark_current - INFO - Using DARK reference file /home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:14,307 - stdatamodels.dynamicdq - WARNING - Keyword UNDERSAMP does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:14,310 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:14,312 - stpipe.Detector1Pipeline.dark_current - INFO - Using Poisson noise from average dark current 1.0 e-/sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:14,312 - stcal.dark_current.dark_sub - INFO - Science data nints=19, ngroups=100, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:14,313 - stcal.dark_current.dark_sub - INFO - Dark data nints=3, ngroups=500, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:14,585 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:14,737 - stpipe.Detector1Pipeline.refpix - INFO - Step refpix running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:14,738 - stpipe.Detector1Pipeline.refpix - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:14,877 - stpipe.Detector1Pipeline.charge_migration - INFO - Step charge_migration running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:14,878 - stpipe.Detector1Pipeline.charge_migration - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:15,015 - stpipe.Detector1Pipeline.jump - INFO - Step jump running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:15,023 - stpipe.Detector1Pipeline.jump - INFO - CR rejection threshold = 4 sigma
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:15,023 - stpipe.Detector1Pipeline.jump - INFO - Maximum cores to use = half
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:15,130 - stpipe.Detector1Pipeline.jump - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:15,132 - stpipe.Detector1Pipeline.jump - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:15,157 - stpipe.Detector1Pipeline.jump - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:15,162 - stpipe.Detector1Pipeline.jump - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:15,318 - stcal.jump.jump - INFO - Executing two-point difference method
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:15,319 - stcal.jump.jump - INFO - Creating 4 processes for jump detection 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:19,721 - stcal.jump.jump - INFO - Total elapsed time = 4.40192 sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:19,856 - stpipe.Detector1Pipeline.jump - INFO - The execution time in seconds: 4.833239
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:19,860 - stpipe.Detector1Pipeline.jump - INFO - Step jump done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:20,001 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step clean_flicker_noise running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:20,001 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:20,137 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:20,249 - jwst.ramp_fitting.ramp_fit_step - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:20,250 - jwst.ramp_fitting.ramp_fit_step - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:20,274 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:20,279 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:20,284 - jwst.ramp_fitting.ramp_fit_step - INFO - Using algorithm = OLS_C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:20,285 - jwst.ramp_fitting.ramp_fit_step - INFO - Using weighting = optimal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:20,594 - stcal.ramp_fitting.ols_fit - INFO - Number of multiprocessing slices: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:20,600 - stcal.ramp_fitting.ols_fit - INFO - Number of leading groups that are flagged as DO_NOT_USE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:20,600 - stcal.ramp_fitting.ols_fit - INFO - MIRI dataset has all pixels in the final group flagged as DO_NOT_USE.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,104 - stcal.ramp_fitting.ols_fit - INFO - Ramp Fitting C Time: 10.502328157424927
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,146 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,286 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;ImageModel(224, 288) from jw01386007001_04101_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,307 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,307 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,443 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;ImageModel(224, 288) from jw01386007001_04101_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,457 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,458 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,460 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,594 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,615 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,616 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,750 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00004_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,770 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,771 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,773 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,841 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00004_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,842 - jwst.pipeline.calwebb_detector1 - INFO - ... ending calwebb_detector1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,843 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,893 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00004_mirimage_rate.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,894 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,894 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,916 - stpipe - INFO - PARS-EMICORRSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-emicorrstep_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,931 - stpipe - INFO - PARS-DARKCURRENTSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-darkcurrentstep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,941 - stpipe - INFO - PARS-JUMPSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-jumpstep_0004.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,952 - stpipe - INFO - PARS-DETECTOR1PIPELINE parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-detector1pipeline_0008.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,967 - stpipe.Detector1Pipeline - INFO - Detector1Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,968 - stpipe.Detector1Pipeline.group_scale - INFO - GroupScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,969 - stpipe.Detector1Pipeline.dq_init - INFO - DQInitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,970 - stpipe.Detector1Pipeline.emicorr - INFO - EmiCorrStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,971 - stpipe.Detector1Pipeline.saturation - INFO - SaturationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,971 - stpipe.Detector1Pipeline.ipc - INFO - IPCStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,972 - stpipe.Detector1Pipeline.superbias - INFO - SuperBiasStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,973 - stpipe.Detector1Pipeline.refpix - INFO - RefPixStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,974 - stpipe.Detector1Pipeline.rscd - INFO - RscdStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,974 - stpipe.Detector1Pipeline.firstframe - INFO - FirstFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,975 - stpipe.Detector1Pipeline.lastframe - INFO - LastFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,976 - stpipe.Detector1Pipeline.linearity - INFO - LinearityStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,976 - stpipe.Detector1Pipeline.dark_current - INFO - DarkCurrentStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,977 - stpipe.Detector1Pipeline.reset - INFO - ResetStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,978 - stpipe.Detector1Pipeline.persistence - INFO - PersistenceStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,979 - stpipe.Detector1Pipeline.charge_migration - INFO - ChargeMigrationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,980 - stpipe.Detector1Pipeline.jump - INFO - JumpStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,981 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - CleanFlickerNoiseStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,982 - stpipe.Detector1Pipeline.ramp_fit - INFO - RampFitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,983 - stpipe.Detector1Pipeline.gain_scale - INFO - GainScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:31,983 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - XplyStep instance created.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/uncal/jw01386007001_04101_00005_mirimage_uncal.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:32,120 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline running with args (np.str_(&#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/uncal/jw01386007001_04101_00005_mirimage_uncal.fits&#39;),).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:32,140 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./miri_coro_demo_data/Obs007/stage1
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_calibrated_ramp: False
  steps:
    group_scale:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dq_init:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    emicorr:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: joint
      nints_to_phase: None
      nbins: None
      scale_reference: True
      onthefly_corr_freq: None
      use_n_cycles: 3
      fit_ints_separately: False
      user_supplied_reffile: None
      save_intermediate_results: False
    saturation:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      n_pix_grow_sat: 1
      use_readpatt: True
    ipc:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    superbias:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    refpix:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      odd_even_columns: True
      use_side_ref_pixels: True
      side_smoothing_length: 11
      side_gain: 1.0
      odd_even_rows: True
      ovr_corr_mitigation_ftr: 3.0
      preserve_irs2_refpix: False
      irs2_mean_subtraction: False
      refpix_algorithm: median
      sigreject: 4.0
      gaussmooth: 1.0
      halfwidth: 30
    rscd:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    firstframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bright_use_group1: False
    lastframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    linearity:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dark_current:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      dark_output: None
      average_dark_current: 1.0
    reset:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    persistence:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      input_trapsfilled: &#39;&#39;
      flag_pers_cutoff: 40.0
      save_persistence: False
      save_trapsfilled: True
      modify_input: False
    charge_migration:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      signal_threshold: 25000.0
    jump:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      rejection_threshold: 4.0
      three_group_rejection_threshold: 6.0
      four_group_rejection_threshold: 5.0
      maximum_cores: half
      flag_4_neighbors: True
      max_jump_to_flag_neighbors: 1000
      min_jump_to_flag_neighbors: 30
      after_jump_flag_dn1: 500
      after_jump_flag_time1: 15
      after_jump_flag_dn2: 1000
      after_jump_flag_time2: 3000
      expand_large_events: False
      min_sat_area: 1
      min_jump_area: 0
      expand_factor: 0
      use_ellipses: False
      sat_required_snowball: False
      min_sat_radius_extend: 0.0
      sat_expand: 0
      edge_size: 0
      mask_snowball_core_next_int: True
      snowball_time_masked_next_int: 4000
      find_showers: False
      max_shower_amplitude: 4.0
      extend_snr_threshold: 3.0
      extend_min_area: 50
      extend_inner_radius: 1
      extend_outer_radius: 2.6
      extend_ellipse_expand_ratio: 1.1
      time_masked_after_shower: 30
      min_diffs_single_pass: 10
      max_extended_radius: 200
      minimum_groups: 3
      minimum_sigclip_groups: 100
      only_use_ints: True
    clean_flicker_noise:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      fit_method: median
      fit_by_channel: False
      background_method: median
      background_box_size: None
      mask_science_regions: False
      apply_flat_field: False
      n_sigma: 2.0
      fit_histogram: False
      single_mask: True
      user_mask: None
      save_mask: False
      save_background: False
      save_noise: False
    ramp_fit:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: OLS_C
      int_name: &#39;&#39;
      save_opt: False
      opt_name: &#39;&#39;
      suppress_one_group: True
      firstgroup: None
      lastgroup: None
      maximum_cores: &#39;1&#39;
    gain_scale:
      pre_hooks: []
      post_hooks:
      - !!python/name:__main__.XplyStep &#39;&#39;
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:32,161 - stpipe.Detector1Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01386007001_04101_00005_mirimage_uncal.fits&#39; reftypes = [&#39;dark&#39;, &#39;emicorr&#39;, &#39;gain&#39;, &#39;linearity&#39;, &#39;mask&#39;, &#39;persat&#39;, &#39;readnoise&#39;, &#39;reset&#39;, &#39;rscd&#39;, &#39;saturation&#39;, &#39;superbias&#39;, &#39;trapdensity&#39;, &#39;trappars&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:32,163 - stpipe.Detector1Pipeline - INFO - Prefetch for DARK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:32,164 - stpipe.Detector1Pipeline - INFO - Prefetch for EMICORR reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:32,164 - stpipe.Detector1Pipeline - INFO - Prefetch for GAIN reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:32,164 - stpipe.Detector1Pipeline - INFO - Prefetch for LINEARITY reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:32,164 - stpipe.Detector1Pipeline - INFO - Prefetch for MASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:32,165 - stpipe.Detector1Pipeline - INFO - Prefetch for PERSAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:32,165 - stpipe.Detector1Pipeline - INFO - Prefetch for READNOISE reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:32,165 - stpipe.Detector1Pipeline - INFO - Prefetch for RESET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:32,166 - stpipe.Detector1Pipeline - INFO - Prefetch for RSCD reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:32,167 - stpipe.Detector1Pipeline - INFO - Prefetch for SATURATION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:32,167 - stpipe.Detector1Pipeline - INFO - Prefetch for SUPERBIAS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:32,167 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPDENSITY reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:32,168 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPPARS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:32,168 - jwst.pipeline.calwebb_detector1 - INFO - Starting calwebb_detector1 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:32,786 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:32,794 - stpipe.Detector1Pipeline.group_scale - INFO - NFRAMES and FRMDIVSR are equal; correction not needed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:32,794 - stpipe.Detector1Pipeline.group_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:32,796 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:32,936 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:32,945 - stpipe.Detector1Pipeline.dq_init - INFO - Using MASK reference file /home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:33,072 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:33,083 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:33,087 - jwst.dq_init.dq_initialization - INFO - Extracting mask subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:33,200 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:33,344 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:33,458 - stpipe.Detector1Pipeline.emicorr - INFO - Using CRDS reference file: /home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:33,475 - jwst.emicorr.emicorr - INFO - Using reference file to get subarray case.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:33,475 - jwst.emicorr.emicorr - INFO - With configuration: Subarray=MASK1550, Read_pattern=FASTR1, Detector=MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:33,476 - jwst.emicorr.emicorr - INFO - Will correct data for the following 2 frequencies: 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:33,476 - jwst.emicorr.emicorr - INFO -    [&#39;Hz390&#39;, &#39;Hz10&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:33,477 - jwst.emicorr.emicorr - INFO - Running EMI fit with algorithm = &#39;joint&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:45,683 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:45,825 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:45,835 - stpipe.Detector1Pipeline.saturation - INFO - Using SATURATION reference file /home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:45,836 - stpipe.Detector1Pipeline.saturation - INFO - Using SUPERBIAS reference file N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:45,857 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:45,866 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:45,973 - jwst.saturation.saturation - INFO - Extracting reference file subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:45,979 - jwst.saturation.saturation - INFO - Using read_pattern with nframes 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:46,902 - stcal.saturation.saturation - INFO - Detected 657 saturated pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:46,931 - stcal.saturation.saturation - INFO - Detected 0 A/D floor pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:46,934 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:47,089 - stpipe.Detector1Pipeline.ipc - INFO - Step ipc running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:47,090 - stpipe.Detector1Pipeline.ipc - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:47,235 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:47,348 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:47,490 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:47,603 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:47,747 - stpipe.Detector1Pipeline.reset - INFO - Step reset running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:47,756 - stpipe.Detector1Pipeline.reset - INFO - Using RESET reference file /home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:47,776 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:47,778 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:47,913 - stpipe.Detector1Pipeline.reset - INFO - Step reset done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:48,061 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:48,070 - stpipe.Detector1Pipeline.linearity - INFO - Using Linearity reference file /home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:48,093 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:48,102 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:48,934 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:49,082 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:49,091 - stpipe.Detector1Pipeline.rscd - INFO - Using RSCD reference file /home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:49,226 - jwst.rscd.rscd_sub - INFO - Number of groups to skip for integrations 2 and higher: 4
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:49,230 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:49,376 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:49,385 - stpipe.Detector1Pipeline.dark_current - INFO - Using DARK reference file /home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:49,622 - stdatamodels.dynamicdq - WARNING - Keyword UNDERSAMP does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:49,625 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:49,627 - stpipe.Detector1Pipeline.dark_current - INFO - Using Poisson noise from average dark current 1.0 e-/sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:49,627 - stcal.dark_current.dark_sub - INFO - Science data nints=19, ngroups=100, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:49,628 - stcal.dark_current.dark_sub - INFO - Dark data nints=3, ngroups=500, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:49,901 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:50,049 - stpipe.Detector1Pipeline.refpix - INFO - Step refpix running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:50,050 - stpipe.Detector1Pipeline.refpix - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:50,192 - stpipe.Detector1Pipeline.charge_migration - INFO - Step charge_migration running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:50,193 - stpipe.Detector1Pipeline.charge_migration - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:50,331 - stpipe.Detector1Pipeline.jump - INFO - Step jump running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:50,338 - stpipe.Detector1Pipeline.jump - INFO - CR rejection threshold = 4 sigma
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:50,339 - stpipe.Detector1Pipeline.jump - INFO - Maximum cores to use = half
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:50,445 - stpipe.Detector1Pipeline.jump - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:50,448 - stpipe.Detector1Pipeline.jump - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:50,472 - stpipe.Detector1Pipeline.jump - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:50,477 - stpipe.Detector1Pipeline.jump - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:50,634 - stcal.jump.jump - INFO - Executing two-point difference method
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:50,635 - stcal.jump.jump - INFO - Creating 4 processes for jump detection 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:54,975 - stcal.jump.jump - INFO - Total elapsed time = 4.33999 sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:55,109 - stpipe.Detector1Pipeline.jump - INFO - The execution time in seconds: 4.770531
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:55,112 - stpipe.Detector1Pipeline.jump - INFO - Step jump done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:55,257 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step clean_flicker_noise running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:55,257 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:55,391 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:55,505 - jwst.ramp_fitting.ramp_fit_step - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:55,505 - jwst.ramp_fitting.ramp_fit_step - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:55,530 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:55,535 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:55,540 - jwst.ramp_fitting.ramp_fit_step - INFO - Using algorithm = OLS_C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:55,541 - jwst.ramp_fitting.ramp_fit_step - INFO - Using weighting = optimal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:55,848 - stcal.ramp_fitting.ols_fit - INFO - Number of multiprocessing slices: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:55,854 - stcal.ramp_fitting.ols_fit - INFO - Number of leading groups that are flagged as DO_NOT_USE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:53:55,854 - stcal.ramp_fitting.ols_fit - INFO - MIRI dataset has all pixels in the final group flagged as DO_NOT_USE.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:06,396 - stcal.ramp_fitting.ols_fit - INFO - Ramp Fitting C Time: 10.54128098487854
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:06,439 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:06,577 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;ImageModel(224, 288) from jw01386007001_04101_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:06,598 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:06,598 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:06,733 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;ImageModel(224, 288) from jw01386007001_04101_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:06,747 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:06,749 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:06,750 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:06,884 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:06,906 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:06,906 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,042 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00005_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,061 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,063 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,064 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,132 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00005_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,133 - jwst.pipeline.calwebb_detector1 - INFO - ... ending calwebb_detector1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,134 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,184 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00005_mirimage_rate.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,185 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,185 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,207 - stpipe - INFO - PARS-EMICORRSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-emicorrstep_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,222 - stpipe - INFO - PARS-DARKCURRENTSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-darkcurrentstep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,232 - stpipe - INFO - PARS-JUMPSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-jumpstep_0004.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,242 - stpipe - INFO - PARS-DETECTOR1PIPELINE parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-detector1pipeline_0008.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,258 - stpipe.Detector1Pipeline - INFO - Detector1Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,259 - stpipe.Detector1Pipeline.group_scale - INFO - GroupScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,260 - stpipe.Detector1Pipeline.dq_init - INFO - DQInitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,261 - stpipe.Detector1Pipeline.emicorr - INFO - EmiCorrStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,261 - stpipe.Detector1Pipeline.saturation - INFO - SaturationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,262 - stpipe.Detector1Pipeline.ipc - INFO - IPCStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,263 - stpipe.Detector1Pipeline.superbias - INFO - SuperBiasStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,264 - stpipe.Detector1Pipeline.refpix - INFO - RefPixStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,264 - stpipe.Detector1Pipeline.rscd - INFO - RscdStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,265 - stpipe.Detector1Pipeline.firstframe - INFO - FirstFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,266 - stpipe.Detector1Pipeline.lastframe - INFO - LastFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,266 - stpipe.Detector1Pipeline.linearity - INFO - LinearityStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,267 - stpipe.Detector1Pipeline.dark_current - INFO - DarkCurrentStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,268 - stpipe.Detector1Pipeline.reset - INFO - ResetStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,269 - stpipe.Detector1Pipeline.persistence - INFO - PersistenceStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,270 - stpipe.Detector1Pipeline.charge_migration - INFO - ChargeMigrationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,271 - stpipe.Detector1Pipeline.jump - INFO - JumpStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,272 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - CleanFlickerNoiseStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,273 - stpipe.Detector1Pipeline.ramp_fit - INFO - RampFitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,273 - stpipe.Detector1Pipeline.gain_scale - INFO - GainScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,274 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - XplyStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,411 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline running with args (np.str_(&#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/uncal/jw01386007001_04101_00006_mirimage_uncal.fits&#39;),).
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/uncal/jw01386007001_04101_00006_mirimage_uncal.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,431 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./miri_coro_demo_data/Obs007/stage1
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_calibrated_ramp: False
  steps:
    group_scale:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dq_init:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    emicorr:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: joint
      nints_to_phase: None
      nbins: None
      scale_reference: True
      onthefly_corr_freq: None
      use_n_cycles: 3
      fit_ints_separately: False
      user_supplied_reffile: None
      save_intermediate_results: False
    saturation:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      n_pix_grow_sat: 1
      use_readpatt: True
    ipc:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    superbias:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    refpix:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      odd_even_columns: True
      use_side_ref_pixels: True
      side_smoothing_length: 11
      side_gain: 1.0
      odd_even_rows: True
      ovr_corr_mitigation_ftr: 3.0
      preserve_irs2_refpix: False
      irs2_mean_subtraction: False
      refpix_algorithm: median
      sigreject: 4.0
      gaussmooth: 1.0
      halfwidth: 30
    rscd:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    firstframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bright_use_group1: False
    lastframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    linearity:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dark_current:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      dark_output: None
      average_dark_current: 1.0
    reset:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    persistence:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      input_trapsfilled: &#39;&#39;
      flag_pers_cutoff: 40.0
      save_persistence: False
      save_trapsfilled: True
      modify_input: False
    charge_migration:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      signal_threshold: 25000.0
    jump:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      rejection_threshold: 4.0
      three_group_rejection_threshold: 6.0
      four_group_rejection_threshold: 5.0
      maximum_cores: half
      flag_4_neighbors: True
      max_jump_to_flag_neighbors: 1000
      min_jump_to_flag_neighbors: 30
      after_jump_flag_dn1: 500
      after_jump_flag_time1: 15
      after_jump_flag_dn2: 1000
      after_jump_flag_time2: 3000
      expand_large_events: False
      min_sat_area: 1
      min_jump_area: 0
      expand_factor: 0
      use_ellipses: False
      sat_required_snowball: False
      min_sat_radius_extend: 0.0
      sat_expand: 0
      edge_size: 0
      mask_snowball_core_next_int: True
      snowball_time_masked_next_int: 4000
      find_showers: False
      max_shower_amplitude: 4.0
      extend_snr_threshold: 3.0
      extend_min_area: 50
      extend_inner_radius: 1
      extend_outer_radius: 2.6
      extend_ellipse_expand_ratio: 1.1
      time_masked_after_shower: 30
      min_diffs_single_pass: 10
      max_extended_radius: 200
      minimum_groups: 3
      minimum_sigclip_groups: 100
      only_use_ints: True
    clean_flicker_noise:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      fit_method: median
      fit_by_channel: False
      background_method: median
      background_box_size: None
      mask_science_regions: False
      apply_flat_field: False
      n_sigma: 2.0
      fit_histogram: False
      single_mask: True
      user_mask: None
      save_mask: False
      save_background: False
      save_noise: False
    ramp_fit:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: OLS_C
      int_name: &#39;&#39;
      save_opt: False
      opt_name: &#39;&#39;
      suppress_one_group: True
      firstgroup: None
      lastgroup: None
      maximum_cores: &#39;1&#39;
    gain_scale:
      pre_hooks: []
      post_hooks:
      - !!python/name:__main__.XplyStep &#39;&#39;
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,453 - stpipe.Detector1Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01386007001_04101_00006_mirimage_uncal.fits&#39; reftypes = [&#39;dark&#39;, &#39;emicorr&#39;, &#39;gain&#39;, &#39;linearity&#39;, &#39;mask&#39;, &#39;persat&#39;, &#39;readnoise&#39;, &#39;reset&#39;, &#39;rscd&#39;, &#39;saturation&#39;, &#39;superbias&#39;, &#39;trapdensity&#39;, &#39;trappars&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,455 - stpipe.Detector1Pipeline - INFO - Prefetch for DARK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,456 - stpipe.Detector1Pipeline - INFO - Prefetch for EMICORR reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,456 - stpipe.Detector1Pipeline - INFO - Prefetch for GAIN reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,457 - stpipe.Detector1Pipeline - INFO - Prefetch for LINEARITY reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,457 - stpipe.Detector1Pipeline - INFO - Prefetch for MASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,457 - stpipe.Detector1Pipeline - INFO - Prefetch for PERSAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,457 - stpipe.Detector1Pipeline - INFO - Prefetch for READNOISE reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,458 - stpipe.Detector1Pipeline - INFO - Prefetch for RESET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,458 - stpipe.Detector1Pipeline - INFO - Prefetch for RSCD reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,458 - stpipe.Detector1Pipeline - INFO - Prefetch for SATURATION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,459 - stpipe.Detector1Pipeline - INFO - Prefetch for SUPERBIAS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,459 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPDENSITY reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,459 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPPARS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:07,459 - jwst.pipeline.calwebb_detector1 - INFO - Starting calwebb_detector1 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:08,035 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00006_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:08,042 - stpipe.Detector1Pipeline.group_scale - INFO - NFRAMES and FRMDIVSR are equal; correction not needed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:08,043 - stpipe.Detector1Pipeline.group_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:08,044 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:08,185 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00006_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:08,194 - stpipe.Detector1Pipeline.dq_init - INFO - Using MASK reference file /home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:08,318 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:08,329 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:08,333 - jwst.dq_init.dq_initialization - INFO - Extracting mask subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:08,444 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:08,585 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00006_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:08,695 - stpipe.Detector1Pipeline.emicorr - INFO - Using CRDS reference file: /home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:08,712 - jwst.emicorr.emicorr - INFO - Using reference file to get subarray case.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:08,713 - jwst.emicorr.emicorr - INFO - With configuration: Subarray=MASK1550, Read_pattern=FASTR1, Detector=MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:08,713 - jwst.emicorr.emicorr - INFO - Will correct data for the following 2 frequencies: 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:08,713 - jwst.emicorr.emicorr - INFO -    [&#39;Hz390&#39;, &#39;Hz10&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:08,714 - jwst.emicorr.emicorr - INFO - Running EMI fit with algorithm = &#39;joint&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:20,757 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:20,898 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00006_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:20,908 - stpipe.Detector1Pipeline.saturation - INFO - Using SATURATION reference file /home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:20,909 - stpipe.Detector1Pipeline.saturation - INFO - Using SUPERBIAS reference file N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:20,930 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:20,938 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:21,043 - jwst.saturation.saturation - INFO - Extracting reference file subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:21,050 - jwst.saturation.saturation - INFO - Using read_pattern with nframes 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:21,977 - stcal.saturation.saturation - INFO - Detected 645 saturated pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:22,005 - stcal.saturation.saturation - INFO - Detected 0 A/D floor pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:22,008 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:22,155 - stpipe.Detector1Pipeline.ipc - INFO - Step ipc running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00006_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:22,155 - stpipe.Detector1Pipeline.ipc - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:22,288 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00006_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:22,399 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:22,538 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00006_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:22,647 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:22,788 - stpipe.Detector1Pipeline.reset - INFO - Step reset running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00006_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:22,797 - stpipe.Detector1Pipeline.reset - INFO - Using RESET reference file /home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:22,817 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:22,819 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:22,949 - stpipe.Detector1Pipeline.reset - INFO - Step reset done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:23,087 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00006_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:23,096 - stpipe.Detector1Pipeline.linearity - INFO - Using Linearity reference file /home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:23,120 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:23,130 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:23,937 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:24,077 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00006_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:24,086 - stpipe.Detector1Pipeline.rscd - INFO - Using RSCD reference file /home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:24,219 - jwst.rscd.rscd_sub - INFO - Number of groups to skip for integrations 2 and higher: 4
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:24,223 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:24,365 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00006_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:24,375 - stpipe.Detector1Pipeline.dark_current - INFO - Using DARK reference file /home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:24,605 - stdatamodels.dynamicdq - WARNING - Keyword UNDERSAMP does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:24,609 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:24,610 - stpipe.Detector1Pipeline.dark_current - INFO - Using Poisson noise from average dark current 1.0 e-/sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:24,611 - stcal.dark_current.dark_sub - INFO - Science data nints=19, ngroups=100, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:24,611 - stcal.dark_current.dark_sub - INFO - Dark data nints=3, ngroups=500, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:24,880 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:25,025 - stpipe.Detector1Pipeline.refpix - INFO - Step refpix running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00006_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:25,026 - stpipe.Detector1Pipeline.refpix - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:25,160 - stpipe.Detector1Pipeline.charge_migration - INFO - Step charge_migration running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00006_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:25,160 - stpipe.Detector1Pipeline.charge_migration - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:25,295 - stpipe.Detector1Pipeline.jump - INFO - Step jump running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00006_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:25,303 - stpipe.Detector1Pipeline.jump - INFO - CR rejection threshold = 4 sigma
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:25,303 - stpipe.Detector1Pipeline.jump - INFO - Maximum cores to use = half
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:25,407 - stpipe.Detector1Pipeline.jump - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:25,410 - stpipe.Detector1Pipeline.jump - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:25,434 - stpipe.Detector1Pipeline.jump - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:25,439 - stpipe.Detector1Pipeline.jump - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:25,593 - stcal.jump.jump - INFO - Executing two-point difference method
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:25,594 - stcal.jump.jump - INFO - Creating 4 processes for jump detection 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:30,003 - stcal.jump.jump - INFO - Total elapsed time = 4.40905 sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:30,139 - stpipe.Detector1Pipeline.jump - INFO - The execution time in seconds: 4.835927
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:30,141 - stpipe.Detector1Pipeline.jump - INFO - Step jump done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:30,287 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step clean_flicker_noise running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00006_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:30,287 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:30,427 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00006_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:30,543 - jwst.ramp_fitting.ramp_fit_step - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:30,543 - jwst.ramp_fitting.ramp_fit_step - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:30,568 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:30,573 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:30,578 - jwst.ramp_fitting.ramp_fit_step - INFO - Using algorithm = OLS_C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:30,579 - jwst.ramp_fitting.ramp_fit_step - INFO - Using weighting = optimal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:30,891 - stcal.ramp_fitting.ols_fit - INFO - Number of multiprocessing slices: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:30,896 - stcal.ramp_fitting.ols_fit - INFO - Number of leading groups that are flagged as DO_NOT_USE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:30,897 - stcal.ramp_fitting.ols_fit - INFO - MIRI dataset has all pixels in the final group flagged as DO_NOT_USE.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:41,393 - stcal.ramp_fitting.ols_fit - INFO - Ramp Fitting C Time: 10.494817733764648
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:41,436 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:41,580 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;ImageModel(224, 288) from jw01386007001_04101_00006_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:41,601 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:41,602 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:41,740 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;ImageModel(224, 288) from jw01386007001_04101_00006_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:41,755 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:41,756 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:41,758 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:41,897 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00006_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:41,918 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:41,919 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,060 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00006_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,077 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,078 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,080 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,149 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00006_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,149 - jwst.pipeline.calwebb_detector1 - INFO - ... ending calwebb_detector1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,150 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,201 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00006_mirimage_rate.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,201 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,202 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,224 - stpipe - INFO - PARS-EMICORRSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-emicorrstep_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,238 - stpipe - INFO - PARS-DARKCURRENTSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-darkcurrentstep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,248 - stpipe - INFO - PARS-JUMPSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-jumpstep_0004.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,259 - stpipe - INFO - PARS-DETECTOR1PIPELINE parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-detector1pipeline_0008.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,275 - stpipe.Detector1Pipeline - INFO - Detector1Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,276 - stpipe.Detector1Pipeline.group_scale - INFO - GroupScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,277 - stpipe.Detector1Pipeline.dq_init - INFO - DQInitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,277 - stpipe.Detector1Pipeline.emicorr - INFO - EmiCorrStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,278 - stpipe.Detector1Pipeline.saturation - INFO - SaturationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,279 - stpipe.Detector1Pipeline.ipc - INFO - IPCStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,280 - stpipe.Detector1Pipeline.superbias - INFO - SuperBiasStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,281 - stpipe.Detector1Pipeline.refpix - INFO - RefPixStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,281 - stpipe.Detector1Pipeline.rscd - INFO - RscdStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,282 - stpipe.Detector1Pipeline.firstframe - INFO - FirstFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,283 - stpipe.Detector1Pipeline.lastframe - INFO - LastFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,283 - stpipe.Detector1Pipeline.linearity - INFO - LinearityStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,284 - stpipe.Detector1Pipeline.dark_current - INFO - DarkCurrentStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,285 - stpipe.Detector1Pipeline.reset - INFO - ResetStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,286 - stpipe.Detector1Pipeline.persistence - INFO - PersistenceStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,287 - stpipe.Detector1Pipeline.charge_migration - INFO - ChargeMigrationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,288 - stpipe.Detector1Pipeline.jump - INFO - JumpStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,289 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - CleanFlickerNoiseStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,290 - stpipe.Detector1Pipeline.ramp_fit - INFO - RampFitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,291 - stpipe.Detector1Pipeline.gain_scale - INFO - GainScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,291 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - XplyStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,434 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline running with args (np.str_(&#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/uncal/jw01386007001_04101_00007_mirimage_uncal.fits&#39;),).
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/uncal/jw01386007001_04101_00007_mirimage_uncal.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,453 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./miri_coro_demo_data/Obs007/stage1
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_calibrated_ramp: False
  steps:
    group_scale:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dq_init:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    emicorr:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: joint
      nints_to_phase: None
      nbins: None
      scale_reference: True
      onthefly_corr_freq: None
      use_n_cycles: 3
      fit_ints_separately: False
      user_supplied_reffile: None
      save_intermediate_results: False
    saturation:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      n_pix_grow_sat: 1
      use_readpatt: True
    ipc:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    superbias:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    refpix:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      odd_even_columns: True
      use_side_ref_pixels: True
      side_smoothing_length: 11
      side_gain: 1.0
      odd_even_rows: True
      ovr_corr_mitigation_ftr: 3.0
      preserve_irs2_refpix: False
      irs2_mean_subtraction: False
      refpix_algorithm: median
      sigreject: 4.0
      gaussmooth: 1.0
      halfwidth: 30
    rscd:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    firstframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bright_use_group1: False
    lastframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    linearity:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dark_current:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      dark_output: None
      average_dark_current: 1.0
    reset:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    persistence:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      input_trapsfilled: &#39;&#39;
      flag_pers_cutoff: 40.0
      save_persistence: False
      save_trapsfilled: True
      modify_input: False
    charge_migration:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      signal_threshold: 25000.0
    jump:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      rejection_threshold: 4.0
      three_group_rejection_threshold: 6.0
      four_group_rejection_threshold: 5.0
      maximum_cores: half
      flag_4_neighbors: True
      max_jump_to_flag_neighbors: 1000
      min_jump_to_flag_neighbors: 30
      after_jump_flag_dn1: 500
      after_jump_flag_time1: 15
      after_jump_flag_dn2: 1000
      after_jump_flag_time2: 3000
      expand_large_events: False
      min_sat_area: 1
      min_jump_area: 0
      expand_factor: 0
      use_ellipses: False
      sat_required_snowball: False
      min_sat_radius_extend: 0.0
      sat_expand: 0
      edge_size: 0
      mask_snowball_core_next_int: True
      snowball_time_masked_next_int: 4000
      find_showers: False
      max_shower_amplitude: 4.0
      extend_snr_threshold: 3.0
      extend_min_area: 50
      extend_inner_radius: 1
      extend_outer_radius: 2.6
      extend_ellipse_expand_ratio: 1.1
      time_masked_after_shower: 30
      min_diffs_single_pass: 10
      max_extended_radius: 200
      minimum_groups: 3
      minimum_sigclip_groups: 100
      only_use_ints: True
    clean_flicker_noise:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      fit_method: median
      fit_by_channel: False
      background_method: median
      background_box_size: None
      mask_science_regions: False
      apply_flat_field: False
      n_sigma: 2.0
      fit_histogram: False
      single_mask: True
      user_mask: None
      save_mask: False
      save_background: False
      save_noise: False
    ramp_fit:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: OLS_C
      int_name: &#39;&#39;
      save_opt: False
      opt_name: &#39;&#39;
      suppress_one_group: True
      firstgroup: None
      lastgroup: None
      maximum_cores: &#39;1&#39;
    gain_scale:
      pre_hooks: []
      post_hooks:
      - !!python/name:__main__.XplyStep &#39;&#39;
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,475 - stpipe.Detector1Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01386007001_04101_00007_mirimage_uncal.fits&#39; reftypes = [&#39;dark&#39;, &#39;emicorr&#39;, &#39;gain&#39;, &#39;linearity&#39;, &#39;mask&#39;, &#39;persat&#39;, &#39;readnoise&#39;, &#39;reset&#39;, &#39;rscd&#39;, &#39;saturation&#39;, &#39;superbias&#39;, &#39;trapdensity&#39;, &#39;trappars&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,478 - stpipe.Detector1Pipeline - INFO - Prefetch for DARK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,478 - stpipe.Detector1Pipeline - INFO - Prefetch for EMICORR reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,479 - stpipe.Detector1Pipeline - INFO - Prefetch for GAIN reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,479 - stpipe.Detector1Pipeline - INFO - Prefetch for LINEARITY reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,479 - stpipe.Detector1Pipeline - INFO - Prefetch for MASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,480 - stpipe.Detector1Pipeline - INFO - Prefetch for PERSAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,480 - stpipe.Detector1Pipeline - INFO - Prefetch for READNOISE reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,480 - stpipe.Detector1Pipeline - INFO - Prefetch for RESET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,481 - stpipe.Detector1Pipeline - INFO - Prefetch for RSCD reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,481 - stpipe.Detector1Pipeline - INFO - Prefetch for SATURATION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,482 - stpipe.Detector1Pipeline - INFO - Prefetch for SUPERBIAS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,482 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPDENSITY reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,482 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPPARS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:42,482 - jwst.pipeline.calwebb_detector1 - INFO - Starting calwebb_detector1 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:43,069 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00007_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:43,076 - stpipe.Detector1Pipeline.group_scale - INFO - NFRAMES and FRMDIVSR are equal; correction not needed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:43,076 - stpipe.Detector1Pipeline.group_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:43,078 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:43,220 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00007_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:43,229 - stpipe.Detector1Pipeline.dq_init - INFO - Using MASK reference file /home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:43,356 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:43,367 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:43,371 - jwst.dq_init.dq_initialization - INFO - Extracting mask subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:43,483 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:43,629 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00007_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:43,742 - stpipe.Detector1Pipeline.emicorr - INFO - Using CRDS reference file: /home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:43,760 - jwst.emicorr.emicorr - INFO - Using reference file to get subarray case.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:43,760 - jwst.emicorr.emicorr - INFO - With configuration: Subarray=MASK1550, Read_pattern=FASTR1, Detector=MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:43,760 - jwst.emicorr.emicorr - INFO - Will correct data for the following 2 frequencies: 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:43,761 - jwst.emicorr.emicorr - INFO -    [&#39;Hz390&#39;, &#39;Hz10&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:43,761 - jwst.emicorr.emicorr - INFO - Running EMI fit with algorithm = &#39;joint&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:55,936 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:56,078 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00007_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:56,088 - stpipe.Detector1Pipeline.saturation - INFO - Using SATURATION reference file /home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:56,088 - stpipe.Detector1Pipeline.saturation - INFO - Using SUPERBIAS reference file N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:56,109 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:56,118 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:56,223 - jwst.saturation.saturation - INFO - Extracting reference file subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:56,230 - jwst.saturation.saturation - INFO - Using read_pattern with nframes 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:57,163 - stcal.saturation.saturation - INFO - Detected 639 saturated pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:57,191 - stcal.saturation.saturation - INFO - Detected 1 A/D floor pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:57,195 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:57,339 - stpipe.Detector1Pipeline.ipc - INFO - Step ipc running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00007_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:57,339 - stpipe.Detector1Pipeline.ipc - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:57,472 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00007_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:57,583 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:57,725 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00007_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:57,835 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:57,979 - stpipe.Detector1Pipeline.reset - INFO - Step reset running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00007_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:57,988 - stpipe.Detector1Pipeline.reset - INFO - Using RESET reference file /home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:58,007 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:58,010 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:58,139 - stpipe.Detector1Pipeline.reset - INFO - Step reset done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:58,282 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00007_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:58,291 - stpipe.Detector1Pipeline.linearity - INFO - Using Linearity reference file /home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:58,314 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:58,323 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:59,130 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:59,277 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00007_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:59,286 - stpipe.Detector1Pipeline.rscd - INFO - Using RSCD reference file /home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:59,419 - jwst.rscd.rscd_sub - INFO - Number of groups to skip for integrations 2 and higher: 4
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:59,422 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:59,561 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00007_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:59,570 - stpipe.Detector1Pipeline.dark_current - INFO - Using DARK reference file /home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:59,802 - stdatamodels.dynamicdq - WARNING - Keyword UNDERSAMP does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:59,805 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:59,807 - stpipe.Detector1Pipeline.dark_current - INFO - Using Poisson noise from average dark current 1.0 e-/sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:59,807 - stcal.dark_current.dark_sub - INFO - Science data nints=19, ngroups=100, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:54:59,807 - stcal.dark_current.dark_sub - INFO - Dark data nints=3, ngroups=500, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:00,077 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:00,221 - stpipe.Detector1Pipeline.refpix - INFO - Step refpix running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00007_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:00,222 - stpipe.Detector1Pipeline.refpix - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:00,353 - stpipe.Detector1Pipeline.charge_migration - INFO - Step charge_migration running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00007_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:00,354 - stpipe.Detector1Pipeline.charge_migration - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:00,488 - stpipe.Detector1Pipeline.jump - INFO - Step jump running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00007_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:00,496 - stpipe.Detector1Pipeline.jump - INFO - CR rejection threshold = 4 sigma
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:00,496 - stpipe.Detector1Pipeline.jump - INFO - Maximum cores to use = half
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:00,600 - stpipe.Detector1Pipeline.jump - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:00,602 - stpipe.Detector1Pipeline.jump - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:00,627 - stpipe.Detector1Pipeline.jump - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:00,632 - stpipe.Detector1Pipeline.jump - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:00,787 - stcal.jump.jump - INFO - Executing two-point difference method
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:00,788 - stcal.jump.jump - INFO - Creating 4 processes for jump detection 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:05,181 - stcal.jump.jump - INFO - Total elapsed time = 4.39346 sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:05,317 - stpipe.Detector1Pipeline.jump - INFO - The execution time in seconds: 4.821275
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:05,320 - stpipe.Detector1Pipeline.jump - INFO - Step jump done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:05,466 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step clean_flicker_noise running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00007_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:05,467 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:05,602 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00007_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:05,716 - jwst.ramp_fitting.ramp_fit_step - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:05,716 - jwst.ramp_fitting.ramp_fit_step - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:05,741 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:05,746 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:05,751 - jwst.ramp_fitting.ramp_fit_step - INFO - Using algorithm = OLS_C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:05,751 - jwst.ramp_fitting.ramp_fit_step - INFO - Using weighting = optimal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:06,063 - stcal.ramp_fitting.ols_fit - INFO - Number of multiprocessing slices: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:06,069 - stcal.ramp_fitting.ols_fit - INFO - Number of leading groups that are flagged as DO_NOT_USE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:06,070 - stcal.ramp_fitting.ols_fit - INFO - MIRI dataset has all pixels in the final group flagged as DO_NOT_USE.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:16,567 - stcal.ramp_fitting.ols_fit - INFO - Ramp Fitting C Time: 10.496265888214111
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:16,609 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:16,755 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;ImageModel(224, 288) from jw01386007001_04101_00007_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:16,776 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:16,776 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:16,914 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;ImageModel(224, 288) from jw01386007001_04101_00007_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:16,928 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:16,930 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:16,931 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,070 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00007_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,091 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,092 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,232 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00007_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,251 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,252 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,253 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,321 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00007_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,322 - jwst.pipeline.calwebb_detector1 - INFO - ... ending calwebb_detector1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,322 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,373 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00007_mirimage_rate.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,373 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,374 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,395 - stpipe - INFO - PARS-EMICORRSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-emicorrstep_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,410 - stpipe - INFO - PARS-DARKCURRENTSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-darkcurrentstep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,420 - stpipe - INFO - PARS-JUMPSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-jumpstep_0004.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,430 - stpipe - INFO - PARS-DETECTOR1PIPELINE parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-detector1pipeline_0008.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,446 - stpipe.Detector1Pipeline - INFO - Detector1Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,447 - stpipe.Detector1Pipeline.group_scale - INFO - GroupScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,448 - stpipe.Detector1Pipeline.dq_init - INFO - DQInitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,449 - stpipe.Detector1Pipeline.emicorr - INFO - EmiCorrStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,449 - stpipe.Detector1Pipeline.saturation - INFO - SaturationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,450 - stpipe.Detector1Pipeline.ipc - INFO - IPCStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,451 - stpipe.Detector1Pipeline.superbias - INFO - SuperBiasStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,452 - stpipe.Detector1Pipeline.refpix - INFO - RefPixStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,452 - stpipe.Detector1Pipeline.rscd - INFO - RscdStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,453 - stpipe.Detector1Pipeline.firstframe - INFO - FirstFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,454 - stpipe.Detector1Pipeline.lastframe - INFO - LastFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,454 - stpipe.Detector1Pipeline.linearity - INFO - LinearityStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,455 - stpipe.Detector1Pipeline.dark_current - INFO - DarkCurrentStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,456 - stpipe.Detector1Pipeline.reset - INFO - ResetStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,457 - stpipe.Detector1Pipeline.persistence - INFO - PersistenceStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,457 - stpipe.Detector1Pipeline.charge_migration - INFO - ChargeMigrationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,459 - stpipe.Detector1Pipeline.jump - INFO - JumpStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,460 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - CleanFlickerNoiseStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,461 - stpipe.Detector1Pipeline.ramp_fit - INFO - RampFitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,461 - stpipe.Detector1Pipeline.gain_scale - INFO - GainScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,462 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - XplyStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,602 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline running with args (np.str_(&#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/uncal/jw01386007001_04101_00008_mirimage_uncal.fits&#39;),).
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/uncal/jw01386007001_04101_00008_mirimage_uncal.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,622 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./miri_coro_demo_data/Obs007/stage1
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_calibrated_ramp: False
  steps:
    group_scale:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dq_init:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    emicorr:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: joint
      nints_to_phase: None
      nbins: None
      scale_reference: True
      onthefly_corr_freq: None
      use_n_cycles: 3
      fit_ints_separately: False
      user_supplied_reffile: None
      save_intermediate_results: False
    saturation:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      n_pix_grow_sat: 1
      use_readpatt: True
    ipc:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    superbias:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    refpix:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      odd_even_columns: True
      use_side_ref_pixels: True
      side_smoothing_length: 11
      side_gain: 1.0
      odd_even_rows: True
      ovr_corr_mitigation_ftr: 3.0
      preserve_irs2_refpix: False
      irs2_mean_subtraction: False
      refpix_algorithm: median
      sigreject: 4.0
      gaussmooth: 1.0
      halfwidth: 30
    rscd:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    firstframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bright_use_group1: False
    lastframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    linearity:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dark_current:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      dark_output: None
      average_dark_current: 1.0
    reset:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    persistence:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      input_trapsfilled: &#39;&#39;
      flag_pers_cutoff: 40.0
      save_persistence: False
      save_trapsfilled: True
      modify_input: False
    charge_migration:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      signal_threshold: 25000.0
    jump:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      rejection_threshold: 4.0
      three_group_rejection_threshold: 6.0
      four_group_rejection_threshold: 5.0
      maximum_cores: half
      flag_4_neighbors: True
      max_jump_to_flag_neighbors: 1000
      min_jump_to_flag_neighbors: 30
      after_jump_flag_dn1: 500
      after_jump_flag_time1: 15
      after_jump_flag_dn2: 1000
      after_jump_flag_time2: 3000
      expand_large_events: False
      min_sat_area: 1
      min_jump_area: 0
      expand_factor: 0
      use_ellipses: False
      sat_required_snowball: False
      min_sat_radius_extend: 0.0
      sat_expand: 0
      edge_size: 0
      mask_snowball_core_next_int: True
      snowball_time_masked_next_int: 4000
      find_showers: False
      max_shower_amplitude: 4.0
      extend_snr_threshold: 3.0
      extend_min_area: 50
      extend_inner_radius: 1
      extend_outer_radius: 2.6
      extend_ellipse_expand_ratio: 1.1
      time_masked_after_shower: 30
      min_diffs_single_pass: 10
      max_extended_radius: 200
      minimum_groups: 3
      minimum_sigclip_groups: 100
      only_use_ints: True
    clean_flicker_noise:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      fit_method: median
      fit_by_channel: False
      background_method: median
      background_box_size: None
      mask_science_regions: False
      apply_flat_field: False
      n_sigma: 2.0
      fit_histogram: False
      single_mask: True
      user_mask: None
      save_mask: False
      save_background: False
      save_noise: False
    ramp_fit:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: OLS_C
      int_name: &#39;&#39;
      save_opt: False
      opt_name: &#39;&#39;
      suppress_one_group: True
      firstgroup: None
      lastgroup: None
      maximum_cores: &#39;1&#39;
    gain_scale:
      pre_hooks: []
      post_hooks:
      - !!python/name:__main__.XplyStep &#39;&#39;
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,643 - stpipe.Detector1Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01386007001_04101_00008_mirimage_uncal.fits&#39; reftypes = [&#39;dark&#39;, &#39;emicorr&#39;, &#39;gain&#39;, &#39;linearity&#39;, &#39;mask&#39;, &#39;persat&#39;, &#39;readnoise&#39;, &#39;reset&#39;, &#39;rscd&#39;, &#39;saturation&#39;, &#39;superbias&#39;, &#39;trapdensity&#39;, &#39;trappars&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,646 - stpipe.Detector1Pipeline - INFO - Prefetch for DARK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,646 - stpipe.Detector1Pipeline - INFO - Prefetch for EMICORR reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,647 - stpipe.Detector1Pipeline - INFO - Prefetch for GAIN reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,647 - stpipe.Detector1Pipeline - INFO - Prefetch for LINEARITY reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,648 - stpipe.Detector1Pipeline - INFO - Prefetch for MASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,648 - stpipe.Detector1Pipeline - INFO - Prefetch for PERSAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,649 - stpipe.Detector1Pipeline - INFO - Prefetch for READNOISE reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,649 - stpipe.Detector1Pipeline - INFO - Prefetch for RESET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,649 - stpipe.Detector1Pipeline - INFO - Prefetch for RSCD reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,650 - stpipe.Detector1Pipeline - INFO - Prefetch for SATURATION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,650 - stpipe.Detector1Pipeline - INFO - Prefetch for SUPERBIAS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,651 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPDENSITY reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,651 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPPARS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:17,653 - jwst.pipeline.calwebb_detector1 - INFO - Starting calwebb_detector1 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:18,253 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00008_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:18,260 - stpipe.Detector1Pipeline.group_scale - INFO - NFRAMES and FRMDIVSR are equal; correction not needed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:18,261 - stpipe.Detector1Pipeline.group_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:18,262 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:18,402 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00008_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:18,411 - stpipe.Detector1Pipeline.dq_init - INFO - Using MASK reference file /home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:18,538 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:18,549 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:18,553 - jwst.dq_init.dq_initialization - INFO - Extracting mask subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:18,666 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:18,812 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00008_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:18,925 - stpipe.Detector1Pipeline.emicorr - INFO - Using CRDS reference file: /home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:18,942 - jwst.emicorr.emicorr - INFO - Using reference file to get subarray case.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:18,943 - jwst.emicorr.emicorr - INFO - With configuration: Subarray=MASK1550, Read_pattern=FASTR1, Detector=MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:18,943 - jwst.emicorr.emicorr - INFO - Will correct data for the following 2 frequencies: 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:18,944 - jwst.emicorr.emicorr - INFO -    [&#39;Hz390&#39;, &#39;Hz10&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:18,944 - jwst.emicorr.emicorr - INFO - Running EMI fit with algorithm = &#39;joint&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:31,035 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:31,184 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00008_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:31,194 - stpipe.Detector1Pipeline.saturation - INFO - Using SATURATION reference file /home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:31,194 - stpipe.Detector1Pipeline.saturation - INFO - Using SUPERBIAS reference file N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:31,215 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:31,224 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:31,331 - jwst.saturation.saturation - INFO - Extracting reference file subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:31,338 - jwst.saturation.saturation - INFO - Using read_pattern with nframes 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:32,271 - stcal.saturation.saturation - INFO - Detected 645 saturated pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:32,298 - stcal.saturation.saturation - INFO - Detected 11 A/D floor pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:32,302 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:32,447 - stpipe.Detector1Pipeline.ipc - INFO - Step ipc running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00008_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:32,448 - stpipe.Detector1Pipeline.ipc - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:32,593 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00008_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:32,705 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:32,851 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00008_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:32,961 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:33,103 - stpipe.Detector1Pipeline.reset - INFO - Step reset running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00008_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:33,112 - stpipe.Detector1Pipeline.reset - INFO - Using RESET reference file /home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:33,132 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:33,134 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:33,264 - stpipe.Detector1Pipeline.reset - INFO - Step reset done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:33,407 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00008_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:33,415 - stpipe.Detector1Pipeline.linearity - INFO - Using Linearity reference file /home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:33,438 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:33,447 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:34,252 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:34,394 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00008_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:34,403 - stpipe.Detector1Pipeline.rscd - INFO - Using RSCD reference file /home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:34,536 - jwst.rscd.rscd_sub - INFO - Number of groups to skip for integrations 2 and higher: 4
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:34,539 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:34,678 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00008_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:34,688 - stpipe.Detector1Pipeline.dark_current - INFO - Using DARK reference file /home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:34,920 - stdatamodels.dynamicdq - WARNING - Keyword UNDERSAMP does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:34,924 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:34,925 - stpipe.Detector1Pipeline.dark_current - INFO - Using Poisson noise from average dark current 1.0 e-/sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:34,926 - stcal.dark_current.dark_sub - INFO - Science data nints=19, ngroups=100, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:34,926 - stcal.dark_current.dark_sub - INFO - Dark data nints=3, ngroups=500, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:35,196 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:35,344 - stpipe.Detector1Pipeline.refpix - INFO - Step refpix running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00008_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:35,345 - stpipe.Detector1Pipeline.refpix - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:35,479 - stpipe.Detector1Pipeline.charge_migration - INFO - Step charge_migration running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00008_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:35,480 - stpipe.Detector1Pipeline.charge_migration - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:35,615 - stpipe.Detector1Pipeline.jump - INFO - Step jump running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00008_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:35,623 - stpipe.Detector1Pipeline.jump - INFO - CR rejection threshold = 4 sigma
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:35,623 - stpipe.Detector1Pipeline.jump - INFO - Maximum cores to use = half
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:35,727 - stpipe.Detector1Pipeline.jump - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:35,730 - stpipe.Detector1Pipeline.jump - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:35,754 - stpipe.Detector1Pipeline.jump - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:35,759 - stpipe.Detector1Pipeline.jump - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:35,914 - stcal.jump.jump - INFO - Executing two-point difference method
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:35,915 - stcal.jump.jump - INFO - Creating 4 processes for jump detection 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:40,307 - stcal.jump.jump - INFO - Total elapsed time = 4.39283 sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:40,443 - stpipe.Detector1Pipeline.jump - INFO - The execution time in seconds: 4.820783
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:40,447 - stpipe.Detector1Pipeline.jump - INFO - Step jump done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:40,591 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step clean_flicker_noise running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00008_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:40,592 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:40,730 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00008_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:40,846 - jwst.ramp_fitting.ramp_fit_step - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:40,847 - jwst.ramp_fitting.ramp_fit_step - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:40,871 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:40,876 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:40,881 - jwst.ramp_fitting.ramp_fit_step - INFO - Using algorithm = OLS_C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:40,881 - jwst.ramp_fitting.ramp_fit_step - INFO - Using weighting = optimal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:41,192 - stcal.ramp_fitting.ols_fit - INFO - Number of multiprocessing slices: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:41,197 - stcal.ramp_fitting.ols_fit - INFO - Number of leading groups that are flagged as DO_NOT_USE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:41,198 - stcal.ramp_fitting.ols_fit - INFO - MIRI dataset has all pixels in the final group flagged as DO_NOT_USE.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:51,702 - stcal.ramp_fitting.ols_fit - INFO - Ramp Fitting C Time: 10.503097772598267
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:51,744 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:51,888 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;ImageModel(224, 288) from jw01386007001_04101_00008_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:51,909 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:51,910 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,049 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;ImageModel(224, 288) from jw01386007001_04101_00008_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,063 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,064 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,066 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,204 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00008_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,225 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,226 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,362 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00008_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,382 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,383 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,385 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,453 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00008_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,453 - jwst.pipeline.calwebb_detector1 - INFO - ... ending calwebb_detector1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,454 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,504 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00008_mirimage_rate.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,505 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,506 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,527 - stpipe - INFO - PARS-EMICORRSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-emicorrstep_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,542 - stpipe - INFO - PARS-DARKCURRENTSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-darkcurrentstep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,551 - stpipe - INFO - PARS-JUMPSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-jumpstep_0004.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,562 - stpipe - INFO - PARS-DETECTOR1PIPELINE parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-detector1pipeline_0008.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,578 - stpipe.Detector1Pipeline - INFO - Detector1Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,579 - stpipe.Detector1Pipeline.group_scale - INFO - GroupScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,579 - stpipe.Detector1Pipeline.dq_init - INFO - DQInitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,580 - stpipe.Detector1Pipeline.emicorr - INFO - EmiCorrStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,581 - stpipe.Detector1Pipeline.saturation - INFO - SaturationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,582 - stpipe.Detector1Pipeline.ipc - INFO - IPCStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,582 - stpipe.Detector1Pipeline.superbias - INFO - SuperBiasStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,583 - stpipe.Detector1Pipeline.refpix - INFO - RefPixStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,584 - stpipe.Detector1Pipeline.rscd - INFO - RscdStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,585 - stpipe.Detector1Pipeline.firstframe - INFO - FirstFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,585 - stpipe.Detector1Pipeline.lastframe - INFO - LastFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,586 - stpipe.Detector1Pipeline.linearity - INFO - LinearityStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,587 - stpipe.Detector1Pipeline.dark_current - INFO - DarkCurrentStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,587 - stpipe.Detector1Pipeline.reset - INFO - ResetStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,589 - stpipe.Detector1Pipeline.persistence - INFO - PersistenceStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,589 - stpipe.Detector1Pipeline.charge_migration - INFO - ChargeMigrationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,591 - stpipe.Detector1Pipeline.jump - INFO - JumpStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,592 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - CleanFlickerNoiseStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,593 - stpipe.Detector1Pipeline.ramp_fit - INFO - RampFitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,593 - stpipe.Detector1Pipeline.gain_scale - INFO - GainScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,594 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - XplyStep instance created.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/uncal/jw01386007001_04101_00009_mirimage_uncal.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,732 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline running with args (np.str_(&#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/uncal/jw01386007001_04101_00009_mirimage_uncal.fits&#39;),).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,753 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./miri_coro_demo_data/Obs007/stage1
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_calibrated_ramp: False
  steps:
    group_scale:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dq_init:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    emicorr:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: joint
      nints_to_phase: None
      nbins: None
      scale_reference: True
      onthefly_corr_freq: None
      use_n_cycles: 3
      fit_ints_separately: False
      user_supplied_reffile: None
      save_intermediate_results: False
    saturation:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      n_pix_grow_sat: 1
      use_readpatt: True
    ipc:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    superbias:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    refpix:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      odd_even_columns: True
      use_side_ref_pixels: True
      side_smoothing_length: 11
      side_gain: 1.0
      odd_even_rows: True
      ovr_corr_mitigation_ftr: 3.0
      preserve_irs2_refpix: False
      irs2_mean_subtraction: False
      refpix_algorithm: median
      sigreject: 4.0
      gaussmooth: 1.0
      halfwidth: 30
    rscd:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    firstframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bright_use_group1: False
    lastframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    linearity:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dark_current:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      dark_output: None
      average_dark_current: 1.0
    reset:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    persistence:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      input_trapsfilled: &#39;&#39;
      flag_pers_cutoff: 40.0
      save_persistence: False
      save_trapsfilled: True
      modify_input: False
    charge_migration:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      signal_threshold: 25000.0
    jump:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      rejection_threshold: 4.0
      three_group_rejection_threshold: 6.0
      four_group_rejection_threshold: 5.0
      maximum_cores: half
      flag_4_neighbors: True
      max_jump_to_flag_neighbors: 1000
      min_jump_to_flag_neighbors: 30
      after_jump_flag_dn1: 500
      after_jump_flag_time1: 15
      after_jump_flag_dn2: 1000
      after_jump_flag_time2: 3000
      expand_large_events: False
      min_sat_area: 1
      min_jump_area: 0
      expand_factor: 0
      use_ellipses: False
      sat_required_snowball: False
      min_sat_radius_extend: 0.0
      sat_expand: 0
      edge_size: 0
      mask_snowball_core_next_int: True
      snowball_time_masked_next_int: 4000
      find_showers: False
      max_shower_amplitude: 4.0
      extend_snr_threshold: 3.0
      extend_min_area: 50
      extend_inner_radius: 1
      extend_outer_radius: 2.6
      extend_ellipse_expand_ratio: 1.1
      time_masked_after_shower: 30
      min_diffs_single_pass: 10
      max_extended_radius: 200
      minimum_groups: 3
      minimum_sigclip_groups: 100
      only_use_ints: True
    clean_flicker_noise:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      fit_method: median
      fit_by_channel: False
      background_method: median
      background_box_size: None
      mask_science_regions: False
      apply_flat_field: False
      n_sigma: 2.0
      fit_histogram: False
      single_mask: True
      user_mask: None
      save_mask: False
      save_background: False
      save_noise: False
    ramp_fit:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: OLS_C
      int_name: &#39;&#39;
      save_opt: False
      opt_name: &#39;&#39;
      suppress_one_group: True
      firstgroup: None
      lastgroup: None
      maximum_cores: &#39;1&#39;
    gain_scale:
      pre_hooks: []
      post_hooks:
      - !!python/name:__main__.XplyStep &#39;&#39;
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,773 - stpipe.Detector1Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01386007001_04101_00009_mirimage_uncal.fits&#39; reftypes = [&#39;dark&#39;, &#39;emicorr&#39;, &#39;gain&#39;, &#39;linearity&#39;, &#39;mask&#39;, &#39;persat&#39;, &#39;readnoise&#39;, &#39;reset&#39;, &#39;rscd&#39;, &#39;saturation&#39;, &#39;superbias&#39;, &#39;trapdensity&#39;, &#39;trappars&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,775 - stpipe.Detector1Pipeline - INFO - Prefetch for DARK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,776 - stpipe.Detector1Pipeline - INFO - Prefetch for EMICORR reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,776 - stpipe.Detector1Pipeline - INFO - Prefetch for GAIN reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,776 - stpipe.Detector1Pipeline - INFO - Prefetch for LINEARITY reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,777 - stpipe.Detector1Pipeline - INFO - Prefetch for MASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,777 - stpipe.Detector1Pipeline - INFO - Prefetch for PERSAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,778 - stpipe.Detector1Pipeline - INFO - Prefetch for READNOISE reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,778 - stpipe.Detector1Pipeline - INFO - Prefetch for RESET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,778 - stpipe.Detector1Pipeline - INFO - Prefetch for RSCD reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,779 - stpipe.Detector1Pipeline - INFO - Prefetch for SATURATION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,779 - stpipe.Detector1Pipeline - INFO - Prefetch for SUPERBIAS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,779 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPDENSITY reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,780 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPPARS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:52,780 - jwst.pipeline.calwebb_detector1 - INFO - Starting calwebb_detector1 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:53,369 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00009_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:53,378 - stpipe.Detector1Pipeline.group_scale - INFO - NFRAMES and FRMDIVSR are equal; correction not needed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:53,378 - stpipe.Detector1Pipeline.group_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:53,379 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:53,520 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00009_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:53,529 - stpipe.Detector1Pipeline.dq_init - INFO - Using MASK reference file /home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:53,653 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:53,664 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:53,668 - jwst.dq_init.dq_initialization - INFO - Extracting mask subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:53,780 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:53,924 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00009_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:54,034 - stpipe.Detector1Pipeline.emicorr - INFO - Using CRDS reference file: /home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:54,051 - jwst.emicorr.emicorr - INFO - Using reference file to get subarray case.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:54,052 - jwst.emicorr.emicorr - INFO - With configuration: Subarray=MASK1550, Read_pattern=FASTR1, Detector=MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:54,052 - jwst.emicorr.emicorr - INFO - Will correct data for the following 2 frequencies: 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:54,052 - jwst.emicorr.emicorr - INFO -    [&#39;Hz390&#39;, &#39;Hz10&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:55:54,053 - jwst.emicorr.emicorr - INFO - Running EMI fit with algorithm = &#39;joint&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:06,197 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:06,342 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00009_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:06,352 - stpipe.Detector1Pipeline.saturation - INFO - Using SATURATION reference file /home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:06,353 - stpipe.Detector1Pipeline.saturation - INFO - Using SUPERBIAS reference file N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:06,373 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:06,382 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:06,486 - jwst.saturation.saturation - INFO - Extracting reference file subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:06,493 - jwst.saturation.saturation - INFO - Using read_pattern with nframes 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:07,415 - stcal.saturation.saturation - INFO - Detected 648 saturated pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:07,443 - stcal.saturation.saturation - INFO - Detected 0 A/D floor pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:07,447 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:07,587 - stpipe.Detector1Pipeline.ipc - INFO - Step ipc running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00009_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:07,588 - stpipe.Detector1Pipeline.ipc - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:07,724 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00009_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:07,835 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:07,977 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00009_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:08,086 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:08,230 - stpipe.Detector1Pipeline.reset - INFO - Step reset running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00009_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:08,239 - stpipe.Detector1Pipeline.reset - INFO - Using RESET reference file /home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:08,258 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:08,260 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:08,390 - stpipe.Detector1Pipeline.reset - INFO - Step reset done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:08,531 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00009_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:08,540 - stpipe.Detector1Pipeline.linearity - INFO - Using Linearity reference file /home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:08,562 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:08,571 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:09,376 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:09,520 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00009_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:09,529 - stpipe.Detector1Pipeline.rscd - INFO - Using RSCD reference file /home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:09,662 - jwst.rscd.rscd_sub - INFO - Number of groups to skip for integrations 2 and higher: 4
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:09,665 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:09,808 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00009_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:09,817 - stpipe.Detector1Pipeline.dark_current - INFO - Using DARK reference file /home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:10,049 - stdatamodels.dynamicdq - WARNING - Keyword UNDERSAMP does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:10,052 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:10,054 - stpipe.Detector1Pipeline.dark_current - INFO - Using Poisson noise from average dark current 1.0 e-/sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:10,054 - stcal.dark_current.dark_sub - INFO - Science data nints=19, ngroups=100, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:10,055 - stcal.dark_current.dark_sub - INFO - Dark data nints=3, ngroups=500, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:10,323 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:10,465 - stpipe.Detector1Pipeline.refpix - INFO - Step refpix running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00009_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:10,466 - stpipe.Detector1Pipeline.refpix - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:10,601 - stpipe.Detector1Pipeline.charge_migration - INFO - Step charge_migration running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00009_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:10,602 - stpipe.Detector1Pipeline.charge_migration - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:10,738 - stpipe.Detector1Pipeline.jump - INFO - Step jump running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00009_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:10,746 - stpipe.Detector1Pipeline.jump - INFO - CR rejection threshold = 4 sigma
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:10,746 - stpipe.Detector1Pipeline.jump - INFO - Maximum cores to use = half
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:10,852 - stpipe.Detector1Pipeline.jump - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:10,855 - stpipe.Detector1Pipeline.jump - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:10,879 - stpipe.Detector1Pipeline.jump - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:10,884 - stpipe.Detector1Pipeline.jump - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:11,038 - stcal.jump.jump - INFO - Executing two-point difference method
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:11,039 - stcal.jump.jump - INFO - Creating 4 processes for jump detection 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:15,452 - stcal.jump.jump - INFO - Total elapsed time = 4.41288 sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:15,586 - stpipe.Detector1Pipeline.jump - INFO - The execution time in seconds: 4.840345
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:15,588 - stpipe.Detector1Pipeline.jump - INFO - Step jump done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:15,732 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step clean_flicker_noise running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00009_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:15,732 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:15,870 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit running with args (&lt;RampModel(19, 100, 224, 288) from jw01386007001_04101_00009_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:15,982 - jwst.ramp_fitting.ramp_fit_step - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:15,983 - jwst.ramp_fitting.ramp_fit_step - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:16,007 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:16,012 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:16,018 - jwst.ramp_fitting.ramp_fit_step - INFO - Using algorithm = OLS_C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:16,018 - jwst.ramp_fitting.ramp_fit_step - INFO - Using weighting = optimal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:16,303 - stcal.ramp_fitting.ols_fit - INFO - Number of multiprocessing slices: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:16,309 - stcal.ramp_fitting.ols_fit - INFO - Number of leading groups that are flagged as DO_NOT_USE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:16,310 - stcal.ramp_fitting.ols_fit - INFO - MIRI dataset has all pixels in the final group flagged as DO_NOT_USE.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:26,811 - stcal.ramp_fitting.ols_fit - INFO - Ramp Fitting C Time: 10.50050163269043
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:26,854 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:26,999 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;ImageModel(224, 288) from jw01386007001_04101_00009_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,020 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,021 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,161 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;ImageModel(224, 288) from jw01386007001_04101_00009_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,176 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,177 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,179 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,316 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00009_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,338 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,338 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,479 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00009_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,496 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,497 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,499 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,567 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00009_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,568 - jwst.pipeline.calwebb_detector1 - INFO - ... ending calwebb_detector1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,569 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,620 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00009_mirimage_rate.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,620 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,620 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
</div>
</div>
</section>
<section id="calibrating-background-files">
<h3>Calibrating Background Files<a class="headerlink" href="#calibrating-background-files" title="Permalink to this heading">#</a></h3>
<p>Look for input background files and run calwebb_detector1
pipeline using the call method.</p>
<p>For the demo example there should be 4 background files in total: two exposures of the background target associated with the science target (taken in the 2-point dither) and two exposures of the background target associated with the PSF reference target (taken in the 2-point dither).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Look for input files of the form *uncal.fits from the background</span>
<span class="c1"># observations</span>
<span class="n">sstring1</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">uncal_bg_sci_dir</span><span class="p">,</span> <span class="s1">&#39;jw*mirimage*uncal.fits&#39;</span><span class="p">)</span>
<span class="n">sstring2</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">uncal_bg_ref_targ_dir</span><span class="p">,</span> <span class="s1">&#39;jw*mirimage*uncal.fits&#39;</span><span class="p">)</span>

<span class="n">uncal_bg_sci_files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">sstring1</span><span class="p">))</span>
<span class="n">uncal_bg_ref_targ_files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">sstring2</span><span class="p">))</span>

<span class="c1"># Check that these are the filter to use</span>
<span class="n">uncal_bg_sci_files</span> <span class="o">=</span> <span class="n">select_mask_filter_files</span><span class="p">(</span><span class="n">uncal_bg_sci_files</span><span class="p">,</span> <span class="n">use_mask</span><span class="p">,</span> <span class="n">use_filter</span><span class="p">)</span>
<span class="n">uncal_bg_ref_targ_files</span> <span class="o">=</span> <span class="n">select_mask_filter_files</span><span class="p">(</span><span class="n">uncal_bg_ref_targ_files</span><span class="p">,</span> <span class="n">use_mask</span><span class="p">,</span> <span class="n">use_filter</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Found &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">uncal_bg_sci_files</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">uncal_bg_ref_targ_files</span><span class="p">)))</span> <span class="o">+</span> <span class="s1">&#39; background input files&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found 4 background input files
</pre></div>
</div>
</div>
</div>
<div class="cell tag_scroll-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run the pipeline on these input files by a simple loop over files using</span>
<span class="c1"># our custom parameter dictionary</span>
<span class="k">if</span> <span class="n">dodet1bg</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">uncal_bg_sci_files</span><span class="p">:</span>
        <span class="n">Detector1Pipeline</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">det1dict</span><span class="p">,</span> <span class="n">save_results</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="n">det1_bg_sci_dir</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">uncal_bg_ref_targ_files</span><span class="p">:</span>
        <span class="n">Detector1Pipeline</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">det1dict</span><span class="p">,</span> <span class="n">save_results</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="n">det1_bg_ref_targ_dir</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Skipping Detector1 processing for BG data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,683 - stpipe - INFO - PARS-EMICORRSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-emicorrstep_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,697 - stpipe - INFO - PARS-DARKCURRENTSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-darkcurrentstep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,707 - stpipe - INFO - PARS-JUMPSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-jumpstep_0004.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,719 - stpipe - INFO - PARS-DETECTOR1PIPELINE parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-detector1pipeline_0008.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,734 - stpipe.Detector1Pipeline - INFO - Detector1Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,735 - stpipe.Detector1Pipeline.group_scale - INFO - GroupScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,736 - stpipe.Detector1Pipeline.dq_init - INFO - DQInitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,737 - stpipe.Detector1Pipeline.emicorr - INFO - EmiCorrStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,738 - stpipe.Detector1Pipeline.saturation - INFO - SaturationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,738 - stpipe.Detector1Pipeline.ipc - INFO - IPCStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,739 - stpipe.Detector1Pipeline.superbias - INFO - SuperBiasStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,740 - stpipe.Detector1Pipeline.refpix - INFO - RefPixStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,741 - stpipe.Detector1Pipeline.rscd - INFO - RscdStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,741 - stpipe.Detector1Pipeline.firstframe - INFO - FirstFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,742 - stpipe.Detector1Pipeline.lastframe - INFO - LastFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,743 - stpipe.Detector1Pipeline.linearity - INFO - LinearityStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,743 - stpipe.Detector1Pipeline.dark_current - INFO - DarkCurrentStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,744 - stpipe.Detector1Pipeline.reset - INFO - ResetStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,745 - stpipe.Detector1Pipeline.persistence - INFO - PersistenceStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,746 - stpipe.Detector1Pipeline.charge_migration - INFO - ChargeMigrationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,747 - stpipe.Detector1Pipeline.jump - INFO - JumpStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,748 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - CleanFlickerNoiseStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,749 - stpipe.Detector1Pipeline.ramp_fit - INFO - RampFitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,750 - stpipe.Detector1Pipeline.gain_scale - INFO - GainScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,751 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - XplyStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,889 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline running with args (np.str_(&#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs030/uncal/jw01386030001_02101_00001_mirimage_uncal.fits&#39;),).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,910 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./miri_coro_demo_data/Obs030/stage1
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_calibrated_ramp: False
  steps:
    group_scale:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dq_init:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    emicorr:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: joint
      nints_to_phase: None
      nbins: None
      scale_reference: True
      onthefly_corr_freq: None
      use_n_cycles: 3
      fit_ints_separately: False
      user_supplied_reffile: None
      save_intermediate_results: False
    saturation:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      n_pix_grow_sat: 1
      use_readpatt: True
    ipc:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    superbias:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    refpix:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      odd_even_columns: True
      use_side_ref_pixels: True
      side_smoothing_length: 11
      side_gain: 1.0
      odd_even_rows: True
      ovr_corr_mitigation_ftr: 3.0
      preserve_irs2_refpix: False
      irs2_mean_subtraction: False
      refpix_algorithm: median
      sigreject: 4.0
      gaussmooth: 1.0
      halfwidth: 30
    rscd:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    firstframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bright_use_group1: False
    lastframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    linearity:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dark_current:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      dark_output: None
      average_dark_current: 1.0
    reset:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    persistence:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      input_trapsfilled: &#39;&#39;
      flag_pers_cutoff: 40.0
      save_persistence: False
      save_trapsfilled: True
      modify_input: False
    charge_migration:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      signal_threshold: 25000.0
    jump:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      rejection_threshold: 4.0
      three_group_rejection_threshold: 6.0
      four_group_rejection_threshold: 5.0
      maximum_cores: half
      flag_4_neighbors: True
      max_jump_to_flag_neighbors: 1000
      min_jump_to_flag_neighbors: 30
      after_jump_flag_dn1: 500
      after_jump_flag_time1: 15
      after_jump_flag_dn2: 1000
      after_jump_flag_time2: 3000
      expand_large_events: False
      min_sat_area: 1
      min_jump_area: 0
      expand_factor: 0
      use_ellipses: False
      sat_required_snowball: False
      min_sat_radius_extend: 0.0
      sat_expand: 0
      edge_size: 0
      mask_snowball_core_next_int: True
      snowball_time_masked_next_int: 4000
      find_showers: False
      max_shower_amplitude: 4.0
      extend_snr_threshold: 3.0
      extend_min_area: 50
      extend_inner_radius: 1
      extend_outer_radius: 2.6
      extend_ellipse_expand_ratio: 1.1
      time_masked_after_shower: 30
      min_diffs_single_pass: 10
      max_extended_radius: 200
      minimum_groups: 3
      minimum_sigclip_groups: 100
      only_use_ints: True
    clean_flicker_noise:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      fit_method: median
      fit_by_channel: False
      background_method: median
      background_box_size: None
      mask_science_regions: False
      apply_flat_field: False
      n_sigma: 2.0
      fit_histogram: False
      single_mask: True
      user_mask: None
      save_mask: False
      save_background: False
      save_noise: False
    ramp_fit:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: OLS_C
      int_name: &#39;&#39;
      save_opt: False
      opt_name: &#39;&#39;
      suppress_one_group: True
      firstgroup: None
      lastgroup: None
      maximum_cores: &#39;1&#39;
    gain_scale:
      pre_hooks: []
      post_hooks:
      - !!python/name:__main__.XplyStep &#39;&#39;
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,930 - stpipe.Detector1Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01386030001_02101_00001_mirimage_uncal.fits&#39; reftypes = [&#39;dark&#39;, &#39;emicorr&#39;, &#39;gain&#39;, &#39;linearity&#39;, &#39;mask&#39;, &#39;persat&#39;, &#39;readnoise&#39;, &#39;reset&#39;, &#39;rscd&#39;, &#39;saturation&#39;, &#39;superbias&#39;, &#39;trapdensity&#39;, &#39;trappars&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,932 - stpipe.Detector1Pipeline - INFO - Prefetch for DARK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,933 - stpipe.Detector1Pipeline - INFO - Prefetch for EMICORR reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,933 - stpipe.Detector1Pipeline - INFO - Prefetch for GAIN reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,934 - stpipe.Detector1Pipeline - INFO - Prefetch for LINEARITY reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,934 - stpipe.Detector1Pipeline - INFO - Prefetch for MASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,934 - stpipe.Detector1Pipeline - INFO - Prefetch for PERSAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,935 - stpipe.Detector1Pipeline - INFO - Prefetch for READNOISE reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,935 - stpipe.Detector1Pipeline - INFO - Prefetch for RESET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,935 - stpipe.Detector1Pipeline - INFO - Prefetch for RSCD reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,936 - stpipe.Detector1Pipeline - INFO - Prefetch for SATURATION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,936 - stpipe.Detector1Pipeline - INFO - Prefetch for SUPERBIAS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,937 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPDENSITY reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,937 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPPARS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:27,937 - jwst.pipeline.calwebb_detector1 - INFO - Starting calwebb_detector1 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:30,986 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:30,993 - stpipe.Detector1Pipeline.group_scale - INFO - NFRAMES and FRMDIVSR are equal; correction not needed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:30,994 - stpipe.Detector1Pipeline.group_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:30,995 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:31,147 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:31,156 - stpipe.Detector1Pipeline.dq_init - INFO - Using MASK reference file /home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:31,911 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:31,921 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:31,925 - jwst.dq_init.dq_initialization - INFO - Extracting mask subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:32,728 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:32,892 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:33,632 - stpipe.Detector1Pipeline.emicorr - INFO - Using CRDS reference file: /home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:33,649 - jwst.emicorr.emicorr - INFO - Using reference file to get subarray case.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:33,650 - jwst.emicorr.emicorr - INFO - With configuration: Subarray=MASK1550, Read_pattern=FASTR1, Detector=MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:33,650 - jwst.emicorr.emicorr - INFO - Will correct data for the following 2 frequencies: 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:33,650 - jwst.emicorr.emicorr - INFO -    [&#39;Hz390&#39;, &#39;Hz10&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:56:33,651 - jwst.emicorr.emicorr - INFO - Running EMI fit with algorithm = &#39;joint&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:57:45,477 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:57:45,642 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:57:45,652 - stpipe.Detector1Pipeline.saturation - INFO - Using SATURATION reference file /home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:57:45,653 - stpipe.Detector1Pipeline.saturation - INFO - Using SUPERBIAS reference file N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:57:45,674 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:57:45,683 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:57:46,417 - jwst.saturation.saturation - INFO - Extracting reference file subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:57:46,424 - jwst.saturation.saturation - INFO - Using read_pattern with nframes 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:57:53,522 - stcal.saturation.saturation - INFO - Detected 672 saturated pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:57:53,732 - stcal.saturation.saturation - INFO - Detected 4 A/D floor pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:57:53,736 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:57:53,896 - stpipe.Detector1Pipeline.ipc - INFO - Step ipc running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:57:53,897 - stpipe.Detector1Pipeline.ipc - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:57:54,034 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:57:54,771 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:57:54,936 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:57:55,675 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:57:55,833 - stpipe.Detector1Pipeline.reset - INFO - Step reset running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:57:55,842 - stpipe.Detector1Pipeline.reset - INFO - Using RESET reference file /home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:57:55,861 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:57:55,864 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:57:56,672 - stpipe.Detector1Pipeline.reset - INFO - Step reset done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:57:56,830 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:57:56,840 - stpipe.Detector1Pipeline.linearity - INFO - Using Linearity reference file /home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:57:56,862 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:57:56,872 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:03,056 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:03,216 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:03,225 - stpipe.Detector1Pipeline.rscd - INFO - Using RSCD reference file /home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:03,994 - jwst.rscd.rscd_sub - INFO - Number of groups to skip for integrations 2 and higher: 4
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:03,998 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:04,163 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:04,172 - stpipe.Detector1Pipeline.dark_current - INFO - Using DARK reference file /home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:05,031 - stdatamodels.dynamicdq - WARNING - Keyword UNDERSAMP does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:05,035 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:05,036 - stpipe.Detector1Pipeline.dark_current - INFO - Using Poisson noise from average dark current 1.0 e-/sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:05,037 - stcal.dark_current.dark_sub - INFO - Science data nints=60, ngroups=250, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:05,037 - stcal.dark_current.dark_sub - INFO - Dark data nints=3, ngroups=500, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:06,575 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:06,743 - stpipe.Detector1Pipeline.refpix - INFO - Step refpix running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:06,744 - stpipe.Detector1Pipeline.refpix - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:06,877 - stpipe.Detector1Pipeline.charge_migration - INFO - Step charge_migration running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:06,878 - stpipe.Detector1Pipeline.charge_migration - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:07,015 - stpipe.Detector1Pipeline.jump - INFO - Step jump running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:07,022 - stpipe.Detector1Pipeline.jump - INFO - CR rejection threshold = 4 sigma
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:07,022 - stpipe.Detector1Pipeline.jump - INFO - Maximum cores to use = half
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:07,752 - stpipe.Detector1Pipeline.jump - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:07,754 - stpipe.Detector1Pipeline.jump - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:07,779 - stpipe.Detector1Pipeline.jump - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:07,784 - stpipe.Detector1Pipeline.jump - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:08,944 - stcal.jump.jump - INFO - Executing two-point difference method
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:08,945 - stcal.jump.jump - INFO - Creating 4 processes for jump detection 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:37,514 - stcal.jump.jump - INFO - Total elapsed time = 28.5693 sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:38,555 - stpipe.Detector1Pipeline.jump - INFO - The execution time in seconds: 31.532947
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:38,558 - stpipe.Detector1Pipeline.jump - INFO - Step jump done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:38,715 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step clean_flicker_noise running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:38,716 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:38,852 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:39,596 - jwst.ramp_fitting.ramp_fit_step - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:39,597 - jwst.ramp_fitting.ramp_fit_step - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:39,621 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:39,626 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:39,632 - jwst.ramp_fitting.ramp_fit_step - INFO - Using algorithm = OLS_C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:39,632 - jwst.ramp_fitting.ramp_fit_step - INFO - Using weighting = optimal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:42,083 - stcal.ramp_fitting.ols_fit - INFO - Number of multiprocessing slices: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:42,098 - stcal.ramp_fitting.ols_fit - INFO - Number of leading groups that are flagged as DO_NOT_USE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 16:58:42,099 - stcal.ramp_fitting.ols_fit - INFO - MIRI dataset has all pixels in the final group flagged as DO_NOT_USE.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:23,792 - stcal.ramp_fitting.ols_fit - INFO - Ramp Fitting C Time: 101.69232702255249
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:23,853 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,015 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;ImageModel(224, 288) from jw01386030001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,036 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,037 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,179 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;ImageModel(224, 288) from jw01386030001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,193 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,194 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,196 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,333 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;CubeModel(60, 224, 288) from jw01386030001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,355 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,355 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,495 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;CubeModel(60, 224, 288) from jw01386030001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,524 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,526 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,528 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,640 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs030/stage1/jw01386030001_02101_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,640 - jwst.pipeline.calwebb_detector1 - INFO - ... ending calwebb_detector1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,641 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,691 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs030/stage1/jw01386030001_02101_00001_mirimage_rate.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,691 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,692 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,716 - stpipe - INFO - PARS-EMICORRSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-emicorrstep_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,731 - stpipe - INFO - PARS-DARKCURRENTSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-darkcurrentstep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,740 - stpipe - INFO - PARS-JUMPSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-jumpstep_0004.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,751 - stpipe - INFO - PARS-DETECTOR1PIPELINE parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-detector1pipeline_0008.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,767 - stpipe.Detector1Pipeline - INFO - Detector1Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,768 - stpipe.Detector1Pipeline.group_scale - INFO - GroupScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,769 - stpipe.Detector1Pipeline.dq_init - INFO - DQInitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,770 - stpipe.Detector1Pipeline.emicorr - INFO - EmiCorrStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,770 - stpipe.Detector1Pipeline.saturation - INFO - SaturationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,771 - stpipe.Detector1Pipeline.ipc - INFO - IPCStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,772 - stpipe.Detector1Pipeline.superbias - INFO - SuperBiasStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,773 - stpipe.Detector1Pipeline.refpix - INFO - RefPixStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,773 - stpipe.Detector1Pipeline.rscd - INFO - RscdStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,774 - stpipe.Detector1Pipeline.firstframe - INFO - FirstFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,775 - stpipe.Detector1Pipeline.lastframe - INFO - LastFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,775 - stpipe.Detector1Pipeline.linearity - INFO - LinearityStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,776 - stpipe.Detector1Pipeline.dark_current - INFO - DarkCurrentStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,777 - stpipe.Detector1Pipeline.reset - INFO - ResetStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,778 - stpipe.Detector1Pipeline.persistence - INFO - PersistenceStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,778 - stpipe.Detector1Pipeline.charge_migration - INFO - ChargeMigrationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,780 - stpipe.Detector1Pipeline.jump - INFO - JumpStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,781 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - CleanFlickerNoiseStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,782 - stpipe.Detector1Pipeline.ramp_fit - INFO - RampFitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,782 - stpipe.Detector1Pipeline.gain_scale - INFO - GainScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,783 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - XplyStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,929 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline running with args (np.str_(&#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs030/uncal/jw01386030001_03101_00001_mirimage_uncal.fits&#39;),).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,950 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./miri_coro_demo_data/Obs030/stage1
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_calibrated_ramp: False
  steps:
    group_scale:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dq_init:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    emicorr:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: joint
      nints_to_phase: None
      nbins: None
      scale_reference: True
      onthefly_corr_freq: None
      use_n_cycles: 3
      fit_ints_separately: False
      user_supplied_reffile: None
      save_intermediate_results: False
    saturation:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      n_pix_grow_sat: 1
      use_readpatt: True
    ipc:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    superbias:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    refpix:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      odd_even_columns: True
      use_side_ref_pixels: True
      side_smoothing_length: 11
      side_gain: 1.0
      odd_even_rows: True
      ovr_corr_mitigation_ftr: 3.0
      preserve_irs2_refpix: False
      irs2_mean_subtraction: False
      refpix_algorithm: median
      sigreject: 4.0
      gaussmooth: 1.0
      halfwidth: 30
    rscd:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    firstframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bright_use_group1: False
    lastframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    linearity:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dark_current:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      dark_output: None
      average_dark_current: 1.0
    reset:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    persistence:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      input_trapsfilled: &#39;&#39;
      flag_pers_cutoff: 40.0
      save_persistence: False
      save_trapsfilled: True
      modify_input: False
    charge_migration:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      signal_threshold: 25000.0
    jump:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      rejection_threshold: 4.0
      three_group_rejection_threshold: 6.0
      four_group_rejection_threshold: 5.0
      maximum_cores: half
      flag_4_neighbors: True
      max_jump_to_flag_neighbors: 1000
      min_jump_to_flag_neighbors: 30
      after_jump_flag_dn1: 500
      after_jump_flag_time1: 15
      after_jump_flag_dn2: 1000
      after_jump_flag_time2: 3000
      expand_large_events: False
      min_sat_area: 1
      min_jump_area: 0
      expand_factor: 0
      use_ellipses: False
      sat_required_snowball: False
      min_sat_radius_extend: 0.0
      sat_expand: 0
      edge_size: 0
      mask_snowball_core_next_int: True
      snowball_time_masked_next_int: 4000
      find_showers: False
      max_shower_amplitude: 4.0
      extend_snr_threshold: 3.0
      extend_min_area: 50
      extend_inner_radius: 1
      extend_outer_radius: 2.6
      extend_ellipse_expand_ratio: 1.1
      time_masked_after_shower: 30
      min_diffs_single_pass: 10
      max_extended_radius: 200
      minimum_groups: 3
      minimum_sigclip_groups: 100
      only_use_ints: True
    clean_flicker_noise:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      fit_method: median
      fit_by_channel: False
      background_method: median
      background_box_size: None
      mask_science_regions: False
      apply_flat_field: False
      n_sigma: 2.0
      fit_histogram: False
      single_mask: True
      user_mask: None
      save_mask: False
      save_background: False
      save_noise: False
    ramp_fit:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: OLS_C
      int_name: &#39;&#39;
      save_opt: False
      opt_name: &#39;&#39;
      suppress_one_group: True
      firstgroup: None
      lastgroup: None
      maximum_cores: &#39;1&#39;
    gain_scale:
      pre_hooks: []
      post_hooks:
      - !!python/name:__main__.XplyStep &#39;&#39;
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,970 - stpipe.Detector1Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01386030001_03101_00001_mirimage_uncal.fits&#39; reftypes = [&#39;dark&#39;, &#39;emicorr&#39;, &#39;gain&#39;, &#39;linearity&#39;, &#39;mask&#39;, &#39;persat&#39;, &#39;readnoise&#39;, &#39;reset&#39;, &#39;rscd&#39;, &#39;saturation&#39;, &#39;superbias&#39;, &#39;trapdensity&#39;, &#39;trappars&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,973 - stpipe.Detector1Pipeline - INFO - Prefetch for DARK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,973 - stpipe.Detector1Pipeline - INFO - Prefetch for EMICORR reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,974 - stpipe.Detector1Pipeline - INFO - Prefetch for GAIN reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,974 - stpipe.Detector1Pipeline - INFO - Prefetch for LINEARITY reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,974 - stpipe.Detector1Pipeline - INFO - Prefetch for MASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,975 - stpipe.Detector1Pipeline - INFO - Prefetch for PERSAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,975 - stpipe.Detector1Pipeline - INFO - Prefetch for READNOISE reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,975 - stpipe.Detector1Pipeline - INFO - Prefetch for RESET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,975 - stpipe.Detector1Pipeline - INFO - Prefetch for RSCD reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,976 - stpipe.Detector1Pipeline - INFO - Prefetch for SATURATION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,976 - stpipe.Detector1Pipeline - INFO - Prefetch for SUPERBIAS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,976 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPDENSITY reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,976 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPPARS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:24,977 - jwst.pipeline.calwebb_detector1 - INFO - Starting calwebb_detector1 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:29,221 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:29,228 - stpipe.Detector1Pipeline.group_scale - INFO - NFRAMES and FRMDIVSR are equal; correction not needed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:29,229 - stpipe.Detector1Pipeline.group_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:29,230 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:29,377 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:29,386 - stpipe.Detector1Pipeline.dq_init - INFO - Using MASK reference file /home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:30,143 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:30,154 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:30,158 - jwst.dq_init.dq_initialization - INFO - Extracting mask subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:30,958 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:31,119 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:31,862 - stpipe.Detector1Pipeline.emicorr - INFO - Using CRDS reference file: /home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:31,879 - jwst.emicorr.emicorr - INFO - Using reference file to get subarray case.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:31,879 - jwst.emicorr.emicorr - INFO - With configuration: Subarray=MASK1550, Read_pattern=FASTR1, Detector=MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:31,880 - jwst.emicorr.emicorr - INFO - Will correct data for the following 2 frequencies: 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:31,880 - jwst.emicorr.emicorr - INFO -    [&#39;Hz390&#39;, &#39;Hz10&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:00:31,881 - jwst.emicorr.emicorr - INFO - Running EMI fit with algorithm = &#39;joint&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:01:44,461 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:01:44,620 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:01:44,630 - stpipe.Detector1Pipeline.saturation - INFO - Using SATURATION reference file /home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:01:44,630 - stpipe.Detector1Pipeline.saturation - INFO - Using SUPERBIAS reference file N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:01:44,651 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:01:44,660 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:01:45,397 - jwst.saturation.saturation - INFO - Extracting reference file subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:01:45,403 - jwst.saturation.saturation - INFO - Using read_pattern with nframes 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:01:52,568 - stcal.saturation.saturation - INFO - Detected 672 saturated pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:01:52,775 - stcal.saturation.saturation - INFO - Detected 2 A/D floor pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:01:52,779 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:01:52,944 - stpipe.Detector1Pipeline.ipc - INFO - Step ipc running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:01:52,945 - stpipe.Detector1Pipeline.ipc - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:01:53,080 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:01:53,826 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:01:53,991 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:01:54,733 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:01:54,896 - stpipe.Detector1Pipeline.reset - INFO - Step reset running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:01:54,905 - stpipe.Detector1Pipeline.reset - INFO - Using RESET reference file /home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:01:54,925 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:01:54,927 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:01:55,742 - stpipe.Detector1Pipeline.reset - INFO - Step reset done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:01:55,902 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:01:55,911 - stpipe.Detector1Pipeline.linearity - INFO - Using Linearity reference file /home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:01:55,934 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:01:55,943 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:02,122 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:02,282 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:02,291 - stpipe.Detector1Pipeline.rscd - INFO - Using RSCD reference file /home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:03,055 - jwst.rscd.rscd_sub - INFO - Number of groups to skip for integrations 2 and higher: 4
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:03,060 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:03,223 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:03,232 - stpipe.Detector1Pipeline.dark_current - INFO - Using DARK reference file /home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:04,099 - stdatamodels.dynamicdq - WARNING - Keyword UNDERSAMP does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:04,102 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:04,104 - stpipe.Detector1Pipeline.dark_current - INFO - Using Poisson noise from average dark current 1.0 e-/sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:04,104 - stcal.dark_current.dark_sub - INFO - Science data nints=60, ngroups=250, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:04,105 - stcal.dark_current.dark_sub - INFO - Dark data nints=3, ngroups=500, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:05,632 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:05,796 - stpipe.Detector1Pipeline.refpix - INFO - Step refpix running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:05,797 - stpipe.Detector1Pipeline.refpix - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:05,934 - stpipe.Detector1Pipeline.charge_migration - INFO - Step charge_migration running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:05,935 - stpipe.Detector1Pipeline.charge_migration - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:06,069 - stpipe.Detector1Pipeline.jump - INFO - Step jump running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:06,076 - stpipe.Detector1Pipeline.jump - INFO - CR rejection threshold = 4 sigma
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:06,077 - stpipe.Detector1Pipeline.jump - INFO - Maximum cores to use = half
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:06,808 - stpipe.Detector1Pipeline.jump - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:06,810 - stpipe.Detector1Pipeline.jump - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:06,835 - stpipe.Detector1Pipeline.jump - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:06,840 - stpipe.Detector1Pipeline.jump - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:08,003 - stcal.jump.jump - INFO - Executing two-point difference method
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:08,004 - stcal.jump.jump - INFO - Creating 4 processes for jump detection 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:36,596 - stcal.jump.jump - INFO - Total elapsed time = 28.5922 sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:37,642 - stpipe.Detector1Pipeline.jump - INFO - The execution time in seconds: 31.565474
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:37,645 - stpipe.Detector1Pipeline.jump - INFO - Step jump done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:37,807 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step clean_flicker_noise running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:37,807 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:37,944 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit running with args (&lt;RampModel(60, 250, 224, 288) from jw01386030001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:38,695 - jwst.ramp_fitting.ramp_fit_step - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:38,695 - jwst.ramp_fitting.ramp_fit_step - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:38,720 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:38,725 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:38,730 - jwst.ramp_fitting.ramp_fit_step - INFO - Using algorithm = OLS_C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:38,731 - jwst.ramp_fitting.ramp_fit_step - INFO - Using weighting = optimal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:41,196 - stcal.ramp_fitting.ols_fit - INFO - Number of multiprocessing slices: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:41,211 - stcal.ramp_fitting.ols_fit - INFO - Number of leading groups that are flagged as DO_NOT_USE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:02:41,212 - stcal.ramp_fitting.ols_fit - INFO - MIRI dataset has all pixels in the final group flagged as DO_NOT_USE.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:23,667 - stcal.ramp_fitting.ols_fit - INFO - Ramp Fitting C Time: 102.45386862754822
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:23,728 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:23,892 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;ImageModel(224, 288) from jw01386030001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:23,913 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:23,914 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,052 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;ImageModel(224, 288) from jw01386030001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,066 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,067 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,069 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,209 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;CubeModel(60, 224, 288) from jw01386030001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,231 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,232 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,368 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;CubeModel(60, 224, 288) from jw01386030001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,397 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,398 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,400 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,510 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs030/stage1/jw01386030001_03101_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,510 - jwst.pipeline.calwebb_detector1 - INFO - ... ending calwebb_detector1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,511 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,561 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs030/stage1/jw01386030001_03101_00001_mirimage_rate.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,561 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,562 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,585 - stpipe - INFO - PARS-EMICORRSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-emicorrstep_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,599 - stpipe - INFO - PARS-DARKCURRENTSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-darkcurrentstep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,609 - stpipe - INFO - PARS-JUMPSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-jumpstep_0004.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,620 - stpipe - INFO - PARS-DETECTOR1PIPELINE parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-detector1pipeline_0008.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,635 - stpipe.Detector1Pipeline - INFO - Detector1Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,636 - stpipe.Detector1Pipeline.group_scale - INFO - GroupScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,637 - stpipe.Detector1Pipeline.dq_init - INFO - DQInitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,638 - stpipe.Detector1Pipeline.emicorr - INFO - EmiCorrStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,638 - stpipe.Detector1Pipeline.saturation - INFO - SaturationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,639 - stpipe.Detector1Pipeline.ipc - INFO - IPCStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,640 - stpipe.Detector1Pipeline.superbias - INFO - SuperBiasStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,641 - stpipe.Detector1Pipeline.refpix - INFO - RefPixStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,641 - stpipe.Detector1Pipeline.rscd - INFO - RscdStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,642 - stpipe.Detector1Pipeline.firstframe - INFO - FirstFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,643 - stpipe.Detector1Pipeline.lastframe - INFO - LastFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,643 - stpipe.Detector1Pipeline.linearity - INFO - LinearityStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,644 - stpipe.Detector1Pipeline.dark_current - INFO - DarkCurrentStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,645 - stpipe.Detector1Pipeline.reset - INFO - ResetStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,646 - stpipe.Detector1Pipeline.persistence - INFO - PersistenceStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,646 - stpipe.Detector1Pipeline.charge_migration - INFO - ChargeMigrationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,648 - stpipe.Detector1Pipeline.jump - INFO - JumpStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,649 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - CleanFlickerNoiseStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,650 - stpipe.Detector1Pipeline.ramp_fit - INFO - RampFitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,650 - stpipe.Detector1Pipeline.gain_scale - INFO - GainScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,651 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - XplyStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,795 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline running with args (np.str_(&#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/uncal/jw01386031001_02101_00001_mirimage_uncal.fits&#39;),).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,816 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./miri_coro_demo_data/Obs031/stage1
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_calibrated_ramp: False
  steps:
    group_scale:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dq_init:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    emicorr:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: joint
      nints_to_phase: None
      nbins: None
      scale_reference: True
      onthefly_corr_freq: None
      use_n_cycles: 3
      fit_ints_separately: False
      user_supplied_reffile: None
      save_intermediate_results: False
    saturation:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      n_pix_grow_sat: 1
      use_readpatt: True
    ipc:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    superbias:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    refpix:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      odd_even_columns: True
      use_side_ref_pixels: True
      side_smoothing_length: 11
      side_gain: 1.0
      odd_even_rows: True
      ovr_corr_mitigation_ftr: 3.0
      preserve_irs2_refpix: False
      irs2_mean_subtraction: False
      refpix_algorithm: median
      sigreject: 4.0
      gaussmooth: 1.0
      halfwidth: 30
    rscd:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    firstframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bright_use_group1: False
    lastframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    linearity:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dark_current:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      dark_output: None
      average_dark_current: 1.0
    reset:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    persistence:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      input_trapsfilled: &#39;&#39;
      flag_pers_cutoff: 40.0
      save_persistence: False
      save_trapsfilled: True
      modify_input: False
    charge_migration:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      signal_threshold: 25000.0
    jump:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      rejection_threshold: 4.0
      three_group_rejection_threshold: 6.0
      four_group_rejection_threshold: 5.0
      maximum_cores: half
      flag_4_neighbors: True
      max_jump_to_flag_neighbors: 1000
      min_jump_to_flag_neighbors: 30
      after_jump_flag_dn1: 500
      after_jump_flag_time1: 15
      after_jump_flag_dn2: 1000
      after_jump_flag_time2: 3000
      expand_large_events: False
      min_sat_area: 1
      min_jump_area: 0
      expand_factor: 0
      use_ellipses: False
      sat_required_snowball: False
      min_sat_radius_extend: 0.0
      sat_expand: 0
      edge_size: 0
      mask_snowball_core_next_int: True
      snowball_time_masked_next_int: 4000
      find_showers: False
      max_shower_amplitude: 4.0
      extend_snr_threshold: 3.0
      extend_min_area: 50
      extend_inner_radius: 1
      extend_outer_radius: 2.6
      extend_ellipse_expand_ratio: 1.1
      time_masked_after_shower: 30
      min_diffs_single_pass: 10
      max_extended_radius: 200
      minimum_groups: 3
      minimum_sigclip_groups: 100
      only_use_ints: True
    clean_flicker_noise:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      fit_method: median
      fit_by_channel: False
      background_method: median
      background_box_size: None
      mask_science_regions: False
      apply_flat_field: False
      n_sigma: 2.0
      fit_histogram: False
      single_mask: True
      user_mask: None
      save_mask: False
      save_background: False
      save_noise: False
    ramp_fit:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: OLS_C
      int_name: &#39;&#39;
      save_opt: False
      opt_name: &#39;&#39;
      suppress_one_group: True
      firstgroup: None
      lastgroup: None
      maximum_cores: &#39;1&#39;
    gain_scale:
      pre_hooks: []
      post_hooks:
      - !!python/name:__main__.XplyStep &#39;&#39;
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,836 - stpipe.Detector1Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01386031001_02101_00001_mirimage_uncal.fits&#39; reftypes = [&#39;dark&#39;, &#39;emicorr&#39;, &#39;gain&#39;, &#39;linearity&#39;, &#39;mask&#39;, &#39;persat&#39;, &#39;readnoise&#39;, &#39;reset&#39;, &#39;rscd&#39;, &#39;saturation&#39;, &#39;superbias&#39;, &#39;trapdensity&#39;, &#39;trappars&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,839 - stpipe.Detector1Pipeline - INFO - Prefetch for DARK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,840 - stpipe.Detector1Pipeline - INFO - Prefetch for EMICORR reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,840 - stpipe.Detector1Pipeline - INFO - Prefetch for GAIN reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,840 - stpipe.Detector1Pipeline - INFO - Prefetch for LINEARITY reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,841 - stpipe.Detector1Pipeline - INFO - Prefetch for MASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,841 - stpipe.Detector1Pipeline - INFO - Prefetch for PERSAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,841 - stpipe.Detector1Pipeline - INFO - Prefetch for READNOISE reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,842 - stpipe.Detector1Pipeline - INFO - Prefetch for RESET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,842 - stpipe.Detector1Pipeline - INFO - Prefetch for RSCD reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,843 - stpipe.Detector1Pipeline - INFO - Prefetch for SATURATION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,843 - stpipe.Detector1Pipeline - INFO - Prefetch for SUPERBIAS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,843 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPDENSITY reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,844 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPPARS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:24,844 - jwst.pipeline.calwebb_detector1 - INFO - Starting calwebb_detector1 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:25,432 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:25,439 - stpipe.Detector1Pipeline.group_scale - INFO - NFRAMES and FRMDIVSR are equal; correction not needed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:25,439 - stpipe.Detector1Pipeline.group_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:25,441 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:25,583 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:25,591 - stpipe.Detector1Pipeline.dq_init - INFO - Using MASK reference file /home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:25,717 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:25,728 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:25,732 - jwst.dq_init.dq_initialization - INFO - Extracting mask subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:25,842 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:25,983 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:26,094 - stpipe.Detector1Pipeline.emicorr - INFO - Using CRDS reference file: /home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:26,110 - jwst.emicorr.emicorr - INFO - Using reference file to get subarray case.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:26,111 - jwst.emicorr.emicorr - INFO - With configuration: Subarray=MASK1550, Read_pattern=FASTR1, Detector=MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:26,111 - jwst.emicorr.emicorr - INFO - Will correct data for the following 2 frequencies: 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:26,112 - jwst.emicorr.emicorr - INFO -    [&#39;Hz390&#39;, &#39;Hz10&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:26,112 - jwst.emicorr.emicorr - INFO - Running EMI fit with algorithm = &#39;joint&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:38,301 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:38,443 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:38,453 - stpipe.Detector1Pipeline.saturation - INFO - Using SATURATION reference file /home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:38,453 - stpipe.Detector1Pipeline.saturation - INFO - Using SUPERBIAS reference file N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:38,474 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:38,483 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:38,588 - jwst.saturation.saturation - INFO - Extracting reference file subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:38,595 - jwst.saturation.saturation - INFO - Using read_pattern with nframes 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:39,530 - stcal.saturation.saturation - INFO - Detected 672 saturated pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:39,558 - stcal.saturation.saturation - INFO - Detected 1 A/D floor pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:39,561 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:39,701 - stpipe.Detector1Pipeline.ipc - INFO - Step ipc running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:39,702 - stpipe.Detector1Pipeline.ipc - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:39,838 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:39,948 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:40,094 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:40,205 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:40,347 - stpipe.Detector1Pipeline.reset - INFO - Step reset running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:40,356 - stpipe.Detector1Pipeline.reset - INFO - Using RESET reference file /home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:40,375 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:40,378 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:40,507 - stpipe.Detector1Pipeline.reset - INFO - Step reset done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:40,647 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:40,657 - stpipe.Detector1Pipeline.linearity - INFO - Using Linearity reference file /home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:40,679 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:40,688 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:41,494 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:41,641 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:41,650 - stpipe.Detector1Pipeline.rscd - INFO - Using RSCD reference file /home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:41,781 - jwst.rscd.rscd_sub - INFO - Number of groups to skip for integrations 2 and higher: 4
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:41,785 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:41,925 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:41,935 - stpipe.Detector1Pipeline.dark_current - INFO - Using DARK reference file /home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:42,169 - stdatamodels.dynamicdq - WARNING - Keyword UNDERSAMP does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:42,173 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:42,174 - stpipe.Detector1Pipeline.dark_current - INFO - Using Poisson noise from average dark current 1.0 e-/sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:42,175 - stcal.dark_current.dark_sub - INFO - Science data nints=19, ngroups=100, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:42,175 - stcal.dark_current.dark_sub - INFO - Dark data nints=3, ngroups=500, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:42,444 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:42,592 - stpipe.Detector1Pipeline.refpix - INFO - Step refpix running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:42,593 - stpipe.Detector1Pipeline.refpix - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:42,728 - stpipe.Detector1Pipeline.charge_migration - INFO - Step charge_migration running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:42,728 - stpipe.Detector1Pipeline.charge_migration - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:42,863 - stpipe.Detector1Pipeline.jump - INFO - Step jump running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:42,871 - stpipe.Detector1Pipeline.jump - INFO - CR rejection threshold = 4 sigma
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:42,871 - stpipe.Detector1Pipeline.jump - INFO - Maximum cores to use = half
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:42,973 - stpipe.Detector1Pipeline.jump - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:42,976 - stpipe.Detector1Pipeline.jump - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:43,000 - stpipe.Detector1Pipeline.jump - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:43,005 - stpipe.Detector1Pipeline.jump - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:43,159 - stcal.jump.jump - INFO - Executing two-point difference method
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:43,159 - stcal.jump.jump - INFO - Creating 4 processes for jump detection 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:47,482 - stcal.jump.jump - INFO - Total elapsed time = 4.32308 sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:47,617 - stpipe.Detector1Pipeline.jump - INFO - The execution time in seconds: 4.746555
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:47,621 - stpipe.Detector1Pipeline.jump - INFO - Step jump done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:47,764 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step clean_flicker_noise running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:47,765 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:47,902 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:48,016 - jwst.ramp_fitting.ramp_fit_step - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:48,017 - jwst.ramp_fitting.ramp_fit_step - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:48,041 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:48,046 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:48,051 - jwst.ramp_fitting.ramp_fit_step - INFO - Using algorithm = OLS_C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:48,052 - jwst.ramp_fitting.ramp_fit_step - INFO - Using weighting = optimal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:48,357 - stcal.ramp_fitting.ols_fit - INFO - Number of multiprocessing slices: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:48,363 - stcal.ramp_fitting.ols_fit - INFO - Number of leading groups that are flagged as DO_NOT_USE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:48,363 - stcal.ramp_fitting.ols_fit - INFO - MIRI dataset has all pixels in the final group flagged as DO_NOT_USE.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:58,860 - stcal.ramp_fitting.ols_fit - INFO - Ramp Fitting C Time: 10.495553016662598
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:58,902 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,048 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;ImageModel(224, 288) from jw01386031001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,069 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,069 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,208 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;ImageModel(224, 288) from jw01386031001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,222 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,224 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,225 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,363 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;CubeModel(19, 224, 288) from jw01386031001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,384 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,385 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,522 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;CubeModel(19, 224, 288) from jw01386031001_02101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,541 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,542 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,544 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,613 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs031/stage1/jw01386031001_02101_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,614 - jwst.pipeline.calwebb_detector1 - INFO - ... ending calwebb_detector1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,615 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,664 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs031/stage1/jw01386031001_02101_00001_mirimage_rate.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,665 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,665 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,688 - stpipe - INFO - PARS-EMICORRSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-emicorrstep_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,702 - stpipe - INFO - PARS-DARKCURRENTSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-darkcurrentstep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,712 - stpipe - INFO - PARS-JUMPSTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-jumpstep_0004.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,723 - stpipe - INFO - PARS-DETECTOR1PIPELINE parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-detector1pipeline_0008.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,738 - stpipe.Detector1Pipeline - INFO - Detector1Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,739 - stpipe.Detector1Pipeline.group_scale - INFO - GroupScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,740 - stpipe.Detector1Pipeline.dq_init - INFO - DQInitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,741 - stpipe.Detector1Pipeline.emicorr - INFO - EmiCorrStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,741 - stpipe.Detector1Pipeline.saturation - INFO - SaturationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,742 - stpipe.Detector1Pipeline.ipc - INFO - IPCStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,743 - stpipe.Detector1Pipeline.superbias - INFO - SuperBiasStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,744 - stpipe.Detector1Pipeline.refpix - INFO - RefPixStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,744 - stpipe.Detector1Pipeline.rscd - INFO - RscdStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,745 - stpipe.Detector1Pipeline.firstframe - INFO - FirstFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,746 - stpipe.Detector1Pipeline.lastframe - INFO - LastFrameStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,746 - stpipe.Detector1Pipeline.linearity - INFO - LinearityStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,747 - stpipe.Detector1Pipeline.dark_current - INFO - DarkCurrentStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,748 - stpipe.Detector1Pipeline.reset - INFO - ResetStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,749 - stpipe.Detector1Pipeline.persistence - INFO - PersistenceStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,749 - stpipe.Detector1Pipeline.charge_migration - INFO - ChargeMigrationStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,751 - stpipe.Detector1Pipeline.jump - INFO - JumpStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,752 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - CleanFlickerNoiseStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,752 - stpipe.Detector1Pipeline.ramp_fit - INFO - RampFitStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,753 - stpipe.Detector1Pipeline.gain_scale - INFO - GainScaleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,754 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - XplyStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,894 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline running with args (np.str_(&#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/uncal/jw01386031001_03101_00001_mirimage_uncal.fits&#39;),).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,915 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./miri_coro_demo_data/Obs031/stage1
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_calibrated_ramp: False
  steps:
    group_scale:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dq_init:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    emicorr:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: joint
      nints_to_phase: None
      nbins: None
      scale_reference: True
      onthefly_corr_freq: None
      use_n_cycles: 3
      fit_ints_separately: False
      user_supplied_reffile: None
      save_intermediate_results: False
    saturation:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      n_pix_grow_sat: 1
      use_readpatt: True
    ipc:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    superbias:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    refpix:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      odd_even_columns: True
      use_side_ref_pixels: True
      side_smoothing_length: 11
      side_gain: 1.0
      odd_even_rows: True
      ovr_corr_mitigation_ftr: 3.0
      preserve_irs2_refpix: False
      irs2_mean_subtraction: False
      refpix_algorithm: median
      sigreject: 4.0
      gaussmooth: 1.0
      halfwidth: 30
    rscd:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    firstframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bright_use_group1: False
    lastframe:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    linearity:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    dark_current:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      dark_output: None
      average_dark_current: 1.0
    reset:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    persistence:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      input_trapsfilled: &#39;&#39;
      flag_pers_cutoff: 40.0
      save_persistence: False
      save_trapsfilled: True
      modify_input: False
    charge_migration:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      signal_threshold: 25000.0
    jump:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      rejection_threshold: 4.0
      three_group_rejection_threshold: 6.0
      four_group_rejection_threshold: 5.0
      maximum_cores: half
      flag_4_neighbors: True
      max_jump_to_flag_neighbors: 1000
      min_jump_to_flag_neighbors: 30
      after_jump_flag_dn1: 500
      after_jump_flag_time1: 15
      after_jump_flag_dn2: 1000
      after_jump_flag_time2: 3000
      expand_large_events: False
      min_sat_area: 1
      min_jump_area: 0
      expand_factor: 0
      use_ellipses: False
      sat_required_snowball: False
      min_sat_radius_extend: 0.0
      sat_expand: 0
      edge_size: 0
      mask_snowball_core_next_int: True
      snowball_time_masked_next_int: 4000
      find_showers: False
      max_shower_amplitude: 4.0
      extend_snr_threshold: 3.0
      extend_min_area: 50
      extend_inner_radius: 1
      extend_outer_radius: 2.6
      extend_ellipse_expand_ratio: 1.1
      time_masked_after_shower: 30
      min_diffs_single_pass: 10
      max_extended_radius: 200
      minimum_groups: 3
      minimum_sigclip_groups: 100
      only_use_ints: True
    clean_flicker_noise:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: True
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      fit_method: median
      fit_by_channel: False
      background_method: median
      background_box_size: None
      mask_science_regions: False
      apply_flat_field: False
      n_sigma: 2.0
      fit_histogram: False
      single_mask: True
      user_mask: None
      save_mask: False
      save_background: False
      save_noise: False
    ramp_fit:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      algorithm: OLS_C
      int_name: &#39;&#39;
      save_opt: False
      opt_name: &#39;&#39;
      suppress_one_group: True
      firstgroup: None
      lastgroup: None
      maximum_cores: &#39;1&#39;
    gain_scale:
      pre_hooks: []
      post_hooks:
      - !!python/name:__main__.XplyStep &#39;&#39;
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,935 - stpipe.Detector1Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01386031001_03101_00001_mirimage_uncal.fits&#39; reftypes = [&#39;dark&#39;, &#39;emicorr&#39;, &#39;gain&#39;, &#39;linearity&#39;, &#39;mask&#39;, &#39;persat&#39;, &#39;readnoise&#39;, &#39;reset&#39;, &#39;rscd&#39;, &#39;saturation&#39;, &#39;superbias&#39;, &#39;trapdensity&#39;, &#39;trappars&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,937 - stpipe.Detector1Pipeline - INFO - Prefetch for DARK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,938 - stpipe.Detector1Pipeline - INFO - Prefetch for EMICORR reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,938 - stpipe.Detector1Pipeline - INFO - Prefetch for GAIN reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,938 - stpipe.Detector1Pipeline - INFO - Prefetch for LINEARITY reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,939 - stpipe.Detector1Pipeline - INFO - Prefetch for MASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,939 - stpipe.Detector1Pipeline - INFO - Prefetch for PERSAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,940 - stpipe.Detector1Pipeline - INFO - Prefetch for READNOISE reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,940 - stpipe.Detector1Pipeline - INFO - Prefetch for RESET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,941 - stpipe.Detector1Pipeline - INFO - Prefetch for RSCD reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,941 - stpipe.Detector1Pipeline - INFO - Prefetch for SATURATION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,941 - stpipe.Detector1Pipeline - INFO - Prefetch for SUPERBIAS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,941 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPDENSITY reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,942 - stpipe.Detector1Pipeline - INFO - Prefetch for TRAPPARS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:04:59,942 - jwst.pipeline.calwebb_detector1 - INFO - Starting calwebb_detector1 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:00,521 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:00,528 - stpipe.Detector1Pipeline.group_scale - INFO - NFRAMES and FRMDIVSR are equal; correction not needed
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:00,529 - stpipe.Detector1Pipeline.group_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:00,530 - stpipe.Detector1Pipeline.group_scale - INFO - Step group_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:00,672 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:00,681 - stpipe.Detector1Pipeline.dq_init - INFO - Using MASK reference file /home/runner/crds/references/jwst/miri/jwst_miri_mask_0036.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:00,805 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:00,816 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:00,820 - jwst.dq_init.dq_initialization - INFO - Extracting mask subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:00,931 - stpipe.Detector1Pipeline.dq_init - INFO - Step dq_init done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:01,074 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:01,187 - stpipe.Detector1Pipeline.emicorr - INFO - Using CRDS reference file: /home/runner/crds/references/jwst/miri/jwst_miri_emicorr_0003.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:01,204 - jwst.emicorr.emicorr - INFO - Using reference file to get subarray case.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:01,204 - jwst.emicorr.emicorr - INFO - With configuration: Subarray=MASK1550, Read_pattern=FASTR1, Detector=MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:01,205 - jwst.emicorr.emicorr - INFO - Will correct data for the following 2 frequencies: 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:01,205 - jwst.emicorr.emicorr - INFO -    [&#39;Hz390&#39;, &#39;Hz10&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:01,205 - jwst.emicorr.emicorr - INFO - Running EMI fit with algorithm = &#39;joint&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:13,213 - stpipe.Detector1Pipeline.emicorr - INFO - Step emicorr done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:13,359 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:13,369 - stpipe.Detector1Pipeline.saturation - INFO - Using SATURATION reference file /home/runner/crds/references/jwst/miri/jwst_miri_saturation_0034.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:13,369 - stpipe.Detector1Pipeline.saturation - INFO - Using SUPERBIAS reference file N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:13,390 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:13,399 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:13,504 - jwst.saturation.saturation - INFO - Extracting reference file subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:13,511 - jwst.saturation.saturation - INFO - Using read_pattern with nframes 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:14,430 - stcal.saturation.saturation - INFO - Detected 669 saturated pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:14,457 - stcal.saturation.saturation - INFO - Detected 2 A/D floor pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:14,461 - stpipe.Detector1Pipeline.saturation - INFO - Step saturation done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:14,603 - stpipe.Detector1Pipeline.ipc - INFO - Step ipc running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:14,603 - stpipe.Detector1Pipeline.ipc - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:14,742 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:14,852 - stpipe.Detector1Pipeline.firstframe - INFO - Step firstframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:14,997 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:15,108 - stpipe.Detector1Pipeline.lastframe - INFO - Step lastframe done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:15,252 - stpipe.Detector1Pipeline.reset - INFO - Step reset running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:15,261 - stpipe.Detector1Pipeline.reset - INFO - Using RESET reference file /home/runner/crds/references/jwst/miri/jwst_miri_reset_0065.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:15,280 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:15,282 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:15,412 - stpipe.Detector1Pipeline.reset - INFO - Step reset done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:15,557 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:15,566 - stpipe.Detector1Pipeline.linearity - INFO - Using Linearity reference file /home/runner/crds/references/jwst/miri/jwst_miri_linearity_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:15,588 - stdatamodels.dynamicdq - WARNING - Keyword RESERVED_4 does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:15,597 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:16,403 - stpipe.Detector1Pipeline.linearity - INFO - Step linearity done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:16,550 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:16,559 - stpipe.Detector1Pipeline.rscd - INFO - Using RSCD reference file /home/runner/crds/references/jwst/miri/jwst_miri_rscd_0017.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:16,691 - jwst.rscd.rscd_sub - INFO - Number of groups to skip for integrations 2 and higher: 4
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:16,695 - stpipe.Detector1Pipeline.rscd - INFO - Step rscd done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:16,840 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:16,849 - stpipe.Detector1Pipeline.dark_current - INFO - Using DARK reference file /home/runner/crds/references/jwst/miri/jwst_miri_dark_0098.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:17,085 - stdatamodels.dynamicdq - WARNING - Keyword UNDERSAMP does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:17,089 - stdatamodels.dynamicdq - WARNING - Keyword UNRELIABLE_RESET does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:17,090 - stpipe.Detector1Pipeline.dark_current - INFO - Using Poisson noise from average dark current 1.0 e-/sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:17,091 - stcal.dark_current.dark_sub - INFO - Science data nints=19, ngroups=100, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:17,091 - stcal.dark_current.dark_sub - INFO - Dark data nints=3, ngroups=500, nframes=1, groupgap=0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:17,363 - stpipe.Detector1Pipeline.dark_current - INFO - Step dark_current done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:17,511 - stpipe.Detector1Pipeline.refpix - INFO - Step refpix running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:17,512 - stpipe.Detector1Pipeline.refpix - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:17,656 - stpipe.Detector1Pipeline.charge_migration - INFO - Step charge_migration running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:17,657 - stpipe.Detector1Pipeline.charge_migration - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:17,796 - stpipe.Detector1Pipeline.jump - INFO - Step jump running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:17,803 - stpipe.Detector1Pipeline.jump - INFO - CR rejection threshold = 4 sigma
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:17,804 - stpipe.Detector1Pipeline.jump - INFO - Maximum cores to use = half
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:17,908 - stpipe.Detector1Pipeline.jump - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:17,910 - stpipe.Detector1Pipeline.jump - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:17,934 - stpipe.Detector1Pipeline.jump - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:17,939 - stpipe.Detector1Pipeline.jump - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:18,095 - stcal.jump.jump - INFO - Executing two-point difference method
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:18,095 - stcal.jump.jump - INFO - Creating 4 processes for jump detection 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:22,438 - stcal.jump.jump - INFO - Total elapsed time = 4.3423 sec
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:22,573 - stpipe.Detector1Pipeline.jump - INFO - The execution time in seconds: 4.770016
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:22,576 - stpipe.Detector1Pipeline.jump - INFO - Step jump done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:22,717 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step clean_flicker_noise running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:22,718 - stpipe.Detector1Pipeline.clean_flicker_noise - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:22,863 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit running with args (&lt;RampModel(19, 100, 224, 288) from jw01386031001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:22,982 - jwst.ramp_fitting.ramp_fit_step - INFO - Using READNOISE reference file: /home/runner/crds/references/jwst/miri/jwst_miri_readnoise_0085.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:22,982 - jwst.ramp_fitting.ramp_fit_step - INFO - Using GAIN reference file: /home/runner/crds/references/jwst/miri/jwst_miri_gain_0032.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:23,006 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting gain subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:23,011 - jwst.ramp_fitting.ramp_fit_step - INFO - Extracting readnoise subarray to match science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:23,017 - jwst.ramp_fitting.ramp_fit_step - INFO - Using algorithm = OLS_C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:23,017 - jwst.ramp_fitting.ramp_fit_step - INFO - Using weighting = optimal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:23,327 - stcal.ramp_fitting.ols_fit - INFO - Number of multiprocessing slices: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:23,333 - stcal.ramp_fitting.ols_fit - INFO - Number of leading groups that are flagged as DO_NOT_USE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:23,334 - stcal.ramp_fitting.ols_fit - INFO - MIRI dataset has all pixels in the final group flagged as DO_NOT_USE.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:33,821 - stcal.ramp_fitting.ols_fit - INFO - Ramp Fitting C Time: 10.486842155456543
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:33,864 - stpipe.Detector1Pipeline.ramp_fit - INFO - Step ramp_fit done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:34,011 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;ImageModel(224, 288) from jw01386031001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:34,033 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:34,033 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:34,177 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;ImageModel(224, 288) from jw01386031001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:34,191 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:34,192 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:34,194 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:34,340 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale running with args (&lt;CubeModel(19, 224, 288) from jw01386031001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:34,361 - stpipe.Detector1Pipeline.gain_scale - INFO - GAINFACT not found in gain reference file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:34,362 - stpipe.Detector1Pipeline.gain_scale - INFO - Step will be skipped
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:34,504 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply running with args (&lt;CubeModel(19, 224, 288) from jw01386031001_03101_00001_mirimage_uncal.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:34,522 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Multiplied everything by one in custom step!
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:34,523 - stpipe.Detector1Pipeline.gain_scale.xply - INFO - Step xply done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:34,525 - stpipe.Detector1Pipeline.gain_scale - INFO - Step gain_scale done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:34,593 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs031/stage1/jw01386031001_03101_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:34,593 - jwst.pipeline.calwebb_detector1 - INFO - ... ending calwebb_detector1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:34,594 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:34,645 - stpipe.Detector1Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs031/stage1/jw01386031001_03101_00001_mirimage_rate.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:34,645 - stpipe.Detector1Pipeline - INFO - Step Detector1Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:34,645 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print out the time benchmark</span>
<span class="n">time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Runtime so far: </span><span class="si">{</span><span class="n">time1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">time0</span><span class="si">:</span><span class="s2">0.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Runtime so far: 1732.5583 seconds
</pre></div>
</div>
</div>
</div>
<hr style="border:1px solid gray"> </hr></section>
</section>
<section id="image2-pipeline">
<h2>6.-Image2 Pipeline<a class="headerlink" href="#image2-pipeline" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<p>In this section we process our 3D countrate (<code class="docutils literal notranslate"><span class="pre">rateints</span></code>) products from
Stage 1 (calwebb_detector1) through the Image2 (calwebb_image2) pipeline
in order to produce Stage 2
data products (i.e., 3D calibrated <code class="docutils literal notranslate"><span class="pre">calints</span></code> and 3D background-subtracted <code class="docutils literal notranslate"><span class="pre">bsubints</span></code> data). These data products have units of MJy/sr.</p>
<p>In this pipeline processing stage, the <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/background_step/index.html#background-step">background subtraction</a>
step is performed (if the data has a dedicated background defined), the <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/assign_wcs/index.html#assign-wcs-step">world coordinate system (WCS)</a>
is assigned, the data is <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/flatfield/index.html#flatfield-step">flat fielded</a>,
and a <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/photom/index.html#photom-step">photometric calibration</a>
is applied to convert from units of countrate (ADU/s) to surface brightness (MJy/sr).</p>
<p>The <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/resample/index.html#resample-step">resampling</a> step is performed, to create resampled images of each dither position, but this is only a quick-look product. The resampling step occurs during the Coron3 stage by default. While the resampling step is done in the Image2 stage, the data quality from the Coron3 stage will be better since the bad pixels, which adversely affect both the centroids and photometry in individual images, will be mostly removed.</p>
<p>See https://jwst-docs.stsci.edu/jwst-science-calibration-pipeline/stages-of-jwst-data-processing/calwebb_image2</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_image2</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up a dictionary to define how the Image2 pipeline should be configured.</span>

<span class="c1"># Boilerplate dictionary setup</span>
<span class="n">image2dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">image2dict</span><span class="p">[</span><span class="s1">&#39;assign_wcs&#39;</span><span class="p">],</span> <span class="n">image2dict</span><span class="p">[</span><span class="s1">&#39;bkg_subtract&#39;</span><span class="p">],</span> <span class="n">image2dict</span><span class="p">[</span><span class="s1">&#39;flat_field&#39;</span><span class="p">],</span> <span class="n">image2dict</span><span class="p">[</span><span class="s1">&#39;photom&#39;</span><span class="p">],</span> <span class="n">image2dict</span><span class="p">[</span><span class="s1">&#39;resample&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{},</span> <span class="p">{},</span> <span class="p">{},</span> <span class="p">{}</span>

<span class="c1"># Overrides for whether or not certain steps should be skipped (example)</span>
<span class="c1">#image2dict[&#39;resample&#39;][&#39;skip&#39;] = False</span>
<span class="c1">#image2dict[&#39;bkg_subtract&#39;][&#39;skip&#39;] = True</span>

<span class="c1"># Overrides for various reference files</span>
<span class="c1"># Files should be in the base local directory or provide full path</span>
<span class="c1">#image2dict[&#39;assign_wcs&#39;][&#39;override_distortion&#39;] = &#39;myfile.asdf&#39;  # Spatial distortion (ASDF file)</span>
<span class="c1">#image2dict[&#39;assign_wcs&#39;][&#39;override_filteroffset&#39;] = &#39;myfile.asdf&#39;  # Imager filter offsets (ASDF file)</span>
<span class="c1">#image2dict[&#39;assign_wcs&#39;][&#39;override_specwcs&#39;] = &#39;myfile.asdf&#39;  # Spectral distortion (ASDF file)</span>
<span class="c1">#image2dict[&#39;assign_wcs&#39;][&#39;override_wavelengthrange&#39;] = &#39;myfile.asdf&#39;  # Wavelength channel mapping (ASDF file)</span>
<span class="c1">#image2dict[&#39;flat_field&#39;][&#39;override_flat&#39;] = &#39;myfile.fits&#39;  # Pixel flatfield</span>
<span class="c1">#image2dict[&#39;photom&#39;][&#39;override_photom&#39;] = &#39;myfile.fits&#39;  # Photometric calibration array</span>

<span class="c1"># Save the combined background used for subtraction</span>
<span class="n">image2dict</span><span class="p">[</span><span class="s1">&#39;bkg_subtract&#39;</span><span class="p">][</span><span class="s1">&#39;save_combined_background&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span> 

<span class="c1"># Relevant step-specific arguments for background subtraction</span>
<span class="c1">#image2dict[&#39;bkg_subtract&#39;][&#39;sigma&#39;] = 3.0  # Number of standard deviations to use for sigma-clipping</span>
<span class="c1">#image2dict[&#39;bkg_subtract&#39;][&#39;maxiters&#39;] = None  # Number of clipping iterations to perform when combining multiple background images. If None, will clip until convergence is achieved</span>

<span class="c1"># Relevant step-specific arguments for flat field</span>
<span class="c1">#image2dict[&#39;flat_field&#39;][&#39;user_supplied_flat&#39;] = &#39;myfile.fits&#39;  # Path to user-supplied Flat-field image </span>
<span class="c1">#image2dict[&#39;flat_field&#39;][&#39;inverse&#39;] = False  # Whether to inverse the math operations used to apply the Flat-field (i.e. multiply instead of divide)</span>

<span class="c1"># Overrides for various reference files</span>
<span class="c1"># Files should be in the base local directory or provide full path</span>
<span class="c1">#image2dict[&#39;assign_wcs&#39;][&#39;override_distortion&#39;] = &#39;myfile.asdf&#39;  # Spatial distortion (ASDF file)</span>
<span class="c1">#image2dict[&#39;assign_wcs&#39;][&#39;override_filteroffset&#39;] = &#39;myfile.asdf&#39;  # Imager filter offsets (ASDF file)</span>
<span class="c1">#image2dict[&#39;flat_field&#39;][&#39;override_flat&#39;] = &#39;myfile.fits&#39;  # Pixel flatfield</span>
<span class="c1">#image2dict[&#39;photom&#39;][&#39;override_photom&#39;] = &#39;myfile.fits&#39;  # Photometric calibration array</span>
</pre></div>
</div>
</div>
</div>
<p>Define a function to create association files for Stage 2. This will enable use of the background subtraction, if chosen above.</p>
<div class="alert alert-block alert-warning">
Note that the background will not be applied properly to all files if more than *one* SCI file is included in the association.
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">writel2asn</span><span class="p">(</span><span class="n">onescifile</span><span class="p">,</span> <span class="n">bgfiles</span><span class="p">,</span> <span class="n">asnfile</span><span class="p">,</span> <span class="n">prodname</span><span class="p">):</span>
    <span class="c1"># Define the basic association of science files</span>
    <span class="n">asn</span> <span class="o">=</span> <span class="n">afl</span><span class="o">.</span><span class="n">asn_from_list</span><span class="p">([</span><span class="n">onescifile</span><span class="p">],</span> <span class="n">rule</span><span class="o">=</span><span class="n">DMSLevel2bBase</span><span class="p">,</span> <span class="n">product_name</span><span class="o">=</span><span class="n">prodname</span><span class="p">)</span>  <span class="c1"># Wrap in array since input was single exposure</span>

    <span class="c1">#Coron/filter configuration for this sci file</span>
    <span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">onescifile</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdu</span><span class="p">:</span>
        <span class="n">hdu</span><span class="o">.</span><span class="n">verify</span><span class="p">()</span>
        <span class="n">hdr</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span>
        <span class="n">this_mask</span><span class="p">,</span> <span class="n">this_filter</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;CORONMSK&#39;</span><span class="p">],</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;FILTER&#39;</span><span class="p">]</span>

    <span class="c1"># Find which background files are appropriate to this mask/filter and add to association</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">bgfiles</span><span class="p">:</span>
        <span class="n">hdu</span><span class="o">.</span><span class="n">verify</span><span class="p">()</span>
        <span class="n">hdr</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span>
        <span class="k">if</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;FILTER&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">this_filter</span> <span class="ow">and</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;CORONMSK&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">this_mask</span><span class="p">:</span>
            <span class="n">asn</span><span class="p">[</span><span class="s1">&#39;products&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;members&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;expname&#39;</span><span class="p">:</span> <span class="n">file</span><span class="p">,</span> <span class="s1">&#39;exptype&#39;</span><span class="p">:</span> <span class="s1">&#39;background&#39;</span><span class="p">})</span>

    <span class="c1"># Write the association to a json file</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">serialized</span> <span class="o">=</span> <span class="n">asn</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">asnfile</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">serialized</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Find and sort all of the input files for the selected filter and coronagraphic mask, ensuring use of absolute paths.</p>
<p>The input files should be <code class="docutils literal notranslate"><span class="pre">rateints.fits</span></code> products and for the demo example there should be a total of 2 files corresponding to the science target; 9 files corresponding to the reference target; 2 files corresponding to the science background target and 2 files corresponding to the reference background target.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Identify Science Files </span>
<span class="c1"># Roll 1</span>
<span class="n">sstring</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">det1_sci_r1_dir</span><span class="p">,</span> <span class="s1">&#39;jw*mirimage*rateints.fits&#39;</span><span class="p">)</span>  <span class="c1"># Use files from the detector1 output folder</span>
<span class="n">sci_r1_files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">sstring</span><span class="p">))</span>

<span class="c1"># Check that these are the mask/filter to use</span>
<span class="n">sci_r1_files</span> <span class="o">=</span> <span class="n">select_mask_filter_files</span><span class="p">(</span><span class="n">sci_r1_files</span><span class="p">,</span> <span class="n">use_mask</span><span class="p">,</span> <span class="n">use_filter</span><span class="p">)</span>

<span class="c1"># Roll 2</span>
<span class="n">sstring</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">det1_sci_r2_dir</span><span class="p">,</span> <span class="s1">&#39;jw*mirimage*rateints.fits&#39;</span><span class="p">)</span>  <span class="c1"># Use files from the detector1 output folder</span>
<span class="n">sci_r2_files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">sstring</span><span class="p">))</span>
<span class="n">sci_r2_files</span> <span class="o">=</span> <span class="n">select_mask_filter_files</span><span class="p">(</span><span class="n">sci_r2_files</span><span class="p">,</span> <span class="n">use_mask</span><span class="p">,</span> <span class="n">use_filter</span><span class="p">)</span>

<span class="c1"># Identify PSF Ref Target Files</span>
<span class="n">sstring</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">det1_ref_targ_dir</span><span class="p">,</span> <span class="s1">&#39;jw*mirimage*rateints.fits&#39;</span><span class="p">)</span>
<span class="n">ref_targ_files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">sstring</span><span class="p">))</span>
<span class="n">ref_targ_files</span> <span class="o">=</span> <span class="n">select_mask_filter_files</span><span class="p">(</span><span class="n">ref_targ_files</span><span class="p">,</span> <span class="n">use_mask</span><span class="p">,</span> <span class="n">use_filter</span><span class="p">)</span>

<span class="c1"># Background Files</span>
<span class="c1"># Sci Bkg</span>
<span class="n">sstring</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">det1_bg_sci_dir</span><span class="p">,</span> <span class="s1">&#39;jw*mirimage*rateints.fits&#39;</span><span class="p">)</span>
<span class="n">bg_sci_files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">sstring</span><span class="p">))</span>
<span class="n">bg_sci_files</span> <span class="o">=</span> <span class="n">select_mask_filter_files</span><span class="p">(</span><span class="n">bg_sci_files</span><span class="p">,</span> <span class="n">use_mask</span><span class="p">,</span> <span class="n">use_filter</span><span class="p">)</span>

<span class="c1"># Ref target Bkg </span>
<span class="n">sstring</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">det1_bg_ref_targ_dir</span><span class="p">,</span> <span class="s1">&#39;jw*mirimage*rateints.fits&#39;</span><span class="p">)</span>
<span class="n">bg_ref_targ_files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">sstring</span><span class="p">))</span>
<span class="n">bg_ref_targ_files</span> <span class="o">=</span> <span class="n">select_mask_filter_files</span><span class="p">(</span><span class="n">bg_ref_targ_files</span><span class="p">,</span> <span class="n">use_mask</span><span class="p">,</span> <span class="n">use_filter</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Found &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sci_r1_files</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">sci_r2_files</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; science files&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Found &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ref_targ_files</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; reference files&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Found &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bg_sci_files</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; science background files&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Found &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bg_ref_targ_files</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; reference background files&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found 2 science files
Found 9 reference files
Found 2 science background files
Found 2 reference background files
</pre></div>
</div>
</div>
</div>
<p>Step through each of the science files for both rolls. First creates the association file using relevant associated backgrounds and then runs calwebb_image2 processing.</p>
<div class="cell tag_scroll-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">doimage2</span><span class="p">:</span>
    <span class="c1"># Science Roll 1</span>
    <span class="c1"># Generate a proper background-subtracting association file</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">sci_r1_files</span><span class="p">:</span>
        <span class="n">asnfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">image2_sci_r1_dir</span><span class="p">,</span> <span class="s1">&#39;l2asn.json&#39;</span><span class="p">)</span>
        <span class="n">writel2asn</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">bg_sci_files</span><span class="p">,</span> <span class="n">asnfile</span><span class="p">,</span> <span class="s1">&#39;Level2&#39;</span><span class="p">)</span>
        <span class="n">Image2Pipeline</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">asnfile</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">image2dict</span><span class="p">,</span> <span class="n">save_bsub</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save_results</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="n">image2_sci_r1_dir</span><span class="p">)</span>

    <span class="c1"># Science Roll 2</span>
    <span class="c1"># Generate a proper background-subtracting association file</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">sci_r2_files</span><span class="p">:</span>
        <span class="n">asnfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">image2_sci_r2_dir</span><span class="p">,</span> <span class="s1">&#39;l2asn.json&#39;</span><span class="p">)</span>
        <span class="n">writel2asn</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">bg_sci_files</span><span class="p">,</span> <span class="n">asnfile</span><span class="p">,</span> <span class="s1">&#39;Level2&#39;</span><span class="p">)</span>
        <span class="n">Image2Pipeline</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">asnfile</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">image2dict</span><span class="p">,</span> <span class="n">save_bsub</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save_results</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="n">image2_sci_r2_dir</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Skipping Image2 processing for SCI data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:34,887 - CRDS - INFO -  Fetching  /home/runner/crds/references/jwst/miri/jwst_miri_pars-resamplestep_0001.asdf    1.0 K bytes  (1 / 1 files) (0 / 1.0 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:35,085 - stpipe - INFO - PARS-RESAMPLESTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-resamplestep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:35,096 - stpipe.Image2Pipeline - INFO - Image2Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:35,098 - stpipe.Image2Pipeline.bkg_subtract - INFO - BackgroundStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:35,099 - stpipe.Image2Pipeline.assign_wcs - INFO - AssignWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:35,099 - stpipe.Image2Pipeline.flat_field - INFO - FlatFieldStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:35,100 - stpipe.Image2Pipeline.photom - INFO - PhotomStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:35,103 - stpipe.Image2Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:35,244 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline running with args (&#39;./miri_coro_demo_data/Obs008/stage2/l2asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:35,252 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./miri_coro_demo_data/Obs008/stage2
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_bsub: True
  steps:
    bkg_subtract:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bkg_list: None
      save_combined_background: True
      sigma: 3.0
      maxiters: None
      soss_source_percentile: 35.0
      soss_bkg_percentile: None
      wfss_mmag_extract: None
      wfss_maxiter: 5
      wfss_rms_stop: 0.0
      wfss_outlier_percent: 1.0
    assign_wcs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      sip_approx: True
      sip_max_pix_error: 0.01
      sip_degree: None
      sip_max_inv_pix_error: 0.01
      sip_inv_degree: None
      sip_npoints: 12
      slit_y_low: -0.55
      slit_y_high: 0.55
      nrs_ifu_slice_wcs: False
    flat_field:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      save_interpolated_flat: False
      user_supplied_flat: None
      inverse: False
    photom:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      inverse: False
      source_type: None
      mrs_time_correction: True
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: exptime
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: None
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      in_memory: True
      enable_ctx: True
      enable_err: True
      report_var: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:35,295 - stpipe.Image2Pipeline - INFO - Prefetching reference files for dataset: &#39;l2asn.json&#39; reftypes = [&#39;area&#39;, &#39;bkg&#39;, &#39;camera&#39;, &#39;collimator&#39;, &#39;dflat&#39;, &#39;disperser&#39;, &#39;distortion&#39;, &#39;fflat&#39;, &#39;filteroffset&#39;, &#39;flat&#39;, &#39;fore&#39;, &#39;fpa&#39;, &#39;ifufore&#39;, &#39;ifupost&#39;, &#39;ifuslicer&#39;, &#39;msa&#39;, &#39;ote&#39;, &#39;photom&#39;, &#39;regions&#39;, &#39;sflat&#39;, &#39;specwcs&#39;, &#39;wavelengthrange&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:35,298 - CRDS - INFO -  Fetching  /home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf   12.4 K bytes  (1 / 4 files) (0 / 827.0 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:35,543 - CRDS - INFO -  Fetching  /home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0007.asdf    2.5 K bytes  (2 / 4 files) (12.4 K / 827.0 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:35,721 - CRDS - INFO -  Fetching  /home/runner/crds/references/jwst/miri/jwst_miri_flat_0768.fits  797.8 K bytes  (3 / 4 files) (14.8 K / 827.0 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:36,207 - CRDS - INFO -  Fetching  /home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits   14.4 K bytes  (4 / 4 files) (812.6 K / 827.0 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:36,429 - stpipe.Image2Pipeline - INFO - Prefetch for AREA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:36,429 - stpipe.Image2Pipeline - INFO - Prefetch for BKG reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:36,430 - stpipe.Image2Pipeline - INFO - Prefetch for CAMERA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:36,430 - stpipe.Image2Pipeline - INFO - Prefetch for COLLIMATOR reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:36,430 - stpipe.Image2Pipeline - INFO - Prefetch for DFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:36,431 - stpipe.Image2Pipeline - INFO - Prefetch for DISPERSER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:36,431 - stpipe.Image2Pipeline - INFO - Prefetch for DISTORTION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:36,432 - stpipe.Image2Pipeline - INFO - Prefetch for FFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:36,432 - stpipe.Image2Pipeline - INFO - Prefetch for FILTEROFFSET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0007.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:36,432 - stpipe.Image2Pipeline - INFO - Prefetch for FLAT reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_flat_0768.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:36,433 - stpipe.Image2Pipeline - INFO - Prefetch for FORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:36,433 - stpipe.Image2Pipeline - INFO - Prefetch for FPA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:36,433 - stpipe.Image2Pipeline - INFO - Prefetch for IFUFORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:36,433 - stpipe.Image2Pipeline - INFO - Prefetch for IFUPOST reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:36,434 - stpipe.Image2Pipeline - INFO - Prefetch for IFUSLICER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:36,434 - stpipe.Image2Pipeline - INFO - Prefetch for MSA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:36,434 - stpipe.Image2Pipeline - INFO - Prefetch for OTE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:36,435 - stpipe.Image2Pipeline - INFO - Prefetch for PHOTOM reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:36,435 - stpipe.Image2Pipeline - INFO - Prefetch for REGIONS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:36,436 - stpipe.Image2Pipeline - INFO - Prefetch for SFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:36,436 - stpipe.Image2Pipeline - INFO - Prefetch for SPECWCS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:36,436 - stpipe.Image2Pipeline - INFO - Prefetch for WAVELENGTHRANGE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:36,437 - stpipe.Image2Pipeline - INFO - Starting calwebb_image2 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:36,442 - stpipe.Image2Pipeline - INFO - Processing product /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs008/stage1/jw01386008001_04101_00001_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:36,443 - stpipe.Image2Pipeline - INFO - Working on input /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs008/stage1/jw01386008001_04101_00001_mirimage_rateints.fits ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:36,663 - stpipe.Image2Pipeline.bkg_subtract - INFO - Step bkg_subtract running with args (&lt;CubeModel(60, 224, 288) from ./miri_coro_demo_data/Obs008/stage2/jw01386008001_04101_00001_mirimage_image2pipeline.fits&gt;, [&#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs030/stage1/jw01386030001_02101_00001_mirimage_rateints.fits&#39;, &#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs030/stage1/jw01386030001_03101_00001_mirimage_rateints.fits&#39;]).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:36,690 - jwst.background.asn_intake - INFO - Working on input &lt;CubeModel(60, 224, 288) from ./miri_coro_demo_data/Obs008/stage2/jw01386008001_04101_00001_mirimage_image2pipeline.fits&gt; ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:36,730 - jwst.background.background_sub - INFO - Accumulate bkg from /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs030/stage1/jw01386030001_02101_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:37,117 - jwst.background.background_sub - INFO - Accumulate bkg from /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs030/stage1/jw01386030001_03101_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:37,493 - jwst.background.background_sub - INFO - Subtracting avg bkg from ./miri_coro_demo_data/Obs008/stage2/jw01386008001_04101_00001_mirimage_image2pipeline.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:37,543 - stpipe.Image2Pipeline.bkg_subtract - INFO - Saved model in ./miri_coro_demo_data/Obs008/stage2/jw01386008001_04101_00001_mirimage_combinedbackground.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:37,543 - stpipe.Image2Pipeline.bkg_subtract - INFO - Combined background written to ./miri_coro_demo_data/Obs008/stage2/jw01386008001_04101_00001_mirimage_combinedbackground.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:37,648 - stpipe.Image2Pipeline.bkg_subtract - INFO - Saved model in ./miri_coro_demo_data/Obs008/stage2/jw01386008001_04101_00001_mirimage_bsubints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:37,649 - stpipe.Image2Pipeline.bkg_subtract - INFO - Step bkg_subtract done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:37,790 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs running with args (&lt;CubeModel(60, 224, 288) from jw01386008001_04101_00001_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:37,894 - jwst.assign_wcs.miri - INFO - Created a MIRI mir_4qpm pipeline with references {&#39;distortion&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;, &#39;filteroffset&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0007.asdf&#39;, &#39;specwcs&#39;: None, &#39;regions&#39;: None, &#39;wavelengthrange&#39;: None, &#39;camera&#39;: None, &#39;collimator&#39;: None, &#39;disperser&#39;: None, &#39;fore&#39;: None, &#39;fpa&#39;: None, &#39;msa&#39;: None, &#39;ote&#39;: None, &#39;ifupost&#39;: None, &#39;ifufore&#39;: None, &#39;ifuslicer&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:37,951 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  201.142913171 -51.506910745 201.153451777 -51.509019980 201.157902904 -51.500668858 201.147337621 -51.498535546
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:37,952 - jwst.assign_wcs.assign_wcs - INFO - assign_wcs updated S_REGION to POLYGON ICRS  201.142913171 -51.506910745 201.153451777 -51.509019980 201.157902904 -51.500668858 201.147337621 -51.498535546
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:37,952 - jwst.assign_wcs.assign_wcs - INFO - COMPLETED assign_wcs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:37,988 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,128 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field running with args (&lt;CubeModel(60, 224, 288) from jw01386008001_04101_00001_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,165 - stdatamodels.dynamicdq - WARNING - Keyword CDP_PARTIAL_DATA does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,165 - stdatamodels.dynamicdq - WARNING - Keyword CDP_LOW_QUAL does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,166 - stdatamodels.dynamicdq - WARNING - Keyword CDP_UNRELIABLE_ERROR does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,167 - stdatamodels.dynamicdq - WARNING - Keyword DIFF_PATTERN does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,168 - stpipe.Image2Pipeline.flat_field - INFO - Using FLAT reference file: /home/runner/crds/references/jwst/miri/jwst_miri_flat_0768.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,168 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type FFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,168 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type SFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,169 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type DFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,257 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,399 - stpipe.Image2Pipeline.photom - INFO - Step photom running with args (&lt;CubeModel(60, 224, 288) from jw01386008001_04101_00001_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,415 - stpipe.Image2Pipeline.photom - INFO - Using photom reference file: /home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,416 - stpipe.Image2Pipeline.photom - INFO - Using area reference file: N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,443 - jwst.photom.photom - INFO - Using instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,444 - jwst.photom.photom - INFO -  detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,444 - jwst.photom.photom - INFO -  exp_type: MIR_4QPM
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,445 - jwst.photom.photom - INFO -  filter: F1550C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,463 - jwst.photom.photom - INFO - Attempting to obtain PIXAR_SR and PIXAR_A2 values from PHOTOM reference file.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,463 - jwst.photom.photom - INFO - Values for PIXAR_SR and PIXAR_A2 obtained from PHOTOM reference file.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,464 - jwst.photom.photom - INFO -  subarray: MASK1550
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,465 - jwst.photom.photom - INFO - Applying the time-dependent correction to the PHOTOM value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,469 - jwst.photom.photom - INFO - PHOTMJSR value: 3.78947
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,514 - stpipe.Image2Pipeline.photom - INFO - Step photom done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,515 - stpipe.Image2Pipeline - INFO - Finished processing product /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs008/stage1/jw01386008001_04101_00001_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,516 - stpipe.Image2Pipeline - INFO - ... ending calwebb_image2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,516 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,685 - stpipe.Image2Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs008/stage2/jw01386008001_04101_00001_mirimage_calints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,685 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,686 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,752 - stpipe - INFO - PARS-RESAMPLESTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-resamplestep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,763 - stpipe.Image2Pipeline - INFO - Image2Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,764 - stpipe.Image2Pipeline.bkg_subtract - INFO - BackgroundStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,765 - stpipe.Image2Pipeline.assign_wcs - INFO - AssignWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,766 - stpipe.Image2Pipeline.flat_field - INFO - FlatFieldStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,767 - stpipe.Image2Pipeline.photom - INFO - PhotomStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,768 - stpipe.Image2Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,913 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline running with args (&#39;./miri_coro_demo_data/Obs009/stage2/l2asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,921 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./miri_coro_demo_data/Obs009/stage2
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_bsub: True
  steps:
    bkg_subtract:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bkg_list: None
      save_combined_background: True
      sigma: 3.0
      maxiters: None
      soss_source_percentile: 35.0
      soss_bkg_percentile: None
      wfss_mmag_extract: None
      wfss_maxiter: 5
      wfss_rms_stop: 0.0
      wfss_outlier_percent: 1.0
    assign_wcs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      sip_approx: True
      sip_max_pix_error: 0.01
      sip_degree: None
      sip_max_inv_pix_error: 0.01
      sip_inv_degree: None
      sip_npoints: 12
      slit_y_low: -0.55
      slit_y_high: 0.55
      nrs_ifu_slice_wcs: False
    flat_field:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      save_interpolated_flat: False
      user_supplied_flat: None
      inverse: False
    photom:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      inverse: False
      source_type: None
      mrs_time_correction: True
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: exptime
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: None
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      in_memory: True
      enable_ctx: True
      enable_err: True
      report_var: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,964 - stpipe.Image2Pipeline - INFO - Prefetching reference files for dataset: &#39;l2asn.json&#39; reftypes = [&#39;area&#39;, &#39;bkg&#39;, &#39;camera&#39;, &#39;collimator&#39;, &#39;dflat&#39;, &#39;disperser&#39;, &#39;distortion&#39;, &#39;fflat&#39;, &#39;filteroffset&#39;, &#39;flat&#39;, &#39;fore&#39;, &#39;fpa&#39;, &#39;ifufore&#39;, &#39;ifupost&#39;, &#39;ifuslicer&#39;, &#39;msa&#39;, &#39;ote&#39;, &#39;photom&#39;, &#39;regions&#39;, &#39;sflat&#39;, &#39;specwcs&#39;, &#39;wavelengthrange&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,966 - stpipe.Image2Pipeline - INFO - Prefetch for AREA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,967 - stpipe.Image2Pipeline - INFO - Prefetch for BKG reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,967 - stpipe.Image2Pipeline - INFO - Prefetch for CAMERA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,967 - stpipe.Image2Pipeline - INFO - Prefetch for COLLIMATOR reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,968 - stpipe.Image2Pipeline - INFO - Prefetch for DFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,968 - stpipe.Image2Pipeline - INFO - Prefetch for DISPERSER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,968 - stpipe.Image2Pipeline - INFO - Prefetch for DISTORTION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,969 - stpipe.Image2Pipeline - INFO - Prefetch for FFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,970 - stpipe.Image2Pipeline - INFO - Prefetch for FILTEROFFSET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0007.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,970 - stpipe.Image2Pipeline - INFO - Prefetch for FLAT reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_flat_0768.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,970 - stpipe.Image2Pipeline - INFO - Prefetch for FORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,971 - stpipe.Image2Pipeline - INFO - Prefetch for FPA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,971 - stpipe.Image2Pipeline - INFO - Prefetch for IFUFORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,972 - stpipe.Image2Pipeline - INFO - Prefetch for IFUPOST reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,972 - stpipe.Image2Pipeline - INFO - Prefetch for IFUSLICER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,972 - stpipe.Image2Pipeline - INFO - Prefetch for MSA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,972 - stpipe.Image2Pipeline - INFO - Prefetch for OTE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,973 - stpipe.Image2Pipeline - INFO - Prefetch for PHOTOM reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,973 - stpipe.Image2Pipeline - INFO - Prefetch for REGIONS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,974 - stpipe.Image2Pipeline - INFO - Prefetch for SFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,974 - stpipe.Image2Pipeline - INFO - Prefetch for SPECWCS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,974 - stpipe.Image2Pipeline - INFO - Prefetch for WAVELENGTHRANGE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,975 - stpipe.Image2Pipeline - INFO - Starting calwebb_image2 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,981 - stpipe.Image2Pipeline - INFO - Processing product /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs009/stage1/jw01386009001_04101_00001_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:38,981 - stpipe.Image2Pipeline - INFO - Working on input /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs009/stage1/jw01386009001_04101_00001_mirimage_rateints.fits ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:39,205 - stpipe.Image2Pipeline.bkg_subtract - INFO - Step bkg_subtract running with args (&lt;CubeModel(60, 224, 288) from ./miri_coro_demo_data/Obs009/stage2/jw01386009001_04101_00001_mirimage_image2pipeline.fits&gt;, [&#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs030/stage1/jw01386030001_02101_00001_mirimage_rateints.fits&#39;, &#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs030/stage1/jw01386030001_03101_00001_mirimage_rateints.fits&#39;]).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:39,232 - jwst.background.asn_intake - INFO - Working on input &lt;CubeModel(60, 224, 288) from ./miri_coro_demo_data/Obs009/stage2/jw01386009001_04101_00001_mirimage_image2pipeline.fits&gt; ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:39,272 - jwst.background.background_sub - INFO - Accumulate bkg from /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs030/stage1/jw01386030001_02101_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:39,658 - jwst.background.background_sub - INFO - Accumulate bkg from /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs030/stage1/jw01386030001_03101_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,035 - jwst.background.background_sub - INFO - Subtracting avg bkg from ./miri_coro_demo_data/Obs009/stage2/jw01386009001_04101_00001_mirimage_image2pipeline.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,085 - stpipe.Image2Pipeline.bkg_subtract - INFO - Saved model in ./miri_coro_demo_data/Obs009/stage2/jw01386009001_04101_00001_mirimage_combinedbackground.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,086 - stpipe.Image2Pipeline.bkg_subtract - INFO - Combined background written to ./miri_coro_demo_data/Obs009/stage2/jw01386009001_04101_00001_mirimage_combinedbackground.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,190 - stpipe.Image2Pipeline.bkg_subtract - INFO - Saved model in ./miri_coro_demo_data/Obs009/stage2/jw01386009001_04101_00001_mirimage_bsubints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,191 - stpipe.Image2Pipeline.bkg_subtract - INFO - Step bkg_subtract done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,333 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs running with args (&lt;CubeModel(60, 224, 288) from jw01386009001_04101_00001_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,418 - jwst.assign_wcs.miri - INFO - Created a MIRI mir_4qpm pipeline with references {&#39;distortion&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;, &#39;filteroffset&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0007.asdf&#39;, &#39;specwcs&#39;: None, &#39;regions&#39;: None, &#39;wavelengthrange&#39;: None, &#39;camera&#39;: None, &#39;collimator&#39;: None, &#39;disperser&#39;: None, &#39;fore&#39;: None, &#39;fpa&#39;: None, &#39;msa&#39;: None, &#39;ote&#39;: None, &#39;ifupost&#39;: None, &#39;ifufore&#39;: None, &#39;ifuslicer&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,470 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  201.142396063 -51.506154891 201.152241438 -51.509304907 201.158819540 -51.501516923 201.148953777 -51.498340428
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,471 - jwst.assign_wcs.assign_wcs - INFO - assign_wcs updated S_REGION to POLYGON ICRS  201.142396063 -51.506154891 201.152241438 -51.509304907 201.158819540 -51.501516923 201.148953777 -51.498340428
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,471 - jwst.assign_wcs.assign_wcs - INFO - COMPLETED assign_wcs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,503 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,647 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field running with args (&lt;CubeModel(60, 224, 288) from jw01386009001_04101_00001_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,679 - stdatamodels.dynamicdq - WARNING - Keyword CDP_PARTIAL_DATA does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,679 - stdatamodels.dynamicdq - WARNING - Keyword CDP_LOW_QUAL does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,680 - stdatamodels.dynamicdq - WARNING - Keyword CDP_UNRELIABLE_ERROR does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,681 - stdatamodels.dynamicdq - WARNING - Keyword DIFF_PATTERN does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,682 - stpipe.Image2Pipeline.flat_field - INFO - Using FLAT reference file: /home/runner/crds/references/jwst/miri/jwst_miri_flat_0768.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,682 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type FFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,683 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type SFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,683 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type DFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,772 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,919 - stpipe.Image2Pipeline.photom - INFO - Step photom running with args (&lt;CubeModel(60, 224, 288) from jw01386009001_04101_00001_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,930 - stpipe.Image2Pipeline.photom - INFO - Using photom reference file: /home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,930 - stpipe.Image2Pipeline.photom - INFO - Using area reference file: N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,960 - jwst.photom.photom - INFO - Using instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,961 - jwst.photom.photom - INFO -  detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,961 - jwst.photom.photom - INFO -  exp_type: MIR_4QPM
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,961 - jwst.photom.photom - INFO -  filter: F1550C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,977 - jwst.photom.photom - INFO - Attempting to obtain PIXAR_SR and PIXAR_A2 values from PHOTOM reference file.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,977 - jwst.photom.photom - INFO - Values for PIXAR_SR and PIXAR_A2 obtained from PHOTOM reference file.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,978 - jwst.photom.photom - INFO -  subarray: MASK1550
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,979 - jwst.photom.photom - INFO - Applying the time-dependent correction to the PHOTOM value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:40,983 - jwst.photom.photom - INFO - PHOTMJSR value: 3.7895
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,029 - stpipe.Image2Pipeline.photom - INFO - Step photom done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,030 - stpipe.Image2Pipeline - INFO - Finished processing product /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs009/stage1/jw01386009001_04101_00001_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,030 - stpipe.Image2Pipeline - INFO - ... ending calwebb_image2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,031 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,197 - stpipe.Image2Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs009/stage2/jw01386009001_04101_00001_mirimage_calints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,197 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,198 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
</div>
</div>
<p>Step through each of the reference target files. First creates the association file using relevant associated backgrounds and then runs calwebb_image2 processing.</p>
<div class="cell tag_scroll-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">doimage2</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">ref_targ_files</span><span class="p">:</span>
        <span class="c1"># Extract the dither number to use in asn filename</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(\d</span><span class="si">{5}</span><span class="s1">)_mirimage&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

        <span class="c1"># Generate a proper background-subtracting association file</span>
        <span class="n">asnfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">image2_ref_targ_dir</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_l2asn.json&#39;</span><span class="p">)</span>
        <span class="n">writel2asn</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">bg_ref_targ_files</span><span class="p">,</span> <span class="n">asnfile</span><span class="p">,</span> <span class="s1">&#39;Level2&#39;</span><span class="p">)</span>
        <span class="n">Image2Pipeline</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">asnfile</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">image2dict</span><span class="p">,</span> <span class="n">save_bsub</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save_results</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="n">image2_ref_targ_dir</span><span class="p">)</span>  
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Skipping Image2 processing for PSF REF target data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,269 - stpipe - INFO - PARS-RESAMPLESTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-resamplestep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,279 - stpipe.Image2Pipeline - INFO - Image2Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,280 - stpipe.Image2Pipeline.bkg_subtract - INFO - BackgroundStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,282 - stpipe.Image2Pipeline.assign_wcs - INFO - AssignWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,283 - stpipe.Image2Pipeline.flat_field - INFO - FlatFieldStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,283 - stpipe.Image2Pipeline.photom - INFO - PhotomStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,285 - stpipe.Image2Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,431 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline running with args (&#39;./miri_coro_demo_data/Obs007/stage2/00001_l2asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,438 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./miri_coro_demo_data/Obs007/stage2
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_bsub: True
  steps:
    bkg_subtract:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bkg_list: None
      save_combined_background: True
      sigma: 3.0
      maxiters: None
      soss_source_percentile: 35.0
      soss_bkg_percentile: None
      wfss_mmag_extract: None
      wfss_maxiter: 5
      wfss_rms_stop: 0.0
      wfss_outlier_percent: 1.0
    assign_wcs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      sip_approx: True
      sip_max_pix_error: 0.01
      sip_degree: None
      sip_max_inv_pix_error: 0.01
      sip_inv_degree: None
      sip_npoints: 12
      slit_y_low: -0.55
      slit_y_high: 0.55
      nrs_ifu_slice_wcs: False
    flat_field:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      save_interpolated_flat: False
      user_supplied_flat: None
      inverse: False
    photom:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      inverse: False
      source_type: None
      mrs_time_correction: True
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: exptime
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: None
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      in_memory: True
      enable_ctx: True
      enable_err: True
      report_var: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,481 - stpipe.Image2Pipeline - INFO - Prefetching reference files for dataset: &#39;00001_l2asn.json&#39; reftypes = [&#39;area&#39;, &#39;bkg&#39;, &#39;camera&#39;, &#39;collimator&#39;, &#39;dflat&#39;, &#39;disperser&#39;, &#39;distortion&#39;, &#39;fflat&#39;, &#39;filteroffset&#39;, &#39;flat&#39;, &#39;fore&#39;, &#39;fpa&#39;, &#39;ifufore&#39;, &#39;ifupost&#39;, &#39;ifuslicer&#39;, &#39;msa&#39;, &#39;ote&#39;, &#39;photom&#39;, &#39;regions&#39;, &#39;sflat&#39;, &#39;specwcs&#39;, &#39;wavelengthrange&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,484 - stpipe.Image2Pipeline - INFO - Prefetch for AREA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,484 - stpipe.Image2Pipeline - INFO - Prefetch for BKG reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,484 - stpipe.Image2Pipeline - INFO - Prefetch for CAMERA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,485 - stpipe.Image2Pipeline - INFO - Prefetch for COLLIMATOR reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,485 - stpipe.Image2Pipeline - INFO - Prefetch for DFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,486 - stpipe.Image2Pipeline - INFO - Prefetch for DISPERSER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,486 - stpipe.Image2Pipeline - INFO - Prefetch for DISTORTION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,486 - stpipe.Image2Pipeline - INFO - Prefetch for FFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,486 - stpipe.Image2Pipeline - INFO - Prefetch for FILTEROFFSET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0007.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,487 - stpipe.Image2Pipeline - INFO - Prefetch for FLAT reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_flat_0768.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,488 - stpipe.Image2Pipeline - INFO - Prefetch for FORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,488 - stpipe.Image2Pipeline - INFO - Prefetch for FPA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,488 - stpipe.Image2Pipeline - INFO - Prefetch for IFUFORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,489 - stpipe.Image2Pipeline - INFO - Prefetch for IFUPOST reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,489 - stpipe.Image2Pipeline - INFO - Prefetch for IFUSLICER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,489 - stpipe.Image2Pipeline - INFO - Prefetch for MSA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,490 - stpipe.Image2Pipeline - INFO - Prefetch for OTE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,490 - stpipe.Image2Pipeline - INFO - Prefetch for PHOTOM reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,491 - stpipe.Image2Pipeline - INFO - Prefetch for REGIONS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,491 - stpipe.Image2Pipeline - INFO - Prefetch for SFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,491 - stpipe.Image2Pipeline - INFO - Prefetch for SPECWCS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,492 - stpipe.Image2Pipeline - INFO - Prefetch for WAVELENGTHRANGE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,492 - stpipe.Image2Pipeline - INFO - Starting calwebb_image2 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,498 - stpipe.Image2Pipeline - INFO - Processing product /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00001_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,498 - stpipe.Image2Pipeline - INFO - Working on input /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00001_mirimage_rateints.fits ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,694 - stpipe.Image2Pipeline.bkg_subtract - INFO - Step bkg_subtract running with args (&lt;CubeModel(19, 224, 288) from ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00001_mirimage_image2pipeline.fits&gt;, [&#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_02101_00001_mirimage_rateints.fits&#39;, &#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_03101_00001_mirimage_rateints.fits&#39;]).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,709 - jwst.background.asn_intake - INFO - Working on input &lt;CubeModel(19, 224, 288) from ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00001_mirimage_image2pipeline.fits&gt; ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,738 - jwst.background.background_sub - INFO - Accumulate bkg from /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_02101_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,857 - jwst.background.background_sub - INFO - Accumulate bkg from /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_03101_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:41,977 - jwst.background.background_sub - INFO - Subtracting avg bkg from ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00001_mirimage_image2pipeline.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,018 - stpipe.Image2Pipeline.bkg_subtract - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00001_mirimage_combinedbackground.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,018 - stpipe.Image2Pipeline.bkg_subtract - INFO - Combined background written to ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00001_mirimage_combinedbackground.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,086 - stpipe.Image2Pipeline.bkg_subtract - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00001_mirimage_bsubints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,087 - stpipe.Image2Pipeline.bkg_subtract - INFO - Step bkg_subtract done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,229 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00001_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,314 - jwst.assign_wcs.miri - INFO - Created a MIRI mir_4qpm pipeline with references {&#39;distortion&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;, &#39;filteroffset&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0007.asdf&#39;, &#39;specwcs&#39;: None, &#39;regions&#39;: None, &#39;wavelengthrange&#39;: None, &#39;camera&#39;: None, &#39;collimator&#39;: None, &#39;disperser&#39;: None, &#39;fore&#39;: None, &#39;fpa&#39;: None, &#39;msa&#39;: None, &#39;ote&#39;: None, &#39;ifupost&#39;: None, &#39;ifufore&#39;: None, &#39;ifuslicer&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,361 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  209.561515185 -42.103134106 209.570302774 -42.105362389 209.574241499 -42.097063251 209.565431699 -42.094810475
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,362 - jwst.assign_wcs.assign_wcs - INFO - assign_wcs updated S_REGION to POLYGON ICRS  209.561515185 -42.103134106 209.570302774 -42.105362389 209.574241499 -42.097063251 209.565431699 -42.094810475
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,363 - jwst.assign_wcs.assign_wcs - INFO - COMPLETED assign_wcs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,395 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,541 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00001_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,573 - stdatamodels.dynamicdq - WARNING - Keyword CDP_PARTIAL_DATA does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,573 - stdatamodels.dynamicdq - WARNING - Keyword CDP_LOW_QUAL does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,574 - stdatamodels.dynamicdq - WARNING - Keyword CDP_UNRELIABLE_ERROR does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,575 - stdatamodels.dynamicdq - WARNING - Keyword DIFF_PATTERN does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,576 - stpipe.Image2Pipeline.flat_field - INFO - Using FLAT reference file: /home/runner/crds/references/jwst/miri/jwst_miri_flat_0768.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,576 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type FFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,576 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type SFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,577 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type DFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,625 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,771 - stpipe.Image2Pipeline.photom - INFO - Step photom running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00001_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,782 - stpipe.Image2Pipeline.photom - INFO - Using photom reference file: /home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,782 - stpipe.Image2Pipeline.photom - INFO - Using area reference file: N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,808 - jwst.photom.photom - INFO - Using instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,809 - jwst.photom.photom - INFO -  detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,809 - jwst.photom.photom - INFO -  exp_type: MIR_4QPM
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,810 - jwst.photom.photom - INFO -  filter: F1550C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,825 - jwst.photom.photom - INFO - Attempting to obtain PIXAR_SR and PIXAR_A2 values from PHOTOM reference file.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,825 - jwst.photom.photom - INFO - Values for PIXAR_SR and PIXAR_A2 obtained from PHOTOM reference file.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,826 - jwst.photom.photom - INFO -  subarray: MASK1550
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,827 - jwst.photom.photom - INFO - Applying the time-dependent correction to the PHOTOM value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,831 - jwst.photom.photom - INFO - PHOTMJSR value: 3.78942
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,848 - stpipe.Image2Pipeline.photom - INFO - Step photom done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,851 - stpipe.Image2Pipeline - INFO - Finished processing product /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00001_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,851 - stpipe.Image2Pipeline - INFO - ... ending calwebb_image2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,852 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,972 - stpipe.Image2Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00001_mirimage_calints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,973 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:42,973 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,039 - stpipe - INFO - PARS-RESAMPLESTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-resamplestep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,049 - stpipe.Image2Pipeline - INFO - Image2Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,050 - stpipe.Image2Pipeline.bkg_subtract - INFO - BackgroundStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,051 - stpipe.Image2Pipeline.assign_wcs - INFO - AssignWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,052 - stpipe.Image2Pipeline.flat_field - INFO - FlatFieldStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,053 - stpipe.Image2Pipeline.photom - INFO - PhotomStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,054 - stpipe.Image2Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,204 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline running with args (&#39;./miri_coro_demo_data/Obs007/stage2/00002_l2asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,212 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./miri_coro_demo_data/Obs007/stage2
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_bsub: True
  steps:
    bkg_subtract:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bkg_list: None
      save_combined_background: True
      sigma: 3.0
      maxiters: None
      soss_source_percentile: 35.0
      soss_bkg_percentile: None
      wfss_mmag_extract: None
      wfss_maxiter: 5
      wfss_rms_stop: 0.0
      wfss_outlier_percent: 1.0
    assign_wcs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      sip_approx: True
      sip_max_pix_error: 0.01
      sip_degree: None
      sip_max_inv_pix_error: 0.01
      sip_inv_degree: None
      sip_npoints: 12
      slit_y_low: -0.55
      slit_y_high: 0.55
      nrs_ifu_slice_wcs: False
    flat_field:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      save_interpolated_flat: False
      user_supplied_flat: None
      inverse: False
    photom:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      inverse: False
      source_type: None
      mrs_time_correction: True
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: exptime
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: None
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      in_memory: True
      enable_ctx: True
      enable_err: True
      report_var: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,256 - stpipe.Image2Pipeline - INFO - Prefetching reference files for dataset: &#39;00002_l2asn.json&#39; reftypes = [&#39;area&#39;, &#39;bkg&#39;, &#39;camera&#39;, &#39;collimator&#39;, &#39;dflat&#39;, &#39;disperser&#39;, &#39;distortion&#39;, &#39;fflat&#39;, &#39;filteroffset&#39;, &#39;flat&#39;, &#39;fore&#39;, &#39;fpa&#39;, &#39;ifufore&#39;, &#39;ifupost&#39;, &#39;ifuslicer&#39;, &#39;msa&#39;, &#39;ote&#39;, &#39;photom&#39;, &#39;regions&#39;, &#39;sflat&#39;, &#39;specwcs&#39;, &#39;wavelengthrange&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,258 - stpipe.Image2Pipeline - INFO - Prefetch for AREA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,259 - stpipe.Image2Pipeline - INFO - Prefetch for BKG reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,259 - stpipe.Image2Pipeline - INFO - Prefetch for CAMERA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,260 - stpipe.Image2Pipeline - INFO - Prefetch for COLLIMATOR reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,260 - stpipe.Image2Pipeline - INFO - Prefetch for DFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,260 - stpipe.Image2Pipeline - INFO - Prefetch for DISPERSER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,261 - stpipe.Image2Pipeline - INFO - Prefetch for DISTORTION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,261 - stpipe.Image2Pipeline - INFO - Prefetch for FFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,261 - stpipe.Image2Pipeline - INFO - Prefetch for FILTEROFFSET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0007.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,262 - stpipe.Image2Pipeline - INFO - Prefetch for FLAT reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_flat_0768.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,262 - stpipe.Image2Pipeline - INFO - Prefetch for FORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,262 - stpipe.Image2Pipeline - INFO - Prefetch for FPA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,263 - stpipe.Image2Pipeline - INFO - Prefetch for IFUFORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,263 - stpipe.Image2Pipeline - INFO - Prefetch for IFUPOST reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,263 - stpipe.Image2Pipeline - INFO - Prefetch for IFUSLICER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,264 - stpipe.Image2Pipeline - INFO - Prefetch for MSA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,264 - stpipe.Image2Pipeline - INFO - Prefetch for OTE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,264 - stpipe.Image2Pipeline - INFO - Prefetch for PHOTOM reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,265 - stpipe.Image2Pipeline - INFO - Prefetch for REGIONS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,265 - stpipe.Image2Pipeline - INFO - Prefetch for SFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,265 - stpipe.Image2Pipeline - INFO - Prefetch for SPECWCS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,266 - stpipe.Image2Pipeline - INFO - Prefetch for WAVELENGTHRANGE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,266 - stpipe.Image2Pipeline - INFO - Starting calwebb_image2 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,272 - stpipe.Image2Pipeline - INFO - Processing product /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00002_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,273 - stpipe.Image2Pipeline - INFO - Working on input /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00002_mirimage_rateints.fits ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,468 - stpipe.Image2Pipeline.bkg_subtract - INFO - Step bkg_subtract running with args (&lt;CubeModel(19, 224, 288) from ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00002_mirimage_image2pipeline.fits&gt;, [&#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_02101_00001_mirimage_rateints.fits&#39;, &#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_03101_00001_mirimage_rateints.fits&#39;]).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,485 - jwst.background.asn_intake - INFO - Working on input &lt;CubeModel(19, 224, 288) from ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00002_mirimage_image2pipeline.fits&gt; ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,517 - jwst.background.background_sub - INFO - Accumulate bkg from /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_02101_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,636 - jwst.background.background_sub - INFO - Accumulate bkg from /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_03101_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,757 - jwst.background.background_sub - INFO - Subtracting avg bkg from ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00002_mirimage_image2pipeline.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,798 - stpipe.Image2Pipeline.bkg_subtract - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00002_mirimage_combinedbackground.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,798 - stpipe.Image2Pipeline.bkg_subtract - INFO - Combined background written to ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00002_mirimage_combinedbackground.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,867 - stpipe.Image2Pipeline.bkg_subtract - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00002_mirimage_bsubints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:43,867 - stpipe.Image2Pipeline.bkg_subtract - INFO - Step bkg_subtract done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,013 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00002_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,098 - jwst.assign_wcs.miri - INFO - Created a MIRI mir_4qpm pipeline with references {&#39;distortion&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;, &#39;filteroffset&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0007.asdf&#39;, &#39;specwcs&#39;: None, &#39;regions&#39;: None, &#39;wavelengthrange&#39;: None, &#39;camera&#39;: None, &#39;collimator&#39;: None, &#39;disperser&#39;: None, &#39;fore&#39;: None, &#39;fpa&#39;: None, &#39;msa&#39;: None, &#39;ote&#39;: None, &#39;ifupost&#39;: None, &#39;ifufore&#39;: None, &#39;ifuslicer&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,145 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  209.561516309 -42.103131492 209.570303898 -42.105359775 209.574242621 -42.097060636 209.565432820 -42.094807861
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,146 - jwst.assign_wcs.assign_wcs - INFO - assign_wcs updated S_REGION to POLYGON ICRS  209.561516309 -42.103131492 209.570303898 -42.105359775 209.574242621 -42.097060636 209.565432820 -42.094807861
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,147 - jwst.assign_wcs.assign_wcs - INFO - COMPLETED assign_wcs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,179 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,325 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00002_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,357 - stdatamodels.dynamicdq - WARNING - Keyword CDP_PARTIAL_DATA does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,357 - stdatamodels.dynamicdq - WARNING - Keyword CDP_LOW_QUAL does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,358 - stdatamodels.dynamicdq - WARNING - Keyword CDP_UNRELIABLE_ERROR does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,359 - stdatamodels.dynamicdq - WARNING - Keyword DIFF_PATTERN does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,360 - stpipe.Image2Pipeline.flat_field - INFO - Using FLAT reference file: /home/runner/crds/references/jwst/miri/jwst_miri_flat_0768.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,360 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type FFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,361 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type SFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,361 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type DFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,410 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,558 - stpipe.Image2Pipeline.photom - INFO - Step photom running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00002_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,569 - stpipe.Image2Pipeline.photom - INFO - Using photom reference file: /home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,570 - stpipe.Image2Pipeline.photom - INFO - Using area reference file: N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,596 - jwst.photom.photom - INFO - Using instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,596 - jwst.photom.photom - INFO -  detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,597 - jwst.photom.photom - INFO -  exp_type: MIR_4QPM
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,597 - jwst.photom.photom - INFO -  filter: F1550C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,613 - jwst.photom.photom - INFO - Attempting to obtain PIXAR_SR and PIXAR_A2 values from PHOTOM reference file.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,613 - jwst.photom.photom - INFO - Values for PIXAR_SR and PIXAR_A2 obtained from PHOTOM reference file.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,614 - jwst.photom.photom - INFO -  subarray: MASK1550
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,615 - jwst.photom.photom - INFO - Applying the time-dependent correction to the PHOTOM value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,619 - jwst.photom.photom - INFO - PHOTMJSR value: 3.78942
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,636 - stpipe.Image2Pipeline.photom - INFO - Step photom done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,639 - stpipe.Image2Pipeline - INFO - Finished processing product /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00002_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,639 - stpipe.Image2Pipeline - INFO - ... ending calwebb_image2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,640 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,761 - stpipe.Image2Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00002_mirimage_calints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,762 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,762 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,828 - stpipe - INFO - PARS-RESAMPLESTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-resamplestep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,839 - stpipe.Image2Pipeline - INFO - Image2Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,840 - stpipe.Image2Pipeline.bkg_subtract - INFO - BackgroundStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,841 - stpipe.Image2Pipeline.assign_wcs - INFO - AssignWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,842 - stpipe.Image2Pipeline.flat_field - INFO - FlatFieldStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,843 - stpipe.Image2Pipeline.photom - INFO - PhotomStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,844 - stpipe.Image2Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:44,993 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline running with args (&#39;./miri_coro_demo_data/Obs007/stage2/00003_l2asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,001 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./miri_coro_demo_data/Obs007/stage2
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_bsub: True
  steps:
    bkg_subtract:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bkg_list: None
      save_combined_background: True
      sigma: 3.0
      maxiters: None
      soss_source_percentile: 35.0
      soss_bkg_percentile: None
      wfss_mmag_extract: None
      wfss_maxiter: 5
      wfss_rms_stop: 0.0
      wfss_outlier_percent: 1.0
    assign_wcs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      sip_approx: True
      sip_max_pix_error: 0.01
      sip_degree: None
      sip_max_inv_pix_error: 0.01
      sip_inv_degree: None
      sip_npoints: 12
      slit_y_low: -0.55
      slit_y_high: 0.55
      nrs_ifu_slice_wcs: False
    flat_field:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      save_interpolated_flat: False
      user_supplied_flat: None
      inverse: False
    photom:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      inverse: False
      source_type: None
      mrs_time_correction: True
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: exptime
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: None
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      in_memory: True
      enable_ctx: True
      enable_err: True
      report_var: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,044 - stpipe.Image2Pipeline - INFO - Prefetching reference files for dataset: &#39;00003_l2asn.json&#39; reftypes = [&#39;area&#39;, &#39;bkg&#39;, &#39;camera&#39;, &#39;collimator&#39;, &#39;dflat&#39;, &#39;disperser&#39;, &#39;distortion&#39;, &#39;fflat&#39;, &#39;filteroffset&#39;, &#39;flat&#39;, &#39;fore&#39;, &#39;fpa&#39;, &#39;ifufore&#39;, &#39;ifupost&#39;, &#39;ifuslicer&#39;, &#39;msa&#39;, &#39;ote&#39;, &#39;photom&#39;, &#39;regions&#39;, &#39;sflat&#39;, &#39;specwcs&#39;, &#39;wavelengthrange&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,047 - stpipe.Image2Pipeline - INFO - Prefetch for AREA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,047 - stpipe.Image2Pipeline - INFO - Prefetch for BKG reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,047 - stpipe.Image2Pipeline - INFO - Prefetch for CAMERA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,048 - stpipe.Image2Pipeline - INFO - Prefetch for COLLIMATOR reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,048 - stpipe.Image2Pipeline - INFO - Prefetch for DFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,048 - stpipe.Image2Pipeline - INFO - Prefetch for DISPERSER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,049 - stpipe.Image2Pipeline - INFO - Prefetch for DISTORTION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,049 - stpipe.Image2Pipeline - INFO - Prefetch for FFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,050 - stpipe.Image2Pipeline - INFO - Prefetch for FILTEROFFSET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0007.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,050 - stpipe.Image2Pipeline - INFO - Prefetch for FLAT reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_flat_0768.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,050 - stpipe.Image2Pipeline - INFO - Prefetch for FORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,051 - stpipe.Image2Pipeline - INFO - Prefetch for FPA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,051 - stpipe.Image2Pipeline - INFO - Prefetch for IFUFORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,051 - stpipe.Image2Pipeline - INFO - Prefetch for IFUPOST reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,052 - stpipe.Image2Pipeline - INFO - Prefetch for IFUSLICER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,052 - stpipe.Image2Pipeline - INFO - Prefetch for MSA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,052 - stpipe.Image2Pipeline - INFO - Prefetch for OTE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,053 - stpipe.Image2Pipeline - INFO - Prefetch for PHOTOM reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,053 - stpipe.Image2Pipeline - INFO - Prefetch for REGIONS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,053 - stpipe.Image2Pipeline - INFO - Prefetch for SFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,054 - stpipe.Image2Pipeline - INFO - Prefetch for SPECWCS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,054 - stpipe.Image2Pipeline - INFO - Prefetch for WAVELENGTHRANGE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,055 - stpipe.Image2Pipeline - INFO - Starting calwebb_image2 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,060 - stpipe.Image2Pipeline - INFO - Processing product /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00003_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,061 - stpipe.Image2Pipeline - INFO - Working on input /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00003_mirimage_rateints.fits ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,262 - stpipe.Image2Pipeline.bkg_subtract - INFO - Step bkg_subtract running with args (&lt;CubeModel(19, 224, 288) from ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00003_mirimage_image2pipeline.fits&gt;, [&#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_02101_00001_mirimage_rateints.fits&#39;, &#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_03101_00001_mirimage_rateints.fits&#39;]).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,279 - jwst.background.asn_intake - INFO - Working on input &lt;CubeModel(19, 224, 288) from ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00003_mirimage_image2pipeline.fits&gt; ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,311 - jwst.background.background_sub - INFO - Accumulate bkg from /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_02101_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,431 - jwst.background.background_sub - INFO - Accumulate bkg from /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_03101_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,550 - jwst.background.background_sub - INFO - Subtracting avg bkg from ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00003_mirimage_image2pipeline.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,590 - stpipe.Image2Pipeline.bkg_subtract - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00003_mirimage_combinedbackground.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,591 - stpipe.Image2Pipeline.bkg_subtract - INFO - Combined background written to ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00003_mirimage_combinedbackground.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,658 - stpipe.Image2Pipeline.bkg_subtract - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00003_mirimage_bsubints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,659 - stpipe.Image2Pipeline.bkg_subtract - INFO - Step bkg_subtract done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,802 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00003_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,886 - jwst.assign_wcs.miri - INFO - Created a MIRI mir_4qpm pipeline with references {&#39;distortion&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;, &#39;filteroffset&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0007.asdf&#39;, &#39;specwcs&#39;: None, &#39;regions&#39;: None, &#39;wavelengthrange&#39;: None, &#39;camera&#39;: None, &#39;collimator&#39;: None, &#39;disperser&#39;: None, &#39;fore&#39;: None, &#39;fpa&#39;: None, &#39;msa&#39;: None, &#39;ote&#39;: None, &#39;ifupost&#39;: None, &#39;ifufore&#39;: None, &#39;ifuslicer&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,934 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  209.561512780 -42.103130585 209.570300368 -42.105358868 209.574239092 -42.097059729 209.565429292 -42.094806954
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,935 - jwst.assign_wcs.assign_wcs - INFO - assign_wcs updated S_REGION to POLYGON ICRS  209.561512780 -42.103130585 209.570300368 -42.105358868 209.574239092 -42.097059729 209.565429292 -42.094806954
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,936 - jwst.assign_wcs.assign_wcs - INFO - COMPLETED assign_wcs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:45,968 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,113 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00003_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,145 - stdatamodels.dynamicdq - WARNING - Keyword CDP_PARTIAL_DATA does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,146 - stdatamodels.dynamicdq - WARNING - Keyword CDP_LOW_QUAL does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,147 - stdatamodels.dynamicdq - WARNING - Keyword CDP_UNRELIABLE_ERROR does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,147 - stdatamodels.dynamicdq - WARNING - Keyword DIFF_PATTERN does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,148 - stpipe.Image2Pipeline.flat_field - INFO - Using FLAT reference file: /home/runner/crds/references/jwst/miri/jwst_miri_flat_0768.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,149 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type FFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,149 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type SFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,149 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type DFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,198 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,349 - stpipe.Image2Pipeline.photom - INFO - Step photom running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00003_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,360 - stpipe.Image2Pipeline.photom - INFO - Using photom reference file: /home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,361 - stpipe.Image2Pipeline.photom - INFO - Using area reference file: N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,386 - jwst.photom.photom - INFO - Using instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,387 - jwst.photom.photom - INFO -  detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,387 - jwst.photom.photom - INFO -  exp_type: MIR_4QPM
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,388 - jwst.photom.photom - INFO -  filter: F1550C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,403 - jwst.photom.photom - INFO - Attempting to obtain PIXAR_SR and PIXAR_A2 values from PHOTOM reference file.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,403 - jwst.photom.photom - INFO - Values for PIXAR_SR and PIXAR_A2 obtained from PHOTOM reference file.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,404 - jwst.photom.photom - INFO -  subarray: MASK1550
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,405 - jwst.photom.photom - INFO - Applying the time-dependent correction to the PHOTOM value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,409 - jwst.photom.photom - INFO - PHOTMJSR value: 3.78942
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,427 - stpipe.Image2Pipeline.photom - INFO - Step photom done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,429 - stpipe.Image2Pipeline - INFO - Finished processing product /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00003_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,430 - stpipe.Image2Pipeline - INFO - ... ending calwebb_image2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,430 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,551 - stpipe.Image2Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00003_mirimage_calints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,551 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,552 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,617 - stpipe - INFO - PARS-RESAMPLESTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-resamplestep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,628 - stpipe.Image2Pipeline - INFO - Image2Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,629 - stpipe.Image2Pipeline.bkg_subtract - INFO - BackgroundStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,630 - stpipe.Image2Pipeline.assign_wcs - INFO - AssignWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,631 - stpipe.Image2Pipeline.flat_field - INFO - FlatFieldStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,632 - stpipe.Image2Pipeline.photom - INFO - PhotomStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,633 - stpipe.Image2Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,784 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline running with args (&#39;./miri_coro_demo_data/Obs007/stage2/00004_l2asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,791 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./miri_coro_demo_data/Obs007/stage2
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_bsub: True
  steps:
    bkg_subtract:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bkg_list: None
      save_combined_background: True
      sigma: 3.0
      maxiters: None
      soss_source_percentile: 35.0
      soss_bkg_percentile: None
      wfss_mmag_extract: None
      wfss_maxiter: 5
      wfss_rms_stop: 0.0
      wfss_outlier_percent: 1.0
    assign_wcs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      sip_approx: True
      sip_max_pix_error: 0.01
      sip_degree: None
      sip_max_inv_pix_error: 0.01
      sip_inv_degree: None
      sip_npoints: 12
      slit_y_low: -0.55
      slit_y_high: 0.55
      nrs_ifu_slice_wcs: False
    flat_field:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      save_interpolated_flat: False
      user_supplied_flat: None
      inverse: False
    photom:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      inverse: False
      source_type: None
      mrs_time_correction: True
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: exptime
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: None
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      in_memory: True
      enable_ctx: True
      enable_err: True
      report_var: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,835 - stpipe.Image2Pipeline - INFO - Prefetching reference files for dataset: &#39;00004_l2asn.json&#39; reftypes = [&#39;area&#39;, &#39;bkg&#39;, &#39;camera&#39;, &#39;collimator&#39;, &#39;dflat&#39;, &#39;disperser&#39;, &#39;distortion&#39;, &#39;fflat&#39;, &#39;filteroffset&#39;, &#39;flat&#39;, &#39;fore&#39;, &#39;fpa&#39;, &#39;ifufore&#39;, &#39;ifupost&#39;, &#39;ifuslicer&#39;, &#39;msa&#39;, &#39;ote&#39;, &#39;photom&#39;, &#39;regions&#39;, &#39;sflat&#39;, &#39;specwcs&#39;, &#39;wavelengthrange&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,838 - stpipe.Image2Pipeline - INFO - Prefetch for AREA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,838 - stpipe.Image2Pipeline - INFO - Prefetch for BKG reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,838 - stpipe.Image2Pipeline - INFO - Prefetch for CAMERA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,839 - stpipe.Image2Pipeline - INFO - Prefetch for COLLIMATOR reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,839 - stpipe.Image2Pipeline - INFO - Prefetch for DFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,839 - stpipe.Image2Pipeline - INFO - Prefetch for DISPERSER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,840 - stpipe.Image2Pipeline - INFO - Prefetch for DISTORTION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,840 - stpipe.Image2Pipeline - INFO - Prefetch for FFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,841 - stpipe.Image2Pipeline - INFO - Prefetch for FILTEROFFSET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0007.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,841 - stpipe.Image2Pipeline - INFO - Prefetch for FLAT reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_flat_0768.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,841 - stpipe.Image2Pipeline - INFO - Prefetch for FORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,842 - stpipe.Image2Pipeline - INFO - Prefetch for FPA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,842 - stpipe.Image2Pipeline - INFO - Prefetch for IFUFORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,842 - stpipe.Image2Pipeline - INFO - Prefetch for IFUPOST reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,843 - stpipe.Image2Pipeline - INFO - Prefetch for IFUSLICER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,843 - stpipe.Image2Pipeline - INFO - Prefetch for MSA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,843 - stpipe.Image2Pipeline - INFO - Prefetch for OTE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,844 - stpipe.Image2Pipeline - INFO - Prefetch for PHOTOM reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,844 - stpipe.Image2Pipeline - INFO - Prefetch for REGIONS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,844 - stpipe.Image2Pipeline - INFO - Prefetch for SFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,844 - stpipe.Image2Pipeline - INFO - Prefetch for SPECWCS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,845 - stpipe.Image2Pipeline - INFO - Prefetch for WAVELENGTHRANGE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,845 - stpipe.Image2Pipeline - INFO - Starting calwebb_image2 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,851 - stpipe.Image2Pipeline - INFO - Processing product /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00004_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:46,852 - stpipe.Image2Pipeline - INFO - Working on input /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00004_mirimage_rateints.fits ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:47,044 - stpipe.Image2Pipeline.bkg_subtract - INFO - Step bkg_subtract running with args (&lt;CubeModel(19, 224, 288) from ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00004_mirimage_image2pipeline.fits&gt;, [&#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_02101_00001_mirimage_rateints.fits&#39;, &#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_03101_00001_mirimage_rateints.fits&#39;]).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:47,061 - jwst.background.asn_intake - INFO - Working on input &lt;CubeModel(19, 224, 288) from ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00004_mirimage_image2pipeline.fits&gt; ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:47,093 - jwst.background.background_sub - INFO - Accumulate bkg from /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_02101_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:47,213 - jwst.background.background_sub - INFO - Accumulate bkg from /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_03101_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:47,333 - jwst.background.background_sub - INFO - Subtracting avg bkg from ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00004_mirimage_image2pipeline.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:47,373 - stpipe.Image2Pipeline.bkg_subtract - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00004_mirimage_combinedbackground.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:47,374 - stpipe.Image2Pipeline.bkg_subtract - INFO - Combined background written to ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00004_mirimage_combinedbackground.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:47,441 - stpipe.Image2Pipeline.bkg_subtract - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00004_mirimage_bsubints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:47,442 - stpipe.Image2Pipeline.bkg_subtract - INFO - Step bkg_subtract done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:47,586 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00004_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:47,670 - jwst.assign_wcs.miri - INFO - Created a MIRI mir_4qpm pipeline with references {&#39;distortion&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;, &#39;filteroffset&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0007.asdf&#39;, &#39;specwcs&#39;: None, &#39;regions&#39;: None, &#39;wavelengthrange&#39;: None, &#39;camera&#39;: None, &#39;collimator&#39;: None, &#39;disperser&#39;: None, &#39;fore&#39;: None, &#39;fpa&#39;: None, &#39;msa&#39;: None, &#39;ote&#39;: None, &#39;ifupost&#39;: None, &#39;ifufore&#39;: None, &#39;ifuslicer&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:47,718 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  209.561511543 -42.103133205 209.570299132 -42.105361488 209.574237856 -42.097062349 209.565428056 -42.094809574
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:47,719 - jwst.assign_wcs.assign_wcs - INFO - assign_wcs updated S_REGION to POLYGON ICRS  209.561511543 -42.103133205 209.570299132 -42.105361488 209.574237856 -42.097062349 209.565428056 -42.094809574
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:47,719 - jwst.assign_wcs.assign_wcs - INFO - COMPLETED assign_wcs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:47,751 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:47,909 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00004_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:47,940 - stdatamodels.dynamicdq - WARNING - Keyword CDP_PARTIAL_DATA does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:47,941 - stdatamodels.dynamicdq - WARNING - Keyword CDP_LOW_QUAL does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:47,941 - stdatamodels.dynamicdq - WARNING - Keyword CDP_UNRELIABLE_ERROR does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:47,942 - stdatamodels.dynamicdq - WARNING - Keyword DIFF_PATTERN does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:47,943 - stpipe.Image2Pipeline.flat_field - INFO - Using FLAT reference file: /home/runner/crds/references/jwst/miri/jwst_miri_flat_0768.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:47,944 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type FFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:47,944 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type SFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:47,944 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type DFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:47,993 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,143 - stpipe.Image2Pipeline.photom - INFO - Step photom running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00004_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,154 - stpipe.Image2Pipeline.photom - INFO - Using photom reference file: /home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,155 - stpipe.Image2Pipeline.photom - INFO - Using area reference file: N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,181 - jwst.photom.photom - INFO - Using instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,181 - jwst.photom.photom - INFO -  detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,181 - jwst.photom.photom - INFO -  exp_type: MIR_4QPM
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,182 - jwst.photom.photom - INFO -  filter: F1550C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,197 - jwst.photom.photom - INFO - Attempting to obtain PIXAR_SR and PIXAR_A2 values from PHOTOM reference file.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,198 - jwst.photom.photom - INFO - Values for PIXAR_SR and PIXAR_A2 obtained from PHOTOM reference file.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,199 - jwst.photom.photom - INFO -  subarray: MASK1550
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,200 - jwst.photom.photom - INFO - Applying the time-dependent correction to the PHOTOM value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,204 - jwst.photom.photom - INFO - PHOTMJSR value: 3.78943
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,221 - stpipe.Image2Pipeline.photom - INFO - Step photom done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,224 - stpipe.Image2Pipeline - INFO - Finished processing product /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00004_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,224 - stpipe.Image2Pipeline - INFO - ... ending calwebb_image2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,225 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,345 - stpipe.Image2Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00004_mirimage_calints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,345 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,346 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,412 - stpipe - INFO - PARS-RESAMPLESTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-resamplestep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,423 - stpipe.Image2Pipeline - INFO - Image2Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,424 - stpipe.Image2Pipeline.bkg_subtract - INFO - BackgroundStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,425 - stpipe.Image2Pipeline.assign_wcs - INFO - AssignWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,426 - stpipe.Image2Pipeline.flat_field - INFO - FlatFieldStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,427 - stpipe.Image2Pipeline.photom - INFO - PhotomStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,428 - stpipe.Image2Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,579 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline running with args (&#39;./miri_coro_demo_data/Obs007/stage2/00005_l2asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,588 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./miri_coro_demo_data/Obs007/stage2
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_bsub: True
  steps:
    bkg_subtract:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bkg_list: None
      save_combined_background: True
      sigma: 3.0
      maxiters: None
      soss_source_percentile: 35.0
      soss_bkg_percentile: None
      wfss_mmag_extract: None
      wfss_maxiter: 5
      wfss_rms_stop: 0.0
      wfss_outlier_percent: 1.0
    assign_wcs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      sip_approx: True
      sip_max_pix_error: 0.01
      sip_degree: None
      sip_max_inv_pix_error: 0.01
      sip_inv_degree: None
      sip_npoints: 12
      slit_y_low: -0.55
      slit_y_high: 0.55
      nrs_ifu_slice_wcs: False
    flat_field:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      save_interpolated_flat: False
      user_supplied_flat: None
      inverse: False
    photom:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      inverse: False
      source_type: None
      mrs_time_correction: True
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: exptime
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: None
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      in_memory: True
      enable_ctx: True
      enable_err: True
      report_var: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,631 - stpipe.Image2Pipeline - INFO - Prefetching reference files for dataset: &#39;00005_l2asn.json&#39; reftypes = [&#39;area&#39;, &#39;bkg&#39;, &#39;camera&#39;, &#39;collimator&#39;, &#39;dflat&#39;, &#39;disperser&#39;, &#39;distortion&#39;, &#39;fflat&#39;, &#39;filteroffset&#39;, &#39;flat&#39;, &#39;fore&#39;, &#39;fpa&#39;, &#39;ifufore&#39;, &#39;ifupost&#39;, &#39;ifuslicer&#39;, &#39;msa&#39;, &#39;ote&#39;, &#39;photom&#39;, &#39;regions&#39;, &#39;sflat&#39;, &#39;specwcs&#39;, &#39;wavelengthrange&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,633 - stpipe.Image2Pipeline - INFO - Prefetch for AREA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,634 - stpipe.Image2Pipeline - INFO - Prefetch for BKG reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,634 - stpipe.Image2Pipeline - INFO - Prefetch for CAMERA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,634 - stpipe.Image2Pipeline - INFO - Prefetch for COLLIMATOR reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,635 - stpipe.Image2Pipeline - INFO - Prefetch for DFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,635 - stpipe.Image2Pipeline - INFO - Prefetch for DISPERSER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,635 - stpipe.Image2Pipeline - INFO - Prefetch for DISTORTION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,636 - stpipe.Image2Pipeline - INFO - Prefetch for FFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,636 - stpipe.Image2Pipeline - INFO - Prefetch for FILTEROFFSET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0007.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,637 - stpipe.Image2Pipeline - INFO - Prefetch for FLAT reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_flat_0768.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,637 - stpipe.Image2Pipeline - INFO - Prefetch for FORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,637 - stpipe.Image2Pipeline - INFO - Prefetch for FPA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,638 - stpipe.Image2Pipeline - INFO - Prefetch for IFUFORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,638 - stpipe.Image2Pipeline - INFO - Prefetch for IFUPOST reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,638 - stpipe.Image2Pipeline - INFO - Prefetch for IFUSLICER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,639 - stpipe.Image2Pipeline - INFO - Prefetch for MSA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,639 - stpipe.Image2Pipeline - INFO - Prefetch for OTE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,639 - stpipe.Image2Pipeline - INFO - Prefetch for PHOTOM reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,640 - stpipe.Image2Pipeline - INFO - Prefetch for REGIONS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,640 - stpipe.Image2Pipeline - INFO - Prefetch for SFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,641 - stpipe.Image2Pipeline - INFO - Prefetch for SPECWCS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,641 - stpipe.Image2Pipeline - INFO - Prefetch for WAVELENGTHRANGE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,641 - stpipe.Image2Pipeline - INFO - Starting calwebb_image2 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,648 - stpipe.Image2Pipeline - INFO - Processing product /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00005_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,648 - stpipe.Image2Pipeline - INFO - Working on input /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00005_mirimage_rateints.fits ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,838 - stpipe.Image2Pipeline.bkg_subtract - INFO - Step bkg_subtract running with args (&lt;CubeModel(19, 224, 288) from ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00005_mirimage_image2pipeline.fits&gt;, [&#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_02101_00001_mirimage_rateints.fits&#39;, &#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_03101_00001_mirimage_rateints.fits&#39;]).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,856 - jwst.background.asn_intake - INFO - Working on input &lt;CubeModel(19, 224, 288) from ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00005_mirimage_image2pipeline.fits&gt; ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:48,887 - jwst.background.background_sub - INFO - Accumulate bkg from /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_02101_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,008 - jwst.background.background_sub - INFO - Accumulate bkg from /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_03101_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,128 - jwst.background.background_sub - INFO - Subtracting avg bkg from ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00005_mirimage_image2pipeline.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,169 - stpipe.Image2Pipeline.bkg_subtract - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00005_mirimage_combinedbackground.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,170 - stpipe.Image2Pipeline.bkg_subtract - INFO - Combined background written to ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00005_mirimage_combinedbackground.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,238 - stpipe.Image2Pipeline.bkg_subtract - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00005_mirimage_bsubints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,238 - stpipe.Image2Pipeline.bkg_subtract - INFO - Step bkg_subtract done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,391 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00005_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,476 - jwst.assign_wcs.miri - INFO - Created a MIRI mir_4qpm pipeline with references {&#39;distortion&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;, &#39;filteroffset&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0007.asdf&#39;, &#39;specwcs&#39;: None, &#39;regions&#39;: None, &#39;wavelengthrange&#39;: None, &#39;camera&#39;: None, &#39;collimator&#39;: None, &#39;disperser&#39;: None, &#39;fore&#39;: None, &#39;fpa&#39;: None, &#39;msa&#39;: None, &#39;ote&#39;: None, &#39;ifupost&#39;: None, &#39;ifufore&#39;: None, &#39;ifuslicer&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,524 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  209.561510300 -42.103135828 209.570297890 -42.105364110 209.574236614 -42.097064972 209.565426813 -42.094812197
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,524 - jwst.assign_wcs.assign_wcs - INFO - assign_wcs updated S_REGION to POLYGON ICRS  209.561510300 -42.103135828 209.570297890 -42.105364110 209.574236614 -42.097064972 209.565426813 -42.094812197
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,525 - jwst.assign_wcs.assign_wcs - INFO - COMPLETED assign_wcs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,557 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,708 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00005_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,740 - stdatamodels.dynamicdq - WARNING - Keyword CDP_PARTIAL_DATA does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,741 - stdatamodels.dynamicdq - WARNING - Keyword CDP_LOW_QUAL does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,741 - stdatamodels.dynamicdq - WARNING - Keyword CDP_UNRELIABLE_ERROR does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,742 - stdatamodels.dynamicdq - WARNING - Keyword DIFF_PATTERN does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,743 - stpipe.Image2Pipeline.flat_field - INFO - Using FLAT reference file: /home/runner/crds/references/jwst/miri/jwst_miri_flat_0768.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,744 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type FFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,744 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type SFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,744 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type DFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,793 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,943 - stpipe.Image2Pipeline.photom - INFO - Step photom running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00005_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,953 - stpipe.Image2Pipeline.photom - INFO - Using photom reference file: /home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,954 - stpipe.Image2Pipeline.photom - INFO - Using area reference file: N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,980 - jwst.photom.photom - INFO - Using instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,980 - jwst.photom.photom - INFO -  detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,981 - jwst.photom.photom - INFO -  exp_type: MIR_4QPM
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,981 - jwst.photom.photom - INFO -  filter: F1550C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,997 - jwst.photom.photom - INFO - Attempting to obtain PIXAR_SR and PIXAR_A2 values from PHOTOM reference file.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,997 - jwst.photom.photom - INFO - Values for PIXAR_SR and PIXAR_A2 obtained from PHOTOM reference file.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,998 - jwst.photom.photom - INFO -  subarray: MASK1550
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:49,999 - jwst.photom.photom - INFO - Applying the time-dependent correction to the PHOTOM value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,003 - jwst.photom.photom - INFO - PHOTMJSR value: 3.78943
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,021 - stpipe.Image2Pipeline.photom - INFO - Step photom done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,022 - stpipe.Image2Pipeline - INFO - Finished processing product /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00005_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,022 - stpipe.Image2Pipeline - INFO - ... ending calwebb_image2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,023 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,142 - stpipe.Image2Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00005_mirimage_calints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,143 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,144 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,209 - stpipe - INFO - PARS-RESAMPLESTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-resamplestep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,220 - stpipe.Image2Pipeline - INFO - Image2Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,221 - stpipe.Image2Pipeline.bkg_subtract - INFO - BackgroundStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,222 - stpipe.Image2Pipeline.assign_wcs - INFO - AssignWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,223 - stpipe.Image2Pipeline.flat_field - INFO - FlatFieldStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,224 - stpipe.Image2Pipeline.photom - INFO - PhotomStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,225 - stpipe.Image2Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,379 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline running with args (&#39;./miri_coro_demo_data/Obs007/stage2/00006_l2asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,386 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./miri_coro_demo_data/Obs007/stage2
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_bsub: True
  steps:
    bkg_subtract:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bkg_list: None
      save_combined_background: True
      sigma: 3.0
      maxiters: None
      soss_source_percentile: 35.0
      soss_bkg_percentile: None
      wfss_mmag_extract: None
      wfss_maxiter: 5
      wfss_rms_stop: 0.0
      wfss_outlier_percent: 1.0
    assign_wcs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      sip_approx: True
      sip_max_pix_error: 0.01
      sip_degree: None
      sip_max_inv_pix_error: 0.01
      sip_inv_degree: None
      sip_npoints: 12
      slit_y_low: -0.55
      slit_y_high: 0.55
      nrs_ifu_slice_wcs: False
    flat_field:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      save_interpolated_flat: False
      user_supplied_flat: None
      inverse: False
    photom:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      inverse: False
      source_type: None
      mrs_time_correction: True
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: exptime
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: None
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      in_memory: True
      enable_ctx: True
      enable_err: True
      report_var: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,430 - stpipe.Image2Pipeline - INFO - Prefetching reference files for dataset: &#39;00006_l2asn.json&#39; reftypes = [&#39;area&#39;, &#39;bkg&#39;, &#39;camera&#39;, &#39;collimator&#39;, &#39;dflat&#39;, &#39;disperser&#39;, &#39;distortion&#39;, &#39;fflat&#39;, &#39;filteroffset&#39;, &#39;flat&#39;, &#39;fore&#39;, &#39;fpa&#39;, &#39;ifufore&#39;, &#39;ifupost&#39;, &#39;ifuslicer&#39;, &#39;msa&#39;, &#39;ote&#39;, &#39;photom&#39;, &#39;regions&#39;, &#39;sflat&#39;, &#39;specwcs&#39;, &#39;wavelengthrange&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,432 - stpipe.Image2Pipeline - INFO - Prefetch for AREA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,433 - stpipe.Image2Pipeline - INFO - Prefetch for BKG reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,433 - stpipe.Image2Pipeline - INFO - Prefetch for CAMERA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,434 - stpipe.Image2Pipeline - INFO - Prefetch for COLLIMATOR reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,434 - stpipe.Image2Pipeline - INFO - Prefetch for DFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,434 - stpipe.Image2Pipeline - INFO - Prefetch for DISPERSER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,435 - stpipe.Image2Pipeline - INFO - Prefetch for DISTORTION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,435 - stpipe.Image2Pipeline - INFO - Prefetch for FFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,436 - stpipe.Image2Pipeline - INFO - Prefetch for FILTEROFFSET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0007.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,436 - stpipe.Image2Pipeline - INFO - Prefetch for FLAT reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_flat_0768.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,436 - stpipe.Image2Pipeline - INFO - Prefetch for FORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,437 - stpipe.Image2Pipeline - INFO - Prefetch for FPA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,437 - stpipe.Image2Pipeline - INFO - Prefetch for IFUFORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,437 - stpipe.Image2Pipeline - INFO - Prefetch for IFUPOST reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,438 - stpipe.Image2Pipeline - INFO - Prefetch for IFUSLICER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,438 - stpipe.Image2Pipeline - INFO - Prefetch for MSA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,438 - stpipe.Image2Pipeline - INFO - Prefetch for OTE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,439 - stpipe.Image2Pipeline - INFO - Prefetch for PHOTOM reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,439 - stpipe.Image2Pipeline - INFO - Prefetch for REGIONS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,439 - stpipe.Image2Pipeline - INFO - Prefetch for SFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,440 - stpipe.Image2Pipeline - INFO - Prefetch for SPECWCS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,440 - stpipe.Image2Pipeline - INFO - Prefetch for WAVELENGTHRANGE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,440 - stpipe.Image2Pipeline - INFO - Starting calwebb_image2 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,447 - stpipe.Image2Pipeline - INFO - Processing product /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00006_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,447 - stpipe.Image2Pipeline - INFO - Working on input /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00006_mirimage_rateints.fits ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,642 - stpipe.Image2Pipeline.bkg_subtract - INFO - Step bkg_subtract running with args (&lt;CubeModel(19, 224, 288) from ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00006_mirimage_image2pipeline.fits&gt;, [&#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_02101_00001_mirimage_rateints.fits&#39;, &#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_03101_00001_mirimage_rateints.fits&#39;]).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,660 - jwst.background.asn_intake - INFO - Working on input &lt;CubeModel(19, 224, 288) from ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00006_mirimage_image2pipeline.fits&gt; ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,692 - jwst.background.background_sub - INFO - Accumulate bkg from /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_02101_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,812 - jwst.background.background_sub - INFO - Accumulate bkg from /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_03101_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,932 - jwst.background.background_sub - INFO - Subtracting avg bkg from ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00006_mirimage_image2pipeline.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,972 - stpipe.Image2Pipeline.bkg_subtract - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00006_mirimage_combinedbackground.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:50,973 - stpipe.Image2Pipeline.bkg_subtract - INFO - Combined background written to ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00006_mirimage_combinedbackground.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,040 - stpipe.Image2Pipeline.bkg_subtract - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00006_mirimage_bsubints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,041 - stpipe.Image2Pipeline.bkg_subtract - INFO - Step bkg_subtract done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,192 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00006_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,277 - jwst.assign_wcs.miri - INFO - Created a MIRI mir_4qpm pipeline with references {&#39;distortion&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;, &#39;filteroffset&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0007.asdf&#39;, &#39;specwcs&#39;: None, &#39;regions&#39;: None, &#39;wavelengthrange&#39;: None, &#39;camera&#39;: None, &#39;collimator&#39;: None, &#39;disperser&#39;: None, &#39;fore&#39;: None, &#39;fpa&#39;: None, &#39;msa&#39;: None, &#39;ote&#39;: None, &#39;ifupost&#39;: None, &#39;ifufore&#39;: None, &#39;ifuslicer&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,325 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  209.561513841 -42.103136737 209.570301430 -42.105365019 209.574240154 -42.097065880 209.565430353 -42.094813106
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,325 - jwst.assign_wcs.assign_wcs - INFO - assign_wcs updated S_REGION to POLYGON ICRS  209.561513841 -42.103136737 209.570301430 -42.105365019 209.574240154 -42.097065880 209.565430353 -42.094813106
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,326 - jwst.assign_wcs.assign_wcs - INFO - COMPLETED assign_wcs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,358 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,504 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00006_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,536 - stdatamodels.dynamicdq - WARNING - Keyword CDP_PARTIAL_DATA does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,537 - stdatamodels.dynamicdq - WARNING - Keyword CDP_LOW_QUAL does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,537 - stdatamodels.dynamicdq - WARNING - Keyword CDP_UNRELIABLE_ERROR does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,538 - stdatamodels.dynamicdq - WARNING - Keyword DIFF_PATTERN does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,539 - stpipe.Image2Pipeline.flat_field - INFO - Using FLAT reference file: /home/runner/crds/references/jwst/miri/jwst_miri_flat_0768.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,539 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type FFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,540 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type SFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,540 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type DFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,589 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,740 - stpipe.Image2Pipeline.photom - INFO - Step photom running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00006_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,751 - stpipe.Image2Pipeline.photom - INFO - Using photom reference file: /home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,751 - stpipe.Image2Pipeline.photom - INFO - Using area reference file: N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,777 - jwst.photom.photom - INFO - Using instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,778 - jwst.photom.photom - INFO -  detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,778 - jwst.photom.photom - INFO -  exp_type: MIR_4QPM
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,779 - jwst.photom.photom - INFO -  filter: F1550C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,794 - jwst.photom.photom - INFO - Attempting to obtain PIXAR_SR and PIXAR_A2 values from PHOTOM reference file.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,795 - jwst.photom.photom - INFO - Values for PIXAR_SR and PIXAR_A2 obtained from PHOTOM reference file.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,795 - jwst.photom.photom - INFO -  subarray: MASK1550
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,796 - jwst.photom.photom - INFO - Applying the time-dependent correction to the PHOTOM value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,800 - jwst.photom.photom - INFO - PHOTMJSR value: 3.78943
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,818 - stpipe.Image2Pipeline.photom - INFO - Step photom done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,819 - stpipe.Image2Pipeline - INFO - Finished processing product /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00006_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,819 - stpipe.Image2Pipeline - INFO - ... ending calwebb_image2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,820 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,939 - stpipe.Image2Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00006_mirimage_calints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,940 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:51,940 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,006 - stpipe - INFO - PARS-RESAMPLESTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-resamplestep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,016 - stpipe.Image2Pipeline - INFO - Image2Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,017 - stpipe.Image2Pipeline.bkg_subtract - INFO - BackgroundStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,018 - stpipe.Image2Pipeline.assign_wcs - INFO - AssignWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,019 - stpipe.Image2Pipeline.flat_field - INFO - FlatFieldStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,020 - stpipe.Image2Pipeline.photom - INFO - PhotomStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,021 - stpipe.Image2Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,177 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline running with args (&#39;./miri_coro_demo_data/Obs007/stage2/00007_l2asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,184 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./miri_coro_demo_data/Obs007/stage2
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_bsub: True
  steps:
    bkg_subtract:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bkg_list: None
      save_combined_background: True
      sigma: 3.0
      maxiters: None
      soss_source_percentile: 35.0
      soss_bkg_percentile: None
      wfss_mmag_extract: None
      wfss_maxiter: 5
      wfss_rms_stop: 0.0
      wfss_outlier_percent: 1.0
    assign_wcs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      sip_approx: True
      sip_max_pix_error: 0.01
      sip_degree: None
      sip_max_inv_pix_error: 0.01
      sip_inv_degree: None
      sip_npoints: 12
      slit_y_low: -0.55
      slit_y_high: 0.55
      nrs_ifu_slice_wcs: False
    flat_field:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      save_interpolated_flat: False
      user_supplied_flat: None
      inverse: False
    photom:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      inverse: False
      source_type: None
      mrs_time_correction: True
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: exptime
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: None
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      in_memory: True
      enable_ctx: True
      enable_err: True
      report_var: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,228 - stpipe.Image2Pipeline - INFO - Prefetching reference files for dataset: &#39;00007_l2asn.json&#39; reftypes = [&#39;area&#39;, &#39;bkg&#39;, &#39;camera&#39;, &#39;collimator&#39;, &#39;dflat&#39;, &#39;disperser&#39;, &#39;distortion&#39;, &#39;fflat&#39;, &#39;filteroffset&#39;, &#39;flat&#39;, &#39;fore&#39;, &#39;fpa&#39;, &#39;ifufore&#39;, &#39;ifupost&#39;, &#39;ifuslicer&#39;, &#39;msa&#39;, &#39;ote&#39;, &#39;photom&#39;, &#39;regions&#39;, &#39;sflat&#39;, &#39;specwcs&#39;, &#39;wavelengthrange&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,230 - stpipe.Image2Pipeline - INFO - Prefetch for AREA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,231 - stpipe.Image2Pipeline - INFO - Prefetch for BKG reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,231 - stpipe.Image2Pipeline - INFO - Prefetch for CAMERA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,231 - stpipe.Image2Pipeline - INFO - Prefetch for COLLIMATOR reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,232 - stpipe.Image2Pipeline - INFO - Prefetch for DFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,232 - stpipe.Image2Pipeline - INFO - Prefetch for DISPERSER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,232 - stpipe.Image2Pipeline - INFO - Prefetch for DISTORTION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,233 - stpipe.Image2Pipeline - INFO - Prefetch for FFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,233 - stpipe.Image2Pipeline - INFO - Prefetch for FILTEROFFSET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0007.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,234 - stpipe.Image2Pipeline - INFO - Prefetch for FLAT reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_flat_0768.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,234 - stpipe.Image2Pipeline - INFO - Prefetch for FORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,235 - stpipe.Image2Pipeline - INFO - Prefetch for FPA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,235 - stpipe.Image2Pipeline - INFO - Prefetch for IFUFORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,235 - stpipe.Image2Pipeline - INFO - Prefetch for IFUPOST reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,235 - stpipe.Image2Pipeline - INFO - Prefetch for IFUSLICER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,236 - stpipe.Image2Pipeline - INFO - Prefetch for MSA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,236 - stpipe.Image2Pipeline - INFO - Prefetch for OTE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,236 - stpipe.Image2Pipeline - INFO - Prefetch for PHOTOM reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,237 - stpipe.Image2Pipeline - INFO - Prefetch for REGIONS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,237 - stpipe.Image2Pipeline - INFO - Prefetch for SFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,237 - stpipe.Image2Pipeline - INFO - Prefetch for SPECWCS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,238 - stpipe.Image2Pipeline - INFO - Prefetch for WAVELENGTHRANGE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,238 - stpipe.Image2Pipeline - INFO - Starting calwebb_image2 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,244 - stpipe.Image2Pipeline - INFO - Processing product /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00007_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,245 - stpipe.Image2Pipeline - INFO - Working on input /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00007_mirimage_rateints.fits ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,433 - stpipe.Image2Pipeline.bkg_subtract - INFO - Step bkg_subtract running with args (&lt;CubeModel(19, 224, 288) from ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00007_mirimage_image2pipeline.fits&gt;, [&#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_02101_00001_mirimage_rateints.fits&#39;, &#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_03101_00001_mirimage_rateints.fits&#39;]).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,450 - jwst.background.asn_intake - INFO - Working on input &lt;CubeModel(19, 224, 288) from ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00007_mirimage_image2pipeline.fits&gt; ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,482 - jwst.background.background_sub - INFO - Accumulate bkg from /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_02101_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,602 - jwst.background.background_sub - INFO - Accumulate bkg from /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_03101_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,721 - jwst.background.background_sub - INFO - Subtracting avg bkg from ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00007_mirimage_image2pipeline.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,761 - stpipe.Image2Pipeline.bkg_subtract - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00007_mirimage_combinedbackground.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,762 - stpipe.Image2Pipeline.bkg_subtract - INFO - Combined background written to ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00007_mirimage_combinedbackground.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,830 - stpipe.Image2Pipeline.bkg_subtract - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00007_mirimage_bsubints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,830 - stpipe.Image2Pipeline.bkg_subtract - INFO - Step bkg_subtract done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:52,978 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00007_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,062 - jwst.assign_wcs.miri - INFO - Created a MIRI mir_4qpm pipeline with references {&#39;distortion&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;, &#39;filteroffset&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0007.asdf&#39;, &#39;specwcs&#39;: None, &#39;regions&#39;: None, &#39;wavelengthrange&#39;: None, &#39;camera&#39;: None, &#39;collimator&#39;: None, &#39;disperser&#39;: None, &#39;fore&#39;: None, &#39;fpa&#39;: None, &#39;msa&#39;: None, &#39;ote&#39;: None, &#39;ifupost&#39;: None, &#39;ifufore&#39;: None, &#39;ifuslicer&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,110 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  209.561517391 -42.103137668 209.570304981 -42.105365951 209.574243705 -42.097066812 209.565433904 -42.094814037
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,111 - jwst.assign_wcs.assign_wcs - INFO - assign_wcs updated S_REGION to POLYGON ICRS  209.561517391 -42.103137668 209.570304981 -42.105365951 209.574243705 -42.097066812 209.565433904 -42.094814037
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,112 - jwst.assign_wcs.assign_wcs - INFO - COMPLETED assign_wcs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,143 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,295 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00007_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,327 - stdatamodels.dynamicdq - WARNING - Keyword CDP_PARTIAL_DATA does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,328 - stdatamodels.dynamicdq - WARNING - Keyword CDP_LOW_QUAL does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,328 - stdatamodels.dynamicdq - WARNING - Keyword CDP_UNRELIABLE_ERROR does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,329 - stdatamodels.dynamicdq - WARNING - Keyword DIFF_PATTERN does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,330 - stpipe.Image2Pipeline.flat_field - INFO - Using FLAT reference file: /home/runner/crds/references/jwst/miri/jwst_miri_flat_0768.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,330 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type FFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,331 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type SFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,331 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type DFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,380 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,531 - stpipe.Image2Pipeline.photom - INFO - Step photom running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00007_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,541 - stpipe.Image2Pipeline.photom - INFO - Using photom reference file: /home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,542 - stpipe.Image2Pipeline.photom - INFO - Using area reference file: N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,568 - jwst.photom.photom - INFO - Using instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,568 - jwst.photom.photom - INFO -  detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,569 - jwst.photom.photom - INFO -  exp_type: MIR_4QPM
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,569 - jwst.photom.photom - INFO -  filter: F1550C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,584 - jwst.photom.photom - INFO - Attempting to obtain PIXAR_SR and PIXAR_A2 values from PHOTOM reference file.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,585 - jwst.photom.photom - INFO - Values for PIXAR_SR and PIXAR_A2 obtained from PHOTOM reference file.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,586 - jwst.photom.photom - INFO -  subarray: MASK1550
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,586 - jwst.photom.photom - INFO - Applying the time-dependent correction to the PHOTOM value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,591 - jwst.photom.photom - INFO - PHOTMJSR value: 3.78944
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,608 - stpipe.Image2Pipeline.photom - INFO - Step photom done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,609 - stpipe.Image2Pipeline - INFO - Finished processing product /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00007_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,609 - stpipe.Image2Pipeline - INFO - ... ending calwebb_image2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,610 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,729 - stpipe.Image2Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00007_mirimage_calints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,730 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,730 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,796 - stpipe - INFO - PARS-RESAMPLESTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-resamplestep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,806 - stpipe.Image2Pipeline - INFO - Image2Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,807 - stpipe.Image2Pipeline.bkg_subtract - INFO - BackgroundStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,808 - stpipe.Image2Pipeline.assign_wcs - INFO - AssignWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,809 - stpipe.Image2Pipeline.flat_field - INFO - FlatFieldStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,810 - stpipe.Image2Pipeline.photom - INFO - PhotomStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,811 - stpipe.Image2Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,965 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline running with args (&#39;./miri_coro_demo_data/Obs007/stage2/00008_l2asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:53,973 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./miri_coro_demo_data/Obs007/stage2
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_bsub: True
  steps:
    bkg_subtract:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bkg_list: None
      save_combined_background: True
      sigma: 3.0
      maxiters: None
      soss_source_percentile: 35.0
      soss_bkg_percentile: None
      wfss_mmag_extract: None
      wfss_maxiter: 5
      wfss_rms_stop: 0.0
      wfss_outlier_percent: 1.0
    assign_wcs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      sip_approx: True
      sip_max_pix_error: 0.01
      sip_degree: None
      sip_max_inv_pix_error: 0.01
      sip_inv_degree: None
      sip_npoints: 12
      slit_y_low: -0.55
      slit_y_high: 0.55
      nrs_ifu_slice_wcs: False
    flat_field:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      save_interpolated_flat: False
      user_supplied_flat: None
      inverse: False
    photom:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      inverse: False
      source_type: None
      mrs_time_correction: True
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: exptime
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: None
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      in_memory: True
      enable_ctx: True
      enable_err: True
      report_var: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,017 - stpipe.Image2Pipeline - INFO - Prefetching reference files for dataset: &#39;00008_l2asn.json&#39; reftypes = [&#39;area&#39;, &#39;bkg&#39;, &#39;camera&#39;, &#39;collimator&#39;, &#39;dflat&#39;, &#39;disperser&#39;, &#39;distortion&#39;, &#39;fflat&#39;, &#39;filteroffset&#39;, &#39;flat&#39;, &#39;fore&#39;, &#39;fpa&#39;, &#39;ifufore&#39;, &#39;ifupost&#39;, &#39;ifuslicer&#39;, &#39;msa&#39;, &#39;ote&#39;, &#39;photom&#39;, &#39;regions&#39;, &#39;sflat&#39;, &#39;specwcs&#39;, &#39;wavelengthrange&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,019 - stpipe.Image2Pipeline - INFO - Prefetch for AREA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,020 - stpipe.Image2Pipeline - INFO - Prefetch for BKG reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,020 - stpipe.Image2Pipeline - INFO - Prefetch for CAMERA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,020 - stpipe.Image2Pipeline - INFO - Prefetch for COLLIMATOR reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,021 - stpipe.Image2Pipeline - INFO - Prefetch for DFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,021 - stpipe.Image2Pipeline - INFO - Prefetch for DISPERSER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,021 - stpipe.Image2Pipeline - INFO - Prefetch for DISTORTION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,022 - stpipe.Image2Pipeline - INFO - Prefetch for FFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,022 - stpipe.Image2Pipeline - INFO - Prefetch for FILTEROFFSET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0007.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,022 - stpipe.Image2Pipeline - INFO - Prefetch for FLAT reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_flat_0768.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,023 - stpipe.Image2Pipeline - INFO - Prefetch for FORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,023 - stpipe.Image2Pipeline - INFO - Prefetch for FPA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,023 - stpipe.Image2Pipeline - INFO - Prefetch for IFUFORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,023 - stpipe.Image2Pipeline - INFO - Prefetch for IFUPOST reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,024 - stpipe.Image2Pipeline - INFO - Prefetch for IFUSLICER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,024 - stpipe.Image2Pipeline - INFO - Prefetch for MSA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,024 - stpipe.Image2Pipeline - INFO - Prefetch for OTE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,025 - stpipe.Image2Pipeline - INFO - Prefetch for PHOTOM reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,025 - stpipe.Image2Pipeline - INFO - Prefetch for REGIONS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,025 - stpipe.Image2Pipeline - INFO - Prefetch for SFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,025 - stpipe.Image2Pipeline - INFO - Prefetch for SPECWCS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,026 - stpipe.Image2Pipeline - INFO - Prefetch for WAVELENGTHRANGE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,026 - stpipe.Image2Pipeline - INFO - Starting calwebb_image2 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,033 - stpipe.Image2Pipeline - INFO - Processing product /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00008_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,034 - stpipe.Image2Pipeline - INFO - Working on input /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00008_mirimage_rateints.fits ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,231 - stpipe.Image2Pipeline.bkg_subtract - INFO - Step bkg_subtract running with args (&lt;CubeModel(19, 224, 288) from ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00008_mirimage_image2pipeline.fits&gt;, [&#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_02101_00001_mirimage_rateints.fits&#39;, &#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_03101_00001_mirimage_rateints.fits&#39;]).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,248 - jwst.background.asn_intake - INFO - Working on input &lt;CubeModel(19, 224, 288) from ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00008_mirimage_image2pipeline.fits&gt; ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,280 - jwst.background.background_sub - INFO - Accumulate bkg from /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_02101_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,405 - jwst.background.background_sub - INFO - Accumulate bkg from /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_03101_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,527 - jwst.background.background_sub - INFO - Subtracting avg bkg from ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00008_mirimage_image2pipeline.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,568 - stpipe.Image2Pipeline.bkg_subtract - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00008_mirimage_combinedbackground.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,568 - stpipe.Image2Pipeline.bkg_subtract - INFO - Combined background written to ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00008_mirimage_combinedbackground.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,636 - stpipe.Image2Pipeline.bkg_subtract - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00008_mirimage_bsubints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,637 - stpipe.Image2Pipeline.bkg_subtract - INFO - Step bkg_subtract done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,781 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00008_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,865 - jwst.assign_wcs.miri - INFO - Created a MIRI mir_4qpm pipeline with references {&#39;distortion&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;, &#39;filteroffset&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0007.asdf&#39;, &#39;specwcs&#39;: None, &#39;regions&#39;: None, &#39;wavelengthrange&#39;: None, &#39;camera&#39;: None, &#39;collimator&#39;: None, &#39;disperser&#39;: None, &#39;fore&#39;: None, &#39;fpa&#39;: None, &#39;msa&#39;: None, &#39;ote&#39;: None, &#39;ifupost&#39;: None, &#39;ifufore&#39;: None, &#39;ifuslicer&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,913 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  209.561518604 -42.103135036 209.570306193 -42.105363318 209.574244917 -42.097064179 209.565435116 -42.094811405
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,914 - jwst.assign_wcs.assign_wcs - INFO - assign_wcs updated S_REGION to POLYGON ICRS  209.561518604 -42.103135036 209.570306193 -42.105363318 209.574244917 -42.097064179 209.565435116 -42.094811405
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,915 - jwst.assign_wcs.assign_wcs - INFO - COMPLETED assign_wcs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:54,947 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,099 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00008_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,131 - stdatamodels.dynamicdq - WARNING - Keyword CDP_PARTIAL_DATA does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,131 - stdatamodels.dynamicdq - WARNING - Keyword CDP_LOW_QUAL does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,132 - stdatamodels.dynamicdq - WARNING - Keyword CDP_UNRELIABLE_ERROR does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,132 - stdatamodels.dynamicdq - WARNING - Keyword DIFF_PATTERN does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,134 - stpipe.Image2Pipeline.flat_field - INFO - Using FLAT reference file: /home/runner/crds/references/jwst/miri/jwst_miri_flat_0768.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,134 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type FFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,134 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type SFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,135 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type DFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,184 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,330 - stpipe.Image2Pipeline.photom - INFO - Step photom running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00008_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,341 - stpipe.Image2Pipeline.photom - INFO - Using photom reference file: /home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,341 - stpipe.Image2Pipeline.photom - INFO - Using area reference file: N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,368 - jwst.photom.photom - INFO - Using instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,368 - jwst.photom.photom - INFO -  detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,369 - jwst.photom.photom - INFO -  exp_type: MIR_4QPM
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,369 - jwst.photom.photom - INFO -  filter: F1550C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,385 - jwst.photom.photom - INFO - Attempting to obtain PIXAR_SR and PIXAR_A2 values from PHOTOM reference file.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,385 - jwst.photom.photom - INFO - Values for PIXAR_SR and PIXAR_A2 obtained from PHOTOM reference file.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,386 - jwst.photom.photom - INFO -  subarray: MASK1550
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,387 - jwst.photom.photom - INFO - Applying the time-dependent correction to the PHOTOM value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,391 - jwst.photom.photom - INFO - PHOTMJSR value: 3.78944
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,408 - stpipe.Image2Pipeline.photom - INFO - Step photom done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,409 - stpipe.Image2Pipeline - INFO - Finished processing product /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00008_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,410 - stpipe.Image2Pipeline - INFO - ... ending calwebb_image2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,410 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,530 - stpipe.Image2Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00008_mirimage_calints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,531 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,531 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,597 - stpipe - INFO - PARS-RESAMPLESTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-resamplestep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,607 - stpipe.Image2Pipeline - INFO - Image2Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,608 - stpipe.Image2Pipeline.bkg_subtract - INFO - BackgroundStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,609 - stpipe.Image2Pipeline.assign_wcs - INFO - AssignWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,610 - stpipe.Image2Pipeline.flat_field - INFO - FlatFieldStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,611 - stpipe.Image2Pipeline.photom - INFO - PhotomStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,612 - stpipe.Image2Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,763 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline running with args (&#39;./miri_coro_demo_data/Obs007/stage2/00009_l2asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,771 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./miri_coro_demo_data/Obs007/stage2
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: None
  search_output_file: True
  input_dir: &#39;&#39;
  save_bsub: True
  steps:
    bkg_subtract:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      bkg_list: None
      save_combined_background: True
      sigma: 3.0
      maxiters: None
      soss_source_percentile: 35.0
      soss_bkg_percentile: None
      wfss_mmag_extract: None
      wfss_maxiter: 5
      wfss_rms_stop: 0.0
      wfss_outlier_percent: 1.0
    assign_wcs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      sip_approx: True
      sip_max_pix_error: 0.01
      sip_degree: None
      sip_max_inv_pix_error: 0.01
      sip_inv_degree: None
      sip_npoints: 12
      slit_y_low: -0.55
      slit_y_high: 0.55
      nrs_ifu_slice_wcs: False
    flat_field:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      save_interpolated_flat: False
      user_supplied_flat: None
      inverse: False
    photom:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      inverse: False
      source_type: None
      mrs_time_correction: True
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: exptime
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: None
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      in_memory: True
      enable_ctx: True
      enable_err: True
      report_var: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,814 - stpipe.Image2Pipeline - INFO - Prefetching reference files for dataset: &#39;00009_l2asn.json&#39; reftypes = [&#39;area&#39;, &#39;bkg&#39;, &#39;camera&#39;, &#39;collimator&#39;, &#39;dflat&#39;, &#39;disperser&#39;, &#39;distortion&#39;, &#39;fflat&#39;, &#39;filteroffset&#39;, &#39;flat&#39;, &#39;fore&#39;, &#39;fpa&#39;, &#39;ifufore&#39;, &#39;ifupost&#39;, &#39;ifuslicer&#39;, &#39;msa&#39;, &#39;ote&#39;, &#39;photom&#39;, &#39;regions&#39;, &#39;sflat&#39;, &#39;specwcs&#39;, &#39;wavelengthrange&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,816 - stpipe.Image2Pipeline - INFO - Prefetch for AREA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,817 - stpipe.Image2Pipeline - INFO - Prefetch for BKG reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,817 - stpipe.Image2Pipeline - INFO - Prefetch for CAMERA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,818 - stpipe.Image2Pipeline - INFO - Prefetch for COLLIMATOR reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,818 - stpipe.Image2Pipeline - INFO - Prefetch for DFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,818 - stpipe.Image2Pipeline - INFO - Prefetch for DISPERSER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,819 - stpipe.Image2Pipeline - INFO - Prefetch for DISTORTION reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,819 - stpipe.Image2Pipeline - INFO - Prefetch for FFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,819 - stpipe.Image2Pipeline - INFO - Prefetch for FILTEROFFSET reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0007.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,820 - stpipe.Image2Pipeline - INFO - Prefetch for FLAT reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_flat_0768.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,820 - stpipe.Image2Pipeline - INFO - Prefetch for FORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,820 - stpipe.Image2Pipeline - INFO - Prefetch for FPA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,821 - stpipe.Image2Pipeline - INFO - Prefetch for IFUFORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,821 - stpipe.Image2Pipeline - INFO - Prefetch for IFUPOST reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,821 - stpipe.Image2Pipeline - INFO - Prefetch for IFUSLICER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,822 - stpipe.Image2Pipeline - INFO - Prefetch for MSA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,822 - stpipe.Image2Pipeline - INFO - Prefetch for OTE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,822 - stpipe.Image2Pipeline - INFO - Prefetch for PHOTOM reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,823 - stpipe.Image2Pipeline - INFO - Prefetch for REGIONS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,823 - stpipe.Image2Pipeline - INFO - Prefetch for SFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,823 - stpipe.Image2Pipeline - INFO - Prefetch for SPECWCS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,824 - stpipe.Image2Pipeline - INFO - Prefetch for WAVELENGTHRANGE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,824 - stpipe.Image2Pipeline - INFO - Starting calwebb_image2 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,830 - stpipe.Image2Pipeline - INFO - Processing product /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00009_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:55,830 - stpipe.Image2Pipeline - INFO - Working on input /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00009_mirimage_rateints.fits ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:56,024 - stpipe.Image2Pipeline.bkg_subtract - INFO - Step bkg_subtract running with args (&lt;CubeModel(19, 224, 288) from ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00009_mirimage_image2pipeline.fits&gt;, [&#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_02101_00001_mirimage_rateints.fits&#39;, &#39;/home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_03101_00001_mirimage_rateints.fits&#39;]).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:56,041 - jwst.background.asn_intake - INFO - Working on input &lt;CubeModel(19, 224, 288) from ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00009_mirimage_image2pipeline.fits&gt; ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:56,073 - jwst.background.background_sub - INFO - Accumulate bkg from /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_02101_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:56,193 - jwst.background.background_sub - INFO - Accumulate bkg from /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs031/stage1/jw01386031001_03101_00001_mirimage_rateints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:56,317 - jwst.background.background_sub - INFO - Subtracting avg bkg from ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00009_mirimage_image2pipeline.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:56,350 - stpipe.Image2Pipeline.bkg_subtract - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00009_mirimage_combinedbackground.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:56,351 - stpipe.Image2Pipeline.bkg_subtract - INFO - Combined background written to ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00009_mirimage_combinedbackground.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:56,419 - stpipe.Image2Pipeline.bkg_subtract - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00009_mirimage_bsubints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:56,419 - stpipe.Image2Pipeline.bkg_subtract - INFO - Step bkg_subtract done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:56,566 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00009_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:56,651 - jwst.assign_wcs.miri - INFO - Created a MIRI mir_4qpm pipeline with references {&#39;distortion&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_distortion_0047.asdf&#39;, &#39;filteroffset&#39;: &#39;/home/runner/crds/references/jwst/miri/jwst_miri_filteroffset_0007.asdf&#39;, &#39;specwcs&#39;: None, &#39;regions&#39;: None, &#39;wavelengthrange&#39;: None, &#39;camera&#39;: None, &#39;collimator&#39;: None, &#39;disperser&#39;: None, &#39;fore&#39;: None, &#39;fpa&#39;: None, &#39;msa&#39;: None, &#39;ote&#39;: None, &#39;ifupost&#39;: None, &#39;ifufore&#39;: None, &#39;ifuslicer&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:56,700 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  209.561519853 -42.103132411 209.570307442 -42.105360693 209.574246165 -42.097061554 209.565436364 -42.094808780
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:56,701 - jwst.assign_wcs.assign_wcs - INFO - assign_wcs updated S_REGION to POLYGON ICRS  209.561519853 -42.103132411 209.570307442 -42.105360693 209.574246165 -42.097061554 209.565436364 -42.094808780
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:56,701 - jwst.assign_wcs.assign_wcs - INFO - COMPLETED assign_wcs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:56,733 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:56,885 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00009_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:56,917 - stdatamodels.dynamicdq - WARNING - Keyword CDP_PARTIAL_DATA does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:56,918 - stdatamodels.dynamicdq - WARNING - Keyword CDP_LOW_QUAL does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:56,918 - stdatamodels.dynamicdq - WARNING - Keyword CDP_UNRELIABLE_ERROR does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:56,919 - stdatamodels.dynamicdq - WARNING - Keyword DIFF_PATTERN does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:56,920 - stpipe.Image2Pipeline.flat_field - INFO - Using FLAT reference file: /home/runner/crds/references/jwst/miri/jwst_miri_flat_0768.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:56,920 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type FFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:56,921 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type SFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:56,921 - stpipe.Image2Pipeline.flat_field - INFO - No reference found for type DFLAT
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:56,970 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:57,124 - stpipe.Image2Pipeline.photom - INFO - Step photom running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00009_mirimage_bsubints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:57,134 - stpipe.Image2Pipeline.photom - INFO - Using photom reference file: /home/runner/crds/references/jwst/miri/jwst_miri_photom_0218.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:57,135 - stpipe.Image2Pipeline.photom - INFO - Using area reference file: N/A
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:57,161 - jwst.photom.photom - INFO - Using instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:57,162 - jwst.photom.photom - INFO -  detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:57,162 - jwst.photom.photom - INFO -  exp_type: MIR_4QPM
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:57,162 - jwst.photom.photom - INFO -  filter: F1550C
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:57,178 - jwst.photom.photom - INFO - Attempting to obtain PIXAR_SR and PIXAR_A2 values from PHOTOM reference file.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:57,179 - jwst.photom.photom - INFO - Values for PIXAR_SR and PIXAR_A2 obtained from PHOTOM reference file.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:57,180 - jwst.photom.photom - INFO -  subarray: MASK1550
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:57,180 - jwst.photom.photom - INFO - Applying the time-dependent correction to the PHOTOM value.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:57,185 - jwst.photom.photom - INFO - PHOTMJSR value: 3.78944
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:57,202 - stpipe.Image2Pipeline.photom - INFO - Step photom done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:57,202 - stpipe.Image2Pipeline - INFO - Finished processing product /home/runner/work/jwst-pipeline-notebooks/jwst-pipeline-notebooks/notebooks/MIRI/Coronagraphy/miri_coro_demo_data/Obs007/stage1/jw01386007001_04101_00009_mirimage
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:57,203 - stpipe.Image2Pipeline - INFO - ... ending calwebb_image2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:57,204 - jwst.stpipe.core - INFO - Results used CRDS context: jwst_1413.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:57,322 - stpipe.Image2Pipeline - INFO - Saved model in ./miri_coro_demo_data/Obs007/stage2/jw01386007001_04101_00009_mirimage_calints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:57,323 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:57,323 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print out the time benchmark</span>
<span class="n">time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Runtime so far: </span><span class="si">{</span><span class="n">time1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">time0</span><span class="si">:</span><span class="s2">0.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Runtime for Image2: </span><span class="si">{</span><span class="n">time1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">time_image2</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Runtime so far: 1755.2356 seconds
Runtime for Image2: 22.673530018999827 seconds
</pre></div>
</div>
</div>
</div>
<hr style="border:1px solid gray"> </hr></section>
<section id="coron3-pipeline">
<h2>7.-Coron3 Pipeline<a class="headerlink" href="#coron3-pipeline" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<p>In this section, we’ll run the Coron3 (calwebb_coron3) pipeline on the calibrated MIRI coronagraphic exposures to produce PSF-subtracted, resampled, combined images of the source object. The input to calwebb_coron3 must be in the form of an association file that lists one or more exposures of a science target and one or more reference PSF targets. The individual target and reference PSF exposures should be in the form of 3D photometrically calibrated (<code class="docutils literal notranslate"><span class="pre">_calints</span></code>) products from calwebb_image2 processing. Each pipeline step will loop over the 3D stack of per-integration images contained in each exposure. The relevant steps are:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/outlier_detection/index.html#outlier-detection-step">outlier_detection</a>: CR-flag all PSF and science target exposures</p></li>
<li><p><a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/stack_refs/index.html#stack-refs-step">stack_refs</a>: Reference PSF stacking</p></li>
<li><p><a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/align_refs/index.html#align-refs-step">align_refs</a>: Reference PSF alignment</p></li>
<li><p><a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/klip/index.html#klip-step">klip</a>: PSF subtraction with the KLIP algorithm</p></li>
<li><p><a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/resample/index.html#resample-step">resample</a>: Image resampling and World Coordinate System registration</p></li>
</ul>
<p>See https://jwst-docs.stsci.edu/jwst-science-calibration-pipeline/stages-of-jwst-data-processing/calwebb_coron3</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_coron3</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up a dictionary to define how the Coron3 pipeline should be configured</span>

<span class="c1"># Boilerplate dictionary setup</span>
<span class="n">coron3dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">coron3dict</span><span class="p">[</span><span class="s1">&#39;outlier_detection&#39;</span><span class="p">],</span> <span class="n">coron3dict</span><span class="p">[</span><span class="s1">&#39;stack_refs&#39;</span><span class="p">],</span> <span class="n">coron3dict</span><span class="p">[</span><span class="s1">&#39;align_refs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{},</span> <span class="p">{}</span>
<span class="n">coron3dict</span><span class="p">[</span><span class="s1">&#39;klip&#39;</span><span class="p">],</span> <span class="n">coron3dict</span><span class="p">[</span><span class="s1">&#39;resample&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>

<span class="c1"># Set the maximum number of KL transform rows to keep when computing the PSF fit to the target.</span>
<span class="n">coron3dict</span><span class="p">[</span><span class="s1">&#39;klip&#39;</span><span class="p">][</span><span class="s1">&#39;truncate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">25</span>   <span class="c1"># The maximum number of KL modes to use.</span>

<span class="c1"># Overrides for various reference files</span>
<span class="c1"># Files should be in the base local directory or provide full path</span>
<span class="c1">#coron3dict[&#39;align_refs&#39;][&#39;override_psfmask&#39;] = &#39;myfile.fits&#39;  # The PSFMASK reference file</span>

<span class="c1"># Options for adjusting performance for the outlier detection step</span>
<span class="c1">#coron3dict[&#39;outlier_detection&#39;][&#39;kernel_size&#39;] = &#39;7 7&#39;  # Dial this to adjust the detector kernel size</span>
<span class="c1">#coron3dict[&#39;outlier_detection&#39;][&#39;threshold_percent&#39;] = 99.8  # Dial this to be more/less aggressive in outlier flagging (values closer to 100% are less aggressive)</span>

<span class="c1"># Options for adjusting the resample step</span>
<span class="c1">#coron3dict[&#39;resample&#39;][&#39;pixfrac&#39;] = 1.0  # Fraction by which input pixels are “shrunk” before being drizzled onto the output image grid</span>
<span class="c1">#coron3dict[&#39;resample&#39;][&#39;kernel&#39;] = &#39;square&#39;  # Kernel form used to distribute flux onto the output image</span>
<span class="c1">#coron3dict[&#39;resample&#39;][&#39;fillval&#39;] = &#39;INDEF&#39;  # Value to assign to output pixels that have zero weight or do not receive any flux from any input pixels during drizzling</span>
<span class="c1">#coron3dict[&#39;resample&#39;][&#39;weight_type&#39;] = &#39;ivm&#39;  # Weighting type for each input image.</span>
<span class="c1">#coron3dict[&#39;resample&#39;][&#39;output_shape&#39;] = None  </span>
<span class="c1">#coron3dict[&#39;resample&#39;][&#39;crpix&#39;] = None</span>
<span class="c1">#coron3dict[&#39;resample&#39;][&#39;crval&#39;] = None</span>
<span class="c1">#coron3dict[&#39;resample&#39;][&#39;rotation&#39;] = None</span>
<span class="c1">#coron3dict[&#39;resample&#39;][&#39;pixel_scale_ratio&#39;] = 1.0</span>
<span class="c1">#coron3dict[&#39;resample&#39;][&#39;pixel_scale&#39;] = None</span>
<span class="c1">#coron3dict[&#39;resample&#39;][&#39;output_wcs&#39;] = &#39;&#39;</span>
<span class="c1">#coron3dict[&#39;resample&#39;][&#39;single&#39;] = False</span>
<span class="c1">#coron3dict[&#39;resample&#39;][&#39;blendheaders&#39;] = True </span>
</pre></div>
</div>
</div>
</div>
<p>Define a function to create association files for Stage 3. It creates an association from a list of science exposures and a list of PSF reference exposures.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">writel3asn</span><span class="p">(</span><span class="n">scifiles</span><span class="p">,</span> <span class="n">ref_targ_files</span><span class="p">,</span> <span class="n">asnfile</span><span class="p">,</span> <span class="n">prodname</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an association from a list of science exposures and a list of PSF reference exposures, </span>
<span class="sd">    intended for calwebb_coron3 processing.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    scifiles : list</span>
<span class="sd">        List of science files</span>
<span class="sd">    ref_targ_files : list</span>
<span class="sd">        List of reference files</span>
<span class="sd">    asnfile : str</span>
<span class="sd">        The path to the association file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Define the basic association of science files</span>
    <span class="n">asn</span> <span class="o">=</span> <span class="n">afl</span><span class="o">.</span><span class="n">asn_from_list</span><span class="p">(</span><span class="n">scifiles</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="n">DMS_Level3_Base</span><span class="p">,</span> <span class="n">product_name</span><span class="o">=</span><span class="n">prodname</span><span class="p">)</span>

    <span class="c1"># Add reference target files to the association</span>
    <span class="n">nref</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ref_targ_files</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nref</span><span class="p">):</span>
        <span class="n">asn</span><span class="p">[</span><span class="s1">&#39;products&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;members&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;expname&#39;</span><span class="p">:</span> <span class="n">ref_targ_files</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span> <span class="s1">&#39;exptype&#39;</span><span class="p">:</span> <span class="s1">&#39;psf&#39;</span><span class="p">})</span>

    <span class="c1"># Write the association to a json file</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">serialized</span> <span class="o">=</span> <span class="n">asn</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">asnfile</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">serialized</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Find and sort all of the input files, ensuring use of absolute paths. For the demo example there should be 2 science files and 9 PSF reference files.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Science Files need the calints.fits files</span>
<span class="n">sstring</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">image2_sci_r1_dir</span><span class="p">,</span> <span class="s1">&#39;jw*mirimage*calints.fits&#39;</span><span class="p">)</span>
<span class="n">sstring2</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">image2_sci_r2_dir</span><span class="p">,</span> <span class="s1">&#39;jw*mirimage*calints.fits&#39;</span><span class="p">)</span>
<span class="n">r1_calfiles</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">sstring</span><span class="p">))</span>
<span class="n">r2_calfiles</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">sstring2</span><span class="p">))</span>
<span class="n">calfiles</span> <span class="o">=</span> <span class="n">r1_calfiles</span> <span class="o">+</span> <span class="n">r2_calfiles</span>

<span class="c1"># Check that these are the mask/filter to use</span>
<span class="n">calfiles</span> <span class="o">=</span> <span class="n">select_mask_filter_files</span><span class="p">(</span><span class="n">calfiles</span><span class="p">,</span> <span class="n">use_mask</span><span class="p">,</span> <span class="n">use_filter</span><span class="p">)</span>

<span class="c1"># Reference target Files need the calints.fits files</span>
<span class="n">sstring</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">image2_ref_targ_dir</span><span class="p">,</span> <span class="s1">&#39;jw*mirimage*calints.fits&#39;</span><span class="p">)</span>
<span class="n">ref_targ_files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">sstring</span><span class="p">))</span>

<span class="c1"># Check that these are the mask/filter to use</span>
<span class="n">ref_targ_files</span> <span class="o">=</span> <span class="n">select_mask_filter_files</span><span class="p">(</span><span class="n">ref_targ_files</span><span class="p">,</span> <span class="n">use_mask</span><span class="p">,</span> <span class="n">use_filter</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Found &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">calfiles</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; science files to process&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Found &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ref_targ_files</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; reference PSF files to process&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found 2 science files to process
Found 9 reference PSF files to process
</pre></div>
</div>
</div>
</div>
<p>Make an association file that includes all of the Science and Reference files and run Coron3</p>
<div class="cell tag_scroll-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">docoron3</span><span class="p">:</span>
    <span class="n">asnfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">coron3_dir</span><span class="p">,</span> <span class="s1">&#39;l3asn.json&#39;</span><span class="p">)</span>
    <span class="n">writel3asn</span><span class="p">(</span><span class="n">calfiles</span><span class="p">,</span> <span class="n">ref_targ_files</span><span class="p">,</span> <span class="n">asnfile</span><span class="p">,</span> <span class="s1">&#39;Level 3&#39;</span><span class="p">)</span>
    <span class="n">Coron3Pipeline</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">asnfile</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">coron3dict</span><span class="p">,</span> <span class="n">save_results</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="n">coron3_dir</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Skipping coron3 processing&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:57,535 - stpipe - INFO - PARS-RESAMPLESTEP parameters found: /home/runner/crds/references/jwst/miri/jwst_miri_pars-resamplestep_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:57,546 - stpipe.Coron3Pipeline - INFO - Coron3Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:57,547 - stpipe.Coron3Pipeline.stack_refs - INFO - StackRefsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:57,548 - stpipe.Coron3Pipeline.align_refs - INFO - AlignRefsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:57,549 - stpipe.Coron3Pipeline.klip - INFO - KlipStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:57,550 - stpipe.Coron3Pipeline.outlier_detection - INFO - OutlierDetectionStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:57,551 - stpipe.Coron3Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:57,705 - stpipe.Coron3Pipeline - INFO - Step Coron3Pipeline running with args (&#39;./miri_coro_demo_data/stage3/l3asn.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:57,713 - stpipe.Coron3Pipeline - INFO - Step Coron3Pipeline parameters are:
  pre_hooks: []
  post_hooks: []
  output_file: None
  output_dir: ./miri_coro_demo_data/stage3
  output_ext: .fits
  output_use_model: False
  output_use_index: True
  save_results: True
  skip: False
  suffix: i2d
  search_output_file: True
  input_dir: &#39;&#39;
  steps:
    stack_refs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
    align_refs:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      median_box_length: 3
      bad_bits: DO_NOT_USE
    klip:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      truncate: 25
    outlier_detection:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: False
      input_dir: &#39;&#39;
      weight_type: ivm
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      maskpt: 0.7
      snr: 5.0 4.0
      scale: 1.2 0.7
      backg: 0.0
      kernel_size: 7 7
      threshold_percent: 99.8
      rolling_window_width: 25
      ifu_second_check: False
      save_intermediate_results: False
      resample_data: True
      good_bits: ~DO_NOT_USE
      in_memory: True
    resample:
      pre_hooks: []
      post_hooks: []
      output_file: None
      output_dir: None
      output_ext: .fits
      output_use_model: False
      output_use_index: True
      save_results: False
      skip: False
      suffix: None
      search_output_file: True
      input_dir: &#39;&#39;
      pixfrac: 1.0
      kernel: square
      fillval: NAN
      weight_type: exptime
      output_shape: None
      crpix: None
      crval: None
      rotation: None
      pixel_scale_ratio: 1.0
      pixel_scale: None
      output_wcs: &#39;&#39;
      single: False
      blendheaders: True
      in_memory: True
      enable_ctx: True
      enable_err: True
      report_var: True
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:57,713 - stpipe.Coron3Pipeline - INFO - Starting calwebb_coron3 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:58,863 - stpipe.Coron3Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01386007001_04101_00001_mirimage_calints.fits&#39; reftypes = [&#39;psfmask&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:58,865 - CRDS - INFO -  Fetching  /home/runner/crds/references/jwst/miri/jwst_miri_psfmask_0012.fits  267.8 K bytes  (1 / 1 files) (0 / 267.8 K bytes)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:59,260 - stpipe.Coron3Pipeline - INFO - Prefetch for PSFMASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_psfmask_0012.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:59,284 - stpipe.Coron3Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01386007001_04101_00002_mirimage_calints.fits&#39; reftypes = [&#39;psfmask&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:59,286 - stpipe.Coron3Pipeline - INFO - Prefetch for PSFMASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_psfmask_0012.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:59,310 - stpipe.Coron3Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01386007001_04101_00003_mirimage_calints.fits&#39; reftypes = [&#39;psfmask&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:59,311 - stpipe.Coron3Pipeline - INFO - Prefetch for PSFMASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_psfmask_0012.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:59,335 - stpipe.Coron3Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01386007001_04101_00004_mirimage_calints.fits&#39; reftypes = [&#39;psfmask&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:59,337 - stpipe.Coron3Pipeline - INFO - Prefetch for PSFMASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_psfmask_0012.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:59,360 - stpipe.Coron3Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01386007001_04101_00005_mirimage_calints.fits&#39; reftypes = [&#39;psfmask&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:59,362 - stpipe.Coron3Pipeline - INFO - Prefetch for PSFMASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_psfmask_0012.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:59,385 - stpipe.Coron3Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01386007001_04101_00006_mirimage_calints.fits&#39; reftypes = [&#39;psfmask&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:59,387 - stpipe.Coron3Pipeline - INFO - Prefetch for PSFMASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_psfmask_0012.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:59,411 - stpipe.Coron3Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01386007001_04101_00007_mirimage_calints.fits&#39; reftypes = [&#39;psfmask&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:59,413 - stpipe.Coron3Pipeline - INFO - Prefetch for PSFMASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_psfmask_0012.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:59,437 - stpipe.Coron3Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01386007001_04101_00008_mirimage_calints.fits&#39; reftypes = [&#39;psfmask&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:59,438 - stpipe.Coron3Pipeline - INFO - Prefetch for PSFMASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_psfmask_0012.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:59,462 - stpipe.Coron3Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01386007001_04101_00009_mirimage_calints.fits&#39; reftypes = [&#39;psfmask&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:59,463 - stpipe.Coron3Pipeline - INFO - Prefetch for PSFMASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_psfmask_0012.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:59,487 - stpipe.Coron3Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01386008001_04101_00001_mirimage_calints.fits&#39; reftypes = [&#39;psfmask&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:59,489 - stpipe.Coron3Pipeline - INFO - Prefetch for PSFMASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_psfmask_0012.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:59,513 - stpipe.Coron3Pipeline - INFO - Prefetching reference files for dataset: &#39;jw01386009001_04101_00001_mirimage_calints.fits&#39; reftypes = [&#39;psfmask&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:05:59,514 - stpipe.Coron3Pipeline - INFO - Prefetch for PSFMASK reference file is &#39;/home/runner/crds/references/jwst/miri/jwst_miri_psfmask_0012.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:00,839 - stpipe.Coron3Pipeline.outlier_detection - INFO - Step outlier_detection running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00001_mirimage_calints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:00,840 - stpipe.Coron3Pipeline.outlier_detection - INFO - Outlier Detection mode: coron
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:00,840 - stpipe.Coron3Pipeline.outlier_detection - INFO - Outlier Detection asn_id: a3001
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:00,849 - jwst.outlier_detection.utils - INFO - Computing median
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:00,982 - jwst.outlier_detection.utils - INFO - 64 pixels marked as outliers
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:01,114 - stpipe.Coron3Pipeline.outlier_detection - INFO - Saved model in ./miri_coro_demo_data/stage3/jw01386007001_04101_00001_mirimage_a3001_crfints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:01,115 - stpipe.Coron3Pipeline.outlier_detection - INFO - Step outlier_detection done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:01,295 - stpipe.Coron3Pipeline.outlier_detection - INFO - Step outlier_detection running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00002_mirimage_calints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:01,296 - stpipe.Coron3Pipeline.outlier_detection - INFO - Outlier Detection mode: coron
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:01,296 - stpipe.Coron3Pipeline.outlier_detection - INFO - Outlier Detection asn_id: a3001
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:01,303 - jwst.outlier_detection.utils - INFO - Computing median
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:01,434 - jwst.outlier_detection.utils - INFO - 64 pixels marked as outliers
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:01,565 - stpipe.Coron3Pipeline.outlier_detection - INFO - Saved model in ./miri_coro_demo_data/stage3/jw01386007001_04101_00002_mirimage_a3001_crfints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:01,566 - stpipe.Coron3Pipeline.outlier_detection - INFO - Step outlier_detection done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:01,744 - stpipe.Coron3Pipeline.outlier_detection - INFO - Step outlier_detection running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00003_mirimage_calints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:01,745 - stpipe.Coron3Pipeline.outlier_detection - INFO - Outlier Detection mode: coron
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:01,745 - stpipe.Coron3Pipeline.outlier_detection - INFO - Outlier Detection asn_id: a3001
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:01,752 - jwst.outlier_detection.utils - INFO - Computing median
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:01,881 - jwst.outlier_detection.utils - INFO - 134 pixels marked as outliers
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:02,013 - stpipe.Coron3Pipeline.outlier_detection - INFO - Saved model in ./miri_coro_demo_data/stage3/jw01386007001_04101_00003_mirimage_a3001_crfints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:02,014 - stpipe.Coron3Pipeline.outlier_detection - INFO - Step outlier_detection done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:02,195 - stpipe.Coron3Pipeline.outlier_detection - INFO - Step outlier_detection running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00004_mirimage_calints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:02,196 - stpipe.Coron3Pipeline.outlier_detection - INFO - Outlier Detection mode: coron
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:02,196 - stpipe.Coron3Pipeline.outlier_detection - INFO - Outlier Detection asn_id: a3001
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:02,203 - jwst.outlier_detection.utils - INFO - Computing median
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:02,333 - jwst.outlier_detection.utils - INFO - 138 pixels marked as outliers
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:02,465 - stpipe.Coron3Pipeline.outlier_detection - INFO - Saved model in ./miri_coro_demo_data/stage3/jw01386007001_04101_00004_mirimage_a3001_crfints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:02,465 - stpipe.Coron3Pipeline.outlier_detection - INFO - Step outlier_detection done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:02,644 - stpipe.Coron3Pipeline.outlier_detection - INFO - Step outlier_detection running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00005_mirimage_calints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:02,645 - stpipe.Coron3Pipeline.outlier_detection - INFO - Outlier Detection mode: coron
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:02,645 - stpipe.Coron3Pipeline.outlier_detection - INFO - Outlier Detection asn_id: a3001
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:02,652 - jwst.outlier_detection.utils - INFO - Computing median
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:02,781 - jwst.outlier_detection.utils - INFO - 112 pixels marked as outliers
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:02,913 - stpipe.Coron3Pipeline.outlier_detection - INFO - Saved model in ./miri_coro_demo_data/stage3/jw01386007001_04101_00005_mirimage_a3001_crfints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:02,913 - stpipe.Coron3Pipeline.outlier_detection - INFO - Step outlier_detection done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:03,094 - stpipe.Coron3Pipeline.outlier_detection - INFO - Step outlier_detection running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00006_mirimage_calints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:03,095 - stpipe.Coron3Pipeline.outlier_detection - INFO - Outlier Detection mode: coron
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:03,096 - stpipe.Coron3Pipeline.outlier_detection - INFO - Outlier Detection asn_id: a3001
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:03,103 - jwst.outlier_detection.utils - INFO - Computing median
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:03,231 - jwst.outlier_detection.utils - INFO - 171 pixels marked as outliers
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:03,363 - stpipe.Coron3Pipeline.outlier_detection - INFO - Saved model in ./miri_coro_demo_data/stage3/jw01386007001_04101_00006_mirimage_a3001_crfints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:03,363 - stpipe.Coron3Pipeline.outlier_detection - INFO - Step outlier_detection done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:03,545 - stpipe.Coron3Pipeline.outlier_detection - INFO - Step outlier_detection running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00007_mirimage_calints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:03,546 - stpipe.Coron3Pipeline.outlier_detection - INFO - Outlier Detection mode: coron
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:03,546 - stpipe.Coron3Pipeline.outlier_detection - INFO - Outlier Detection asn_id: a3001
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:03,553 - jwst.outlier_detection.utils - INFO - Computing median
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:03,684 - jwst.outlier_detection.utils - INFO - 220 pixels marked as outliers
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:03,816 - stpipe.Coron3Pipeline.outlier_detection - INFO - Saved model in ./miri_coro_demo_data/stage3/jw01386007001_04101_00007_mirimage_a3001_crfints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:03,817 - stpipe.Coron3Pipeline.outlier_detection - INFO - Step outlier_detection done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:03,996 - stpipe.Coron3Pipeline.outlier_detection - INFO - Step outlier_detection running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00008_mirimage_calints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:03,997 - stpipe.Coron3Pipeline.outlier_detection - INFO - Outlier Detection mode: coron
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:03,997 - stpipe.Coron3Pipeline.outlier_detection - INFO - Outlier Detection asn_id: a3001
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:04,004 - jwst.outlier_detection.utils - INFO - Computing median
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:04,133 - jwst.outlier_detection.utils - INFO - 234 pixels marked as outliers
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:04,265 - stpipe.Coron3Pipeline.outlier_detection - INFO - Saved model in ./miri_coro_demo_data/stage3/jw01386007001_04101_00008_mirimage_a3001_crfints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:04,265 - stpipe.Coron3Pipeline.outlier_detection - INFO - Step outlier_detection done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:04,444 - stpipe.Coron3Pipeline.outlier_detection - INFO - Step outlier_detection running with args (&lt;CubeModel(19, 224, 288) from jw01386007001_04101_00009_mirimage_calints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:04,445 - stpipe.Coron3Pipeline.outlier_detection - INFO - Outlier Detection mode: coron
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:04,445 - stpipe.Coron3Pipeline.outlier_detection - INFO - Outlier Detection asn_id: a3001
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:04,452 - jwst.outlier_detection.utils - INFO - Computing median
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:04,580 - jwst.outlier_detection.utils - INFO - 211 pixels marked as outliers
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:04,713 - stpipe.Coron3Pipeline.outlier_detection - INFO - Saved model in ./miri_coro_demo_data/stage3/jw01386007001_04101_00009_mirimage_a3001_crfints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:04,713 - stpipe.Coron3Pipeline.outlier_detection - INFO - Step outlier_detection done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:04,896 - stpipe.Coron3Pipeline.stack_refs - INFO - Step stack_refs running with args (&lt;jwst.datamodels.container.ModelContainer object at 0x7fd072548050&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:04,960 - jwst.coron.stack_refs - INFO -  Adding psf member 1 to output stack
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:04,972 - jwst.coron.stack_refs - INFO -  Adding psf member 2 to output stack
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:04,983 - jwst.coron.stack_refs - INFO -  Adding psf member 3 to output stack
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:04,994 - jwst.coron.stack_refs - INFO -  Adding psf member 4 to output stack
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:05,005 - jwst.coron.stack_refs - INFO -  Adding psf member 5 to output stack
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:05,015 - jwst.coron.stack_refs - INFO -  Adding psf member 6 to output stack
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:05,026 - jwst.coron.stack_refs - INFO -  Adding psf member 7 to output stack
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:05,038 - jwst.coron.stack_refs - INFO -  Adding psf member 8 to output stack
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:05,049 - jwst.coron.stack_refs - INFO -  Adding psf member 9 to output stack
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:05,102 - stpipe.Coron3Pipeline.stack_refs - INFO - Step stack_refs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:05,255 - stpipe.Coron3Pipeline - INFO - Saved model in ./miri_coro_demo_data/stage3/Level 3_psfstack.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:05,555 - stpipe.Coron3Pipeline.outlier_detection - INFO - Step outlier_detection running with args (&lt;CubeModel(60, 224, 288) from jw01386008001_04101_00001_mirimage_calints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:05,556 - stpipe.Coron3Pipeline.outlier_detection - INFO - Outlier Detection mode: coron
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:05,556 - stpipe.Coron3Pipeline.outlier_detection - INFO - Outlier Detection asn_id: a3001
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:05,568 - jwst.outlier_detection.utils - INFO - Computing median
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:05,816 - jwst.outlier_detection.utils - INFO - 33 pixels marked as outliers
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:06,014 - stpipe.Coron3Pipeline.outlier_detection - INFO - Saved model in ./miri_coro_demo_data/stage3/jw01386008001_04101_00001_mirimage_a3001_crfints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:06,015 - stpipe.Coron3Pipeline.outlier_detection - INFO - Step outlier_detection done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:06,201 - stpipe.Coron3Pipeline.align_refs - INFO - Step align_refs running with args (&lt;CubeModel(60, 224, 288) from jw01386008001_04101_00001_mirimage_a3001_crfints.fits&gt;, &lt;CubeModel(171, 224, 288) from Level 3_psfstack.fits&gt;).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:06:06,244 - stpipe.Coron3Pipeline.align_refs - INFO - Using PSFMASK reference file /home/runner/crds/references/jwst/miri/jwst_miri_psfmask_0012.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:08:09,570 - stpipe.Coron3Pipeline.align_refs - INFO - Step align_refs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:08:24,122 - stpipe.Coron3Pipeline - INFO - Saved model in ./miri_coro_demo_data/stage3/jw01386008001_04101_00001_mirimage_a3001_psfalign.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:08:24,328 - stpipe.Coron3Pipeline.klip - INFO - Step klip running with args (&lt;CubeModel(60, 224, 288) from jw01386008001_04101_00001_mirimage_a3001_crfints.fits&gt;, &lt;CubeModel(171, 224, 288) from jw01386008001_04101_00001_mirimage_a3001_psfalign.fits&gt;).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:08:24,336 - stpipe.Coron3Pipeline.klip - INFO - KL transform truncation = 25
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:08:36,111 - stpipe.Coron3Pipeline.klip - INFO - Step klip done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:08:36,332 - stpipe.Coron3Pipeline - INFO - Saved model in ./miri_coro_demo_data/stage3/jw01386008001_04101_00001_mirimage_a3001_psfsub.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:08:39,658 - stpipe.Coron3Pipeline.outlier_detection - INFO - Step outlier_detection running with args (&lt;CubeModel(60, 224, 288) from jw01386009001_04101_00001_mirimage_calints.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:08:39,659 - stpipe.Coron3Pipeline.outlier_detection - INFO - Outlier Detection mode: coron
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:08:39,660 - stpipe.Coron3Pipeline.outlier_detection - INFO - Outlier Detection asn_id: a3001
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:08:39,668 - jwst.outlier_detection.utils - INFO - Computing median
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:08:39,904 - jwst.outlier_detection.utils - INFO - 32 pixels marked as outliers
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:08:40,107 - stpipe.Coron3Pipeline.outlier_detection - INFO - Saved model in ./miri_coro_demo_data/stage3/jw01386009001_04101_00001_mirimage_a3001_crfints.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:08:40,108 - stpipe.Coron3Pipeline.outlier_detection - INFO - Step outlier_detection done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:08:40,326 - stpipe.Coron3Pipeline.align_refs - INFO - Step align_refs running with args (&lt;CubeModel(60, 224, 288) from jw01386009001_04101_00001_mirimage_a3001_crfints.fits&gt;, &lt;CubeModel(171, 224, 288) from Level 3_psfstack.fits&gt;).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:08:40,336 - stpipe.Coron3Pipeline.align_refs - INFO - Using PSFMASK reference file /home/runner/crds/references/jwst/miri/jwst_miri_psfmask_0012.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:10:44,206 - stpipe.Coron3Pipeline.align_refs - INFO - Step align_refs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:10:58,815 - stpipe.Coron3Pipeline - INFO - Saved model in ./miri_coro_demo_data/stage3/jw01386009001_04101_00001_mirimage_a3001_psfalign.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:10:59,039 - stpipe.Coron3Pipeline.klip - INFO - Step klip running with args (&lt;CubeModel(60, 224, 288) from jw01386009001_04101_00001_mirimage_a3001_crfints.fits&gt;, &lt;CubeModel(171, 224, 288) from jw01386009001_04101_00001_mirimage_a3001_psfalign.fits&gt;).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:10:59,047 - stpipe.Coron3Pipeline.klip - INFO - KL transform truncation = 25
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:11,411 - stpipe.Coron3Pipeline.klip - INFO - Step klip done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:11,632 - stpipe.Coron3Pipeline - INFO - Saved model in ./miri_coro_demo_data/stage3/jw01386009001_04101_00001_mirimage_a3001_psfsub.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,157 - stpipe.Coron3Pipeline.resample - INFO - Step resample running with args (&lt;jwst.datamodels.library.ModelLibrary object at 0x7fd04c55bad0&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,247 - jwst.resample.resample_utils - INFO - Pixel scale ratio (pscale_out/pscale_in): 1.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,248 - jwst.resample.resample_utils - INFO - Computed output pixel scale: 0.11052294287183988 arcsec.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,490 - stcal.resample.resample - INFO - Output pixel scale: 0.11052294287183988 arcsec.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,490 - stcal.resample.resample - INFO - Driz parameter kernel: square
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,491 - stcal.resample.resample - INFO - Driz parameter pixfrac: 1.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,491 - stcal.resample.resample - INFO - Driz parameter fillval: NAN
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,492 - stcal.resample.resample - INFO - Driz parameter weight_type: exptime
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,492 - jwst.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,528 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,542 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,554 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,567 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,643 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,656 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,669 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,682 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,724 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,738 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,751 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,764 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,807 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,820 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,833 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,846 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,889 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,902 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,915 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,928 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,970 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,984 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:15,997 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,010 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,052 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,065 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,078 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,090 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,133 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,146 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,159 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,171 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,214 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,227 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,239 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,252 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,294 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,307 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,320 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,332 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,374 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,387 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,400 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,413 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,455 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,468 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,481 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,494 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,536 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,549 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,561 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,574 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,617 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,630 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,642 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,655 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,697 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,710 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,723 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,735 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,778 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,791 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,804 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,817 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,859 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,872 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,884 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,897 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,940 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,953 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,965 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:16,978 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,020 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,033 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,046 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,058 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,101 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,114 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,127 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,140 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,182 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,195 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,208 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,221 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,264 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,277 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,290 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,302 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,345 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,358 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,371 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,384 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,427 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,440 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,453 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,466 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,509 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,522 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,535 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,548 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,591 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,605 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,617 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,630 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,673 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,686 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,698 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,711 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,754 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,767 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,780 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,793 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,835 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,848 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,861 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,874 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,917 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,930 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,943 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,955 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:17,998 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,011 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,024 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,037 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,080 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,093 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,106 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,119 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,162 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,175 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,187 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,200 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,243 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,256 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,269 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,282 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,325 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,338 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,351 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,364 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,407 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,421 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,433 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,446 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,489 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,502 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,515 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,527 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,571 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,584 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,597 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,609 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,652 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,665 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,678 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,690 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,734 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,747 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,760 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,772 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,814 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,827 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,840 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,853 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,896 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,910 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,923 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,935 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,979 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:18,992 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,005 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,018 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,061 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,074 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,087 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,101 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,143 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,157 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,170 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,183 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,227 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,240 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,253 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,267 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,310 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,324 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,337 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,351 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,394 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,408 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,421 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,434 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,478 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,491 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,504 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,517 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,562 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,576 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,588 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,602 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,646 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,659 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,673 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,686 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,730 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,744 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,757 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,770 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,813 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,827 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,840 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,853 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,896 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,909 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,922 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,935 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,977 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:19,991 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,004 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,017 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,060 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,074 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,087 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,100 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,142 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,156 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,170 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,183 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,227 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,242 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,255 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,268 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,311 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,324 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,336 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,350 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,394 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,408 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,421 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,434 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,477 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,493 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,507 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,522 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,567 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,582 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,597 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,612 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,657 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,673 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,688 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,703 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,749 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,765 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,780 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,794 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,838 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,854 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,868 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,883 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,928 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,944 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,958 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:20,973 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,017 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,032 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,047 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,061 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,106 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,122 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,136 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,151 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,195 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,210 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,225 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,239 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,284 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,300 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,314 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,329 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,373 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,388 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,403 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,417 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,462 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,478 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,492 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,507 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,551 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,566 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,581 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,596 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,641 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,657 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,672 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,686 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,731 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,746 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,761 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,775 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,820 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,835 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,850 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,864 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,909 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,925 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,939 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,954 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:21,998 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,014 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,029 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,054 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,099 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,114 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,129 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,143 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,188 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,204 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,219 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,234 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,278 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,294 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,308 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,323 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,368 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,384 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,399 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,413 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,458 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,474 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,489 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,503 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,548 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,564 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,579 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,594 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,638 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,654 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,669 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,683 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,728 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,744 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,759 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,774 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,818 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,833 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,848 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,862 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,907 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,923 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,937 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,952 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:22,996 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,012 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,026 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,041 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,085 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,101 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,116 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,130 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,175 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,190 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,205 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,219 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,264 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,280 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,294 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,308 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,353 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,368 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,383 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,397 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,442 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,458 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,472 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,487 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,532 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,548 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,563 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,577 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,623 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,639 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,654 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,668 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,714 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,729 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,744 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,759 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,805 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,821 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,836 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,851 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,895 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,911 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,926 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,941 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:23,987 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,002 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,017 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,032 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,077 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,093 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,108 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,123 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,169 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,185 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,200 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,214 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,259 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,275 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,290 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,304 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,350 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,366 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,381 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,395 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,440 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,457 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,471 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,486 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,532 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,547 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,562 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,577 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,622 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,637 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,652 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,667 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,712 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,728 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,743 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,758 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,803 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,819 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,834 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,849 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,894 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,910 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,925 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,939 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:24,984 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,000 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,015 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,030 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,076 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,091 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,106 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,121 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,166 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,182 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,196 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,211 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,257 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,273 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,287 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,302 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,347 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,363 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,377 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,392 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,438 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,453 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,468 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,483 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,528 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,544 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,559 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,573 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,619 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,635 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,650 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,665 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,709 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,725 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,740 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,755 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,801 - stcal.resample.resample - INFO - Resampling science and variance data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,817 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,831 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,846 - stcal.resample.resample - INFO - Drizzling (224, 288) --&gt; (269, 319)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,892 - stcal.alignment.util - INFO - Update S_REGION to POLYGON ICRS  201.141822820 -51.507192321 201.154429812 -51.509768051 201.159335271 -51.500462638 201.146730575 -51.497887434
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:25,904 - stpipe.Coron3Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:26,262 - stpipe.Coron3Pipeline - INFO - Saved model in ./miri_coro_demo_data/stage3/Level 3_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:26,263 - stpipe.Coron3Pipeline - INFO - ...ending calwebb_coron3
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:26,291 - stpipe.Coron3Pipeline - INFO - Step Coron3Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-01 17:11:26,292 - jwst.stpipe.core - INFO - Results used jwst version: 1.19.1
</pre></div>
</div>
</div>
</div>
<p>Run calwebb_image3 using the call method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print out the time benchmark</span>
<span class="n">time1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Runtime so far: </span><span class="si">{</span><span class="n">time1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">time0</span><span class="si">:</span><span class="s2">0.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Runtime for coron3: </span><span class="si">{</span><span class="n">time1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">time_coron3</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Runtime so far: 2084.2044 seconds
Runtime for coron3: 328.9652433800002 seconds
</pre></div>
</div>
</div>
</div>
<hr style="border:1px solid gray"> </hr></section>
<section id="examine-the-output">
<h2>8.-Examine the output<a class="headerlink" href="#examine-the-output" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<p>Here we’ll plot the data to see what our source looks like.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Stage 3 output files</span>

<span class="c1"># Individual exposures</span>
<span class="n">sstring</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">coron3_dir</span><span class="p">,</span> <span class="s1">&#39;jw*psfsub.fits&#39;</span><span class="p">)</span>
<span class="n">psfsubfiles</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">sstring</span><span class="p">))</span>
<span class="n">npsfsub</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">psfsubfiles</span><span class="p">)</span>

<span class="c1"># Combined exposure</span>
<span class="n">sstring</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">coron3_dir</span><span class="p">,</span> <span class="s1">&#39;*i2d.fits&#39;</span><span class="p">)</span>
<span class="n">i2dfiles</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">sstring</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">npsfsub</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">imgs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;roll1&#39;</span><span class="p">:</span> <span class="n">datamodels</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">psfsubfiles</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
            <span class="s1">&#39;combo&#39;</span><span class="p">:</span> <span class="n">datamodels</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">i2dfiles</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()}</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">imgs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;roll1&#39;</span><span class="p">:</span> <span class="n">datamodels</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">psfsubfiles</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
            <span class="s1">&#39;roll2&#39;</span><span class="p">:</span> <span class="n">datamodels</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">psfsubfiles</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
            <span class="s1">&#39;combo&#39;</span><span class="p">:</span> <span class="n">datamodels</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">i2dfiles</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanquantile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="nb">list</span><span class="p">([</span><span class="n">i</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">imgs</span><span class="o">.</span><span class="n">values</span><span class="p">()])),</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">roll</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">imgs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">imgs</span><span class="p">[</span><span class="n">roll</span><span class="p">]</span>
    <span class="k">while</span> <span class="n">img</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">roll</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/4016387e2483c460e2fe058261018d41a83f1c564b78e7c10bad5197b49d521f.png" src="../../../_images/4016387e2483c460e2fe058261018d41a83f1c564b78e7c10bad5197b49d521f.png" />
</div>
</div>
<section id="overlay-sky-coordinates">
<h3>Overlay sky coordinates<a class="headerlink" href="#overlay-sky-coordinates" title="Permalink to this heading">#</a></h3>
<p>Overlay the RA and Dec grid over the combined rolls</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">i2dfiles</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">wcs</span> <span class="o">=</span> <span class="n">WCS</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The star coordinates at the time of observation are in the header</span>
<span class="n">exp_file</span> <span class="o">=</span> <span class="n">uncal_sci_r1_files</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">targ_ra</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getval</span><span class="p">(</span><span class="n">exp_file</span><span class="p">,</span> <span class="s1">&#39;TARG_RA&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">targ_dec</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getval</span><span class="p">(</span><span class="n">exp_file</span><span class="p">,</span> <span class="s1">&#39;TARG_DEC&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">starcoord</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">targ_ra</span><span class="p">,</span> <span class="n">targ_dec</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s1">&#39;icrs&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">wcs</span><span class="p">})</span>
<span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanquantile</span><span class="p">(</span><span class="n">imgs</span><span class="p">[</span><span class="s1">&#39;combo&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imgs</span><span class="p">[</span><span class="s1">&#39;combo&#39;</span><span class="p">],</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="n">wcs</span><span class="o">.</span><span class="n">world_to_pixel</span><span class="p">(</span><span class="n">starcoord</span><span class="p">),</span>
           <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/36f59a869b6d0ef8ecdef1df41ce4980e554d4ebc29a5f5211ebbe6691fcffbe.png" src="../../../_images/36f59a869b6d0ef8ecdef1df41ce4980e554d4ebc29a5f5211ebbe6691fcffbe.png" />
</div>
</div>
<hr style="border:1px solid gray"> </hr><a class="reference internal image-reference" href="https://github.com/spacetelescope/jwst-pipeline-notebooks/raw/main/_static/stsci_footer.png"><img alt="stsci_logo" src="https://github.com/spacetelescope/jwst-pipeline-notebooks/raw/main/_static/stsci_footer.png" style="width: 200px;" /></a>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "spacetelescope/jwst-pipeline-notebooks",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/MIRI/Coronagraphy"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../../../README.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">JWST Pipeline Notebooks</p>
      </div>
    </a>
    <a class="right-next"
       href="../Imaging/JWPipeNB-MIRI-imaging.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">MIRI Imaging Pipeline Notebook</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration">1.-Configuration</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-crds-context-and-server">Set CRDS context and server</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#package-imports">2.-Package Imports</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-convenience-functions">Define convenience functions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#demo-mode-setup-ignore-if-not-using-demo-data">3.-Demo Mode Setup (ignore if not using demo data)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#directory-setup">4.-Directory Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#detector1-pipeline">5.-Detector1 Pipeline</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calibrating-science-files">Calibrating Science Files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calibrating-psf-reference-target-files">Calibrating PSF Reference Target Files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calibrating-background-files">Calibrating Background Files</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#image2-pipeline">6.-Image2 Pipeline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coron3-pipeline">7.-Coron3 Pipeline</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examine-the-output">8.-Examine the output</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overlay-sky-coordinates">Overlay sky coordinates</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By STScI
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>